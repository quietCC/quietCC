<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ClickHouse</title>
      <link href="/2010/12/12/ClickHouse/"/>
      <url>/2010/12/12/ClickHouse/</url>
      
        <content type="html"><![CDATA[<h1 id="å…¥é—¨"><a href="#å…¥é—¨" class="headerlink" title="å…¥é—¨"></a>å…¥é—¨</h1><p>Click Houseæ˜¯ä¿„ç½—æ–¯çš„Yandexä¸2016å¹´å¼€æºçš„åˆ—å¼å­˜å‚¨æ•°æ®åº“(DBMS), ä½¿ç”¨c++è¯­è¨€ç¼–å†™</p><h1 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h1><h2 id="æ•´å‹"><a href="#æ•´å‹" class="headerlink" title="æ•´å‹"></a>æ•´å‹</h2><p>å›ºå®šé•¿åº¦çš„æ•´å½¢, åŒ…æ‹¬æœ‰ç¬¦å·æ•´å‹å’Œæ— ç¬¦å·æ•´å‹</p><p><strong>æ•´å‹èŒƒå›´(-2<sup>n-1</sup> ~ 2<sup>n-1</sup>-1 )</strong></p><p>Int8                       [-128 : 127]</p><p>Int16                     [-32768 : 32767]</p><p>Int32                     [-2147483648 : 2147483647]</p><p>Int64                     [-9223372036854775808 : 9223372036854775807]</p><p><strong>æ— ç¬¦å·æ•´å‹èŒƒå›´(0 ~ 2 <sup>n-1</sup>-1)</strong></p><p>UInt8                      [0 : 255]</p><p>UInt16                    [0 : 65535]</p><p>UInt32                    [0 : 4294967295]</p><p>UInt64                    [0 : 18446744073709551615]</p><h2 id="æµ®ç‚¹å‹"><a href="#æµ®ç‚¹å‹" class="headerlink" title="æµ®ç‚¹å‹"></a>æµ®ç‚¹å‹</h2><p>Float32                float</p><p>Float64                double</p><blockquote><p>å°½å¯èƒ½çš„ä»¥æ•´æ•°çš„å½¢å¼å­˜å‚¨æ•°æ®, ä¾‹å¦‚, å°†å›ºå®šç²¾åº¦çš„æ•°å­—è½¬æ¢ä¸ºæ•´æ•°å‹, å¦‚ç”¨æ—¶çš„æ¯«ç§’ä¸ºå•ä½è¡¨ç¤º, å› ä¸ºæµ®ç‚¹å‹è¿›è¡Œè®¡ç®—æ—¶å¯èƒ½ä¼šå¼•èµ·å››èˆäº”å…¥çš„è¯¯å·®</p></blockquote><h2 id="å¸ƒå°”å‹"><a href="#å¸ƒå°”å‹" class="headerlink" title="å¸ƒå°”å‹"></a>å¸ƒå°”å‹</h2><p>æ²¡æœ‰å•ç‹¬çš„ç±»å‹æ¥å­˜å‚¨å¸ƒå°”å€¼, å¯ä»¥ä½¿ç”¨UInt8ç±»å‹, å–å€¼é™åˆ¶ä¸º0æˆ–è€…1</p><h2 id="Decimalå‹"><a href="#Decimalå‹" class="headerlink" title="Decimalå‹"></a>Decimalå‹</h2><p>æœ‰ç¬¦å·çš„æµ®ç‚¹æ•°, å¯ä»¥åœ¨åŠ å‡ä¹˜è¿ç®—çš„æ—¶å€™ä¿æŒç²¾åº¦, å¯¹äºé™¤æ³•, æœ€ä½æœ‰æ•ˆæ•°å­—ä¼šè¢«ä¸¢å¼ƒ.</p><p>æœ‰ä¸‰ç§å£°æ˜: </p><ul><li>Decimal32(s)ï¼Œç›¸å½“äºDecimal(9-s,s)ï¼Œæœ‰æ•ˆä½æ•°ä¸º1~9</li><li>Decimal64(s)ï¼Œç›¸å½“äºDecimal(18-s,s)ï¼Œæœ‰æ•ˆä½æ•°ä¸º1~18</li><li>Decimal128(s)ï¼Œç›¸å½“äºDecimal(38-s,s)ï¼Œæœ‰æ•ˆä½æ•°ä¸º1~38</li></ul><p>sæ ‡è¯†å°æ•°ä½</p><blockquote><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><p>ä¸€èˆ¬é‡‘é¢å­—æ®µ, æ±‡ç‡, åˆ©ç‡ç­‰ä¸ºäº†ä¿è¯å°æ•°ç‚¹ç²¾åº¦, ä½¿ç”¨Decimalè¿›è¡Œå­˜å‚¨</p></blockquote><h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><ul><li><p>String</p><p>å­—ç¬¦ä¸²å¯ä»¥ä»»æ„é•¿åº¦, å®ƒå¯ä»¥åŒ…å«ä»»æ„çš„å­—ç¬¦é›†, åŒ…å«ç©ºå­—èŠ‚</p></li><li><p>FixedString(N)</p><p>å›ºå®šé•¿åº¦Nçš„å­—ç¬¦ä¸², Nå¿…é¡»æ˜¯ä¸¥æ ¼çš„æ­£è‡ªç„¶æ•°, å½“æœåŠ¡ç«¯è¯»å–é•¿åº¦å°äºNçš„å­—ç¬¦ä¸²çš„æ—¶å€™, é€šè¿‡åœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ ç©ºå­—èŠ‚æ¥è¾¾åˆ°Nå­—èŠ‚é•¿åº¦, å½“æœåŠ¡ç«¯è¯»å–é•¿åº¦å¤§äºNçš„å­—ç¬¦ä¸²çš„æ—¶å€™, å°†ä¼šè¿”å›é”™è¯¯ä¿¡æ¯</p><p>ä¸Stringç›¸æ¯”, æå°‘ä¼šä½¿ç”¨FixedString, å› ä¸ºä½¿ç”¨èµ·æ¥ä¸æ˜¯å¾ˆæ–¹ä¾¿</p></li></ul><blockquote><p>ä½¿ç”¨åœºæ™¯: åç§°, æ–‡å­—æè¿°, å­—ç¬¦å‹ç¼–ç , å›ºå®šé•¿åº¦çš„å¯ä»¥ä¿å­˜ä¸€äº›å®šé•¿çš„å†…å®¹, ä¸æ¯”å¦‚ä¸€äº›ç¼–ç , æ€§åˆ«ç­‰, ä½†æ˜¯è€ƒè™‘åˆ°ä¸€å®šçš„å˜åŒ–é£é™©, å¸¦æ¥çš„æ”¶ç›Šä¸å¤Ÿæ˜æ˜¾, æ‰€ä»¥å®šé•¿å­—ç¬¦ä¸²ä½¿ç”¨çš„æ„ä¹‰æœ‰é™</p></blockquote><h2 id="æšä¸¾ç±»å‹"><a href="#æšä¸¾ç±»å‹" class="headerlink" title="æšä¸¾ç±»å‹"></a>æšä¸¾ç±»å‹</h2><p>åŒ…æ‹¬Enum8å’ŒEnum16ç±»å‹, Enumä¿å­˜â€™Stringâ€™=integerçš„å¯¹åº”å…³ç³»</p><p>Enum8 ç”¨ â€˜Stringâ€™ = Int8 å¯¹æè¿°</p><p>Enum16 ç”¨ â€˜Stringâ€™ = Int16 å¯¹æè¿°</p><p><strong>ğŸŒ°ç”¨æ³•æ¼”ç¤º:</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_enum</span><br><span class="line">(</span><br><span class="line">    x Enum8(<span class="string">&#x27;hello&#x27;</span> <span class="operator">=</span> <span class="number">1</span>, <span class="string">&#x27;world&#x27;</span> <span class="operator">=</span> <span class="number">2</span>)</span><br><span class="line">)</span><br><span class="line">ENGINE <span class="operator">=</span> TinyLog;</span><br></pre></td></tr></table></figure><ul><li><p>è¿™ä¸ªxåˆ—åªèƒ½å­˜å‚¨ç±»å‹ä¸­å®šä¹‰ä¸­åˆ—å‡ºçš„å€¼: â€˜helloâ€™æˆ–è€…â€™worldâ€™</p></li><li><p>å¦‚æœå°è¯•ä¿å­˜å…¶ä»–çš„ä»»ä½•å€¼, clickhouseä¼šæŠ›å‡ºå¼‚å¸¸</p></li><li><p>å¦‚æœéœ€è¦çœ‹åˆ°å¯¹åº”è¡Œçš„æ•°å€¼, åˆ™å¿…é¡»å°†Enumå€¼è½¬æ¢ä¸ºæ•´æ•°ç±»å‹</p></li></ul><blockquote><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><p>å¯¹äºä¸€äº›çŠ¶æ€, ç±»å‹çš„å­—æ®µç®—æ˜¯ä¸€ç§ç©ºé—´ä¼˜åŒ–, ä¹Ÿç®—æ˜¯ä¸€ç§æ•°æ®çš„çº¦æŸ. ä½†æ˜¯å®é™…ä½¿ç”¨ä¸­å¾€å¾€å› ä¸ºæ•°æ®å†…å®¹çš„å˜åŒ–uaå¢åŠ ä¸€å®šçš„ç»´æŠ¤æˆæœ¬, ç”šè‡³æ˜¯æ•°æ®ä¸¢å¤±çš„é—®é¢˜, æ‰€ä»¥è°¨æ…ä½¿ç”¨.</p></blockquote><h2 id="æ—¶é—´ç±»å‹"><a href="#æ—¶é—´ç±»å‹" class="headerlink" title="æ—¶é—´ç±»å‹"></a>æ—¶é—´ç±»å‹</h2><p>ç›®å‰ClickHouseæœ‰ä¸‰ç§æ—¶é—´ç±»å‹</p><ul><li>Dateæ¥å—<code>å¹´-æœˆ-æ—¥</code>çš„å­—ç¬¦ä¸², æ¯”å¦‚ â€˜1999-09-09â€™</li><li>Datetimeæ¥å—<code> å¹´-æœˆ-æ—¥ æ—¶-åˆ†-ç§’</code>çš„å­—ç¬¦ä¸², æ¯”å¦‚ â€˜1999-09-09 09:09:09â€™</li><li>Datetime64 æ¥å—<code> å¹´-æœˆ-æ—¥ æ—¶-åˆ†-ç§’.äºšç§’</code>çš„å­—ç¬¦ä¸²å—, æ¯”å¦‚ â€˜1999-09-09 09:09:09.99â€™</li></ul><p>æ—¥æœŸç±»å‹, ç”¨ä¸¤ä¸ªå­—èŠ‚å­˜å‚¨, è¡¨ç¤ºä»1970-01-01åˆ°å½“å‰çš„æ—¥æœŸå€¼</p><p>è¿˜æœ‰å¾ˆå¤šçš„æ•°æ®ç»“æ„, å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£</p><p><a href="https://clickhouse.yandex/docs/zh/data_types/">å®˜æ–¹æ–‡æ¡£</a></p><h2 id="æ•°ç»„ç±»å‹"><a href="#æ•°ç»„ç±»å‹" class="headerlink" title="æ•°ç»„ç±»å‹"></a>æ•°ç»„ç±»å‹</h2><p>&emsp;Array(T): ç”±Tç±»å‹å…ƒç´ ç»„æˆçš„æ•°ç»„</p><p>&emsp;ï¼´å¯ä»¥æ—¶ä»»æ„ç±»å‹, åŒ…æ‹¬æ•°ç»„ç±»å‹, ä½†æ˜¯ä¸æ¨èä½¿ç”¨å¤šç»´æ•°ç»„ ,ClickHouseå¯¹å¤šç»´æ•°ç»„çš„æ”¯æŒæœ‰é™, ä¾‹å¦‚, ä¸èƒ½å†MergeTreeè¡¨ä¸­å­˜å‚¨å¤šç»´æ•°ç»„.</p><p>åˆ›å»ºæ•°ç»„çš„æ–¹å¼1, ä½¿ç”¨arrayå‡½æ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">array</span>(<span class="number">1</span>, <span class="number">2</span>) <span class="keyword">AS</span> x, toTypeName(x) ;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ•°ç»„çš„æ–¹å¼2, ä½¿ç”¨æ–¹æ‹¬å·</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="number">1</span>, <span class="number">2</span>] <span class="keyword">AS</span> x, toTypeName(x);</span><br></pre></td></tr></table></figure><h1 id="è¡¨å¼•æ“"><a href="#è¡¨å¼•æ“" class="headerlink" title="è¡¨å¼•æ“"></a>è¡¨å¼•æ“</h1><h2 id="è¡¨å¼•æ“çš„ä½¿ç”¨"><a href="#è¡¨å¼•æ“çš„ä½¿ç”¨" class="headerlink" title="è¡¨å¼•æ“çš„ä½¿ç”¨"></a>è¡¨å¼•æ“çš„ä½¿ç”¨</h2><p>è¡¨å¼•æ“æ—¶ClickHouseçš„ä¸€å¤§ç‰¹è‰², å¯ä»¥è¯´, è¡¨å¼•æ“å†³å®šäº†å¦‚ä½•å­˜å‚¨è¡¨çš„æ•°æ®. åŒ…æ‹¬: </p><ul><li>æ•°æ®çš„å­˜å‚¨æ–¹å¼å’Œä½ç½®, å†™åˆ°å“ªé‡Œä»¥åŠä»å“ªé‡Œè¯»å–æ•°æ®</li><li>æ”¯æŒé‚£äº›æŸ¥è¯¢ä»¥åŠå¦‚ä½•æ”¯æŒ</li><li>å¹¶å‘æ•°æ®è®¿é—®</li><li>ç´¢å¼•çš„ä½¿ç”¨(å¦‚æœå­˜åœ¨)</li><li>æ˜¯å¦å¯ä»¥æ‰§è¡Œå¤šçº¿ç¨‹è¯·æ±‚</li><li>æ•°æ®å¤åˆ¶å‚æ•°</li></ul><p>è¡¨å¼•æ“çš„ä½¿ç”¨æ–¹å¼å°±æ˜¯å¿…é¡»æ˜¾ç¤ºçš„åœ¨åˆ›å»ºè¡¨æ—¶å®šä¹‰è¯¥è¡¨ä½¿ç”¨çš„å¼•æ“, ä»¥åŠå¼•æ“ä½¿ç”¨çš„ç›¸å…³å‚æ•°</p><blockquote><p>å¼•æ“çš„åç§°å¤§å°å†™æ•æ„Ÿ</p></blockquote><h2 id="TinyLog"><a href="#TinyLog" class="headerlink" title="TinyLog"></a>TinyLog</h2><p>&emsp;ä»¥åˆ—æ–‡ä»¶çš„å½¢å¼ä¿å­˜åœ¨ç£ç›˜ä¸Š, ä¸æ”¯æŒç´¢å¼•, æ²¡æœ‰å¹¶å‘æ§åˆ¶. ä¸€èˆ¬ä¿å­˜å°‘é‡æ•°æ®çš„å°è¡¨, ç”Ÿäº§ç¯å¢ƒä¸Šä½œç”¨æœ‰é™, å¯ä»¥ç”¨äºå¹³æ—¶ç»ƒä¹ æµ‹è¯•çš„æ—¶å€™ä½¿ç”¨</p><p>å¦‚: </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_tinylog ( id String, name String) engine<span class="operator">=</span>TinyLog;</span><br></pre></td></tr></table></figure><h2 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h2><p>&emsp;å†…å­˜å¼•æ“, æ•°æ®ä»¥æœªå‹ç¼©çš„åŸå§‹å½¢å¼ç›´æ¥ä¿å­˜åœ¨å†…å­˜ä¹‹ä¸­, æœåŠ¡å™¨é‡å¯æ•°æ®å°±ä¼šæ¶ˆå¤±. è¯»å†™æ“ä½œä¸ä¼šç›¸äº’é˜»å¡, ä¸æ”¯æŒç´¢å¼•, ç®€å•æŸ¥è¯¢ä¸‹æœ‰éå¸¸éå¸¸é«˜çš„æ€§èƒ½è¡¨ç°(è¶…è¿‡10G/s)</p><p>&emsp;ä¸€èˆ¬ç”¨åˆ°å®ƒçš„åœ°æ–¹ä¸å¤š, é™¤äº†ç”¨æ¥æµ‹è¯•, å°±æ˜¯åœ¨éœ€è¦éå¸¸é«˜çš„æ€§èƒ½, åŒæ—¶æ•°æ®é‡åˆä¸å¤§çš„æƒ…å†µä¸‹, ä¸Šé™å¤§æ¦‚1äº¿è¡Œçš„åœºæ™¯</p><h2 id="MergeTree"><a href="#MergeTree" class="headerlink" title="MergeTree"></a>MergeTree</h2><p>&emsp;ClickHouseä¸­æœ€å¼ºå¤§çš„è¡¨å¼•æ“å½“å±MergeTree(åˆå¹¶æ ‘)å¼•æ“ä»¥åŠè¯¥ç³»åˆ—(*MergeTree)ä¸­çš„å…¶ä»–å¼•æ“, æ”¯æŒç´¢å¼•å’Œåˆ†åŒº, åœ°ä½å¯ä»¥ç›¸å½“ä¸innodbä¹‹ä¸Mysql, è€ŒåŸºäºMergeTree, è¿˜è¡ç”Ÿé™¤äº†å¾ˆå¤šå°å¼Ÿ, ä¹Ÿæ˜¯éå¸¸æœ‰ç‰¹è‰²çš„å¼•æ“.</p><ul><li><p>å»ºè¡¨è¯­å¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_order_mt(</span><br><span class="line">    id UInt32,</span><br><span class="line">    sku_id String,</span><br><span class="line">    total_amount <span class="type">Decimal</span>(<span class="number">16</span>,<span class="number">2</span>),</span><br><span class="line">    create_time  Datetime</span><br><span class="line"> ) engine <span class="operator">=</span>MergeTree</span><br><span class="line">   <span class="keyword">partition</span> <span class="keyword">by</span> toYYYYMMDD(create_time)</span><br><span class="line">   <span class="keyword">primary</span> key (id)</span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> (id,sku_id);</span><br></pre></td></tr></table></figure></li><li><p>æ’å…¥æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span>  t_order_mt <span class="keyword">values</span></span><br><span class="line">(<span class="number">101</span>,<span class="string">&#x27;sku_001&#x27;</span>,<span class="number">1000.00</span>,<span class="string">&#x27;2020-06-01 12:00:00&#x27;</span>) ,</span><br><span class="line">(<span class="number">102</span>,<span class="string">&#x27;sku_002&#x27;</span>,<span class="number">2000.00</span>,<span class="string">&#x27;2020-06-01 11:00:00&#x27;</span>),</span><br><span class="line">(<span class="number">102</span>,<span class="string">&#x27;sku_004&#x27;</span>,<span class="number">2500.00</span>,<span class="string">&#x27;2020-06-01 12:00:00&#x27;</span>),</span><br><span class="line">(<span class="number">102</span>,<span class="string">&#x27;sku_002&#x27;</span>,<span class="number">2000.00</span>,<span class="string">&#x27;2020-06-01 13:00:00&#x27;</span>),</span><br><span class="line">(<span class="number">102</span>,<span class="string">&#x27;sku_002&#x27;</span>,<span class="number">12000.00</span>,<span class="string">&#x27;2020-06-01 13:00:00&#x27;</span>),</span><br><span class="line">(<span class="number">102</span>,<span class="string">&#x27;sku_002&#x27;</span>,<span class="number">600.00</span>,<span class="string">&#x27;2020-06-02 12:00:00&#x27;</span>);</span><br></pre></td></tr></table></figure></li></ul><p>&emsp;MergeTreeå…¶å®è¿˜æœ‰å¾ˆå¤šçš„å‚æ•°, ç»å¤§å¤šæ•°å¯ä»¥ä½¿ç”¨é»˜è®¤å€¼å³å¯, ä½†æ˜¯ä¸‰ä¸ªå‚æ•°æ˜¯æ›´åŠ é‡è¦çš„, ä¹Ÿæ¶‰åŠäº†å…³äºMergeTreeçš„å¾ˆå¤šæ¦‚å¿µ</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ClickHouse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flink-CEP</title>
      <link href="/2010/12/12/Flink-CEP/"/>
      <url>/2010/12/12/Flink-CEP/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯Flink-CEP"><a href="#ä»€ä¹ˆæ˜¯Flink-CEP" class="headerlink" title="ä»€ä¹ˆæ˜¯Flink CEP"></a>ä»€ä¹ˆæ˜¯Flink CEP</h1><p>Flink CEPæ˜¯ä¸€ä¸ªåŸºäºFLink çš„å¤æ‚æ—¶é—´å¤„ç†åº“, å¯ä»¥ä»å¤šä¸ªæ•°æ®æµä¸­å‘ç°å¤æ‚çš„äº‹ä»¶, è¯†åˆ«æœ‰æ„ä¹‰çš„äº‹ä»¶(ä¾‹å¦‚æœºä¼šæˆ–è€…å¨èƒ), å¹¶å°½å¿«åšå‡ºå“åº”, è€Œä¸æ˜¯éœ€è¦ç­‰å¾…å‡ å¤©æˆ–è€…ç›¸å½“é•¿çš„äº‹ä»¶æ‰å‘ç°é—®é¢˜.</p><h1 id="Flink-CEP-API"><a href="#Flink-CEP-API" class="headerlink" title="Flink CEP API"></a>Flink CEP API</h1><p>CEP APIçš„æ ¸å¿ƒæ˜¯Patternçš„API, å®ƒå…è®¸ä½ å¿«é€Ÿå®šä¹‰å¤æ‚çš„äº‹ä»¶æ¨¡å¼. æ¯ä¸ªæ¨¡å¼åŒ…å«å¤šä¸ªé˜¶æ®µ(stage), æˆ–è€…æˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºçŠ¶æ€, ä»ä¸€ä¸ªçŠ¶æ€åˆ‡æ¢åˆ°å¦ä¸€ä¸ªçŠ¶æ€, ç”¨æˆ·å¯ä»¥æŒ‡å®šæ¡ä»¶, è¿™äº›æ¡ä»¶å¯ä»¥ä½œç”¨åœ¨ä¸´è¿‘çš„äº‹ä»¶æˆ–è€…ç‹¬ç«‹çš„äº‹ä»¶ä¸Š.</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flink </tag>
            
            <tag> CEP </tag>
            
            <tag> pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flink-DataStreamæµå¤„ç†ç®—å­</title>
      <link href="/2010/12/12/Flink-DataStream%E6%B5%81%E5%A4%84%E7%90%86%E7%AE%97%E5%AD%90/"/>
      <url>/2010/12/12/Flink-DataStream%E6%B5%81%E5%A4%84%E7%90%86%E7%AE%97%E5%AD%90/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒå¼•ç”¨é“¾æ¥: </p><ul><li><a href="https://github.com/legendtkl/paper_reading/blob/main/realtime-compute/Chandy-Lamport.md">åˆ†å¸ƒå¼å¿«ç…§ç®—æ³•: Chandy-Lamport</a></li><li>äº”åˆ†é’Ÿå­¦å¤§æ•°æ®å¾®ä¿¡å…¬ä¼—å·</li><li>å°šç¡…è°·å¤§æ•°æ®å­¦ä¹ æ–‡æ¡£</li><li>Flink1.13å®˜æ–¹æ–‡æ¡£</li></ul><p>ç¨‹åºæ‰§è¡Œæµç¨‹å›¾</p><pre class="mermaid">graph LR    environment --> source --> transform --> sink</pre><h1 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h1><h2 id="getExecutionEnvironment"><a href="#getExecutionEnvironment" class="headerlink" title="getExecutionEnvironment"></a>getExecutionEnvironment</h2><p>â€‹    åˆ›å»ºä¸€ä¸ªæ‰§è¡Œç¯å¢ƒ, è¡¨ç¤ºå½“å‰æ‰§è¡Œç¨‹åºçš„è¨æ¹–ç»™ä½ ä¸‹æ–‡, å¦‚æœç¨‹åºæ˜¯ç‹¬ç«‹è°ƒç”¨çš„, åˆ™æ­¤æ–¹æ³•è¿”å›æœ¬åœ°æ‰§è¡Œç¯å¢ƒ; å¦‚æœä»å‘½ä»¤è¡Œå®¢æˆ·ç«¯æäº¤åˆ°é›†ç¾¤, åˆ™æ­¤æ–¹æ³•è¿”å›çš„æ˜¯é›†ç¾¤çš„å®¢æˆ·ç«¯ç¯å¢ƒ</p><p>â€‹    getExecutionEnvironmentä¼šæ ¹æ®æŸ¥è¯¢è¿è¡Œçš„æ–¹å¼è¿”å›ä»€ä¹ˆæ ·çš„è¿è¡Œç¯å¢ƒ, æ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§åˆ›å»ºæ‰§è¡Œç¯å¢ƒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExecutionEnvironment env = ExecutionEnvironment.getExecutionment();</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br></pre></td></tr></table></figure><p>â€‹    å½“æ²¡æœ‰è®¾ç½®å¹¶è¡Œåº¦çš„æ—¶å€™, ä»¥<code>fink-conf.yaml</code>ä¸­çš„é…ç½®ä¸ºå‡†, é»˜è®¤çš„å¹¶è¡Œåº¦æ˜¯1</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">parallelism.default:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="createLocalEnvironment"><a href="#createLocalEnvironment" class="headerlink" title="createLocalEnvironment"></a>createLocalEnvironment</h2><p>â€‹    è¿”å›æœ¬åœ°æ‰§è¡Œç¯å¢ƒ, éœ€è¦åœ¨è°ƒç”¨çš„æ—¶å€™æŒ‡å®šé»˜è®¤çš„å¹¶è¡Œåº¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LocalStreamEnvironment env = StreamExecutionEnvironment.createLocalEnvironment(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><h2 id="createRemoteEnvironment"><a href="#createRemoteEnvironment" class="headerlink" title="createRemoteEnvironment"></a>createRemoteEnvironment</h2><p>â€‹    è¿”å›é›†ç¾¤æ‰§è¡Œç¯å¢ƒ, å°†Jaræäº¤åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸­, éœ€è¦åœ¨è°ƒç”¨çš„æ—¶å€™æŒ‡å®šJobManagerçš„IPå’Œç«¯å£å·, å¹¶æ‰§è¡Œè¦åœ¨é›†ç¾¤ä¸­è¿è¡Œçš„jaråŒ…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StreamExecutionEnvionment env = StreamEnvironmentExecution.createRemoteEnvironment(<span class="string">&quot;jobManagerHostName&quot;</span>,<span class="number">6123</span>,<span class="string">&quot;YOURPATH//WordCount.jar&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h1><p>â€‹    Flinkå¯ä»¥ä½¿ç”¨<code>StreamExecutionEnvironment.addSource(source)</code>æ¥ä¸ºæˆ‘ä»¬çš„ç¨‹åºæ·»åŠ æ•°æ®æ¥æº</p><p>â€‹    Flinkæä¾›äº†å¾ˆå¤šå®ç°å¥½çš„SourceFunction, å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥<strong>é€šè¿‡SourceFunctionæ¥å®šä¹‰éå¹¶è¡Œçš„Sourceæˆ–è€…å®ç°.</strong></p><p>â€‹    ParallelSourceFunctionæ¥å£æˆ–è€…æ‰©å±•RichParallelSourceFunctionæ¥å®šä¹‰å¹¶è¡Œçš„Source</p><p>â€‹    FLinkåœ¨æµå¤„ç†ä¸Šå¤§æ¦‚åˆ†ä¸ºå››ç±»</p><ul><li>åŸºäºæœ¬åœ°æ–‡ä»¶çš„source</li><li>åŸºäºæ–‡ä»¶çš„source</li><li>åŸºäºç½‘ç»œå¥—æ¥å­—çš„source</li><li>è‡ªå®šä¹‰çš„source</li></ul><h1 id="Transform"><a href="#Transform" class="headerlink" title="Transform"></a>Transform</h1><p>ç”¨æˆ·é€šè¿‡ç®—å­èƒ½å¤Ÿå°†ä¸€ä¸ªæˆ–è€…å¤šä¸ªDataStreamæŠ“æ¢æˆä¸ºæ–°çš„DataStream, åœ¨åº”ç”¨ç¨‹åºä¸­å¯ä»¥å°†å¤šä¸ªæ•°æ®è½¬æ¢ç®—å­å¹¶åˆå¹¶æˆä¸ºä¸€ä¸ªå¤æ‚çš„æ•°æ®æµæ‹“æ‰‘</p><h2 id="æ•°æ®æµè½¬æ¢"><a href="#æ•°æ®æµè½¬æ¢" class="headerlink" title="æ•°æ®æµè½¬æ¢"></a>æ•°æ®æµè½¬æ¢</h2><h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p><strong>DataStream</strong> â¡â€‹ <strong>DataStream</strong></p><pre class="mermaid">graph LR    A[DataStream] --> DataStream</pre><p>Takes one element and products one element, A map function that doubles the values of the stream:</p><blockquote><p>å–ä¸€ä¸ªå…ƒç´ å¹¶äº§ç”Ÿä¸€ä¸ªå…ƒç´ , ä¸‹é¢æ˜¯mapå‡½æ•°å°†è¾“å…¥æµçš„å€¼è¿›è¡ŒåŠ å€è¾“å‡ºçš„ä¾‹å­</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">        <span class="comment">// è®¾ç½®å¹¶è¡Œåº¦</span></span><br><span class="line">        env.setParallelism(<span class="number">1</span>);</span><br><span class="line">        env.fromElements(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">                <span class="comment">// æ³›å‹åˆ†åˆ«å¯¹åº”ç€è¾“å…¥ç±»å‹å’Œè¾“å‡ºç±»å‹</span></span><br><span class="line">                .map(<span class="keyword">new</span> MapFunction&lt;Integer, Integer&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Integer <span class="title">map</span><span class="params">(Integer value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> value * <span class="number">2</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .print();</span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Flatmap"><a href="#Flatmap" class="headerlink" title="Flatmap"></a>Flatmap</h3><p><strong>DataStream</strong> â€‹â¡â€‹ <strong>DataStream</strong></p><pre class="mermaid">graph LR    A[DataStream] --> DataStream</pre><p>Takes one element and products zero, one , or more elements. A flatmap function that splits sentences to words:</p><blockquote><p>å–ä¸€ä¸ªå…ƒç´ å¹¶äº§ç”Ÿ0ä¸ª, 1ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ ,  ä¸‹é¢æ˜¯ä¸€ä¸ªflatmapç®—å­å°†å¥å­æ‹†åˆ†ä¸ºå•è¯çš„æ —å­</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">        <span class="comment">// è®¾ç½®å¹¶è¡Œåº¦</span></span><br><span class="line">        env.setParallelism(<span class="number">1</span>);</span><br><span class="line">        env.fromElements(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;java python scala&quot;</span>, <span class="string">&quot;hello&quot;</span>, <span class="string">&quot;hello java hello&quot;</span>)</span><br><span class="line">                .flatMap(<span class="keyword">new</span> FlatMapFunction&lt;String, String&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">flatMap</span><span class="params">(String value, Collector&lt;String&gt; out)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        String[] strings = value.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                        <span class="keyword">for</span> (String string : strings) &#123;</span><br><span class="line">                            out.collect(string);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .print();</span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h3><p><strong>DataStream</strong> â€‹â¡â€‹ <strong>DataStream</strong></p><pre class="mermaid">graph LR    A[DataStream] --> DataStream</pre><p>Evaluates a boolean function for each element and retains those for which the function returns true . A filter that filters out zero values:</p><blockquote><p>ä¸ºæ¯ä¸ªå…ƒç´ è®¡ç®—ä¸€ä¸ªå¸ƒå°”å‡½æ•°, ä¿ç•™è¿”å›å€¼ä¸ºtrueçš„å…ƒç´ , ä¸‹é¢çš„filterå°†å€¼ä¸º0çš„æ•°æ®è¿›è¡Œè¿‡æ»¤</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">        <span class="comment">// è®¾ç½®å¹¶è¡Œåº¦</span></span><br><span class="line">        env.setParallelism(<span class="number">1</span>);</span><br><span class="line">        env.fromElements(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">56</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">24</span>, <span class="number">0</span>)</span><br><span class="line">                .filter(<span class="keyword">new</span> FilterFunction&lt;Integer&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">filter</span><span class="params">(Integer value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> (value != <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .print();</span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="KeyBy"><a href="#KeyBy" class="headerlink" title="KeyBy"></a>KeyBy</h3><p><strong>DataStream</strong> â€‹â¡â€‹ <strong>KeyedStream</strong></p><pre class="mermaid">graph LR    A[DataStream] -->|k1| B[KeyedStream]    A -->|k2| C[KeyedStream]    A -->|k3| D[KeyedStream]    A -->|kn| E[.....]</pre><p>logically partitions a stream into disjoint partitions. All records with the same key are assigned to the same partition. Internally , keyBy() is implemented with hash partitioning. There are different ways to specify keys.</p><blockquote><p>åœ¨é€»è¾‘ä¸Šå°†ä¸€ä¸ªæµåˆ’åˆ†ä¸ºä¸ç›¸äº¤çš„åˆ†åŒº, æ‰€æœ‰å…·æœ‰ç›¸åŒçš„é”®çš„è®°å½•éƒ½ä¼šè¢«åˆ†é…åˆ°åŒä¸€ä¸ªåˆ†åŒº. åœ¨å†…éƒ¨, keyBy()æ˜¯é€šè¿‡hashå€¼å®ç°çš„, æŒ‡å®šé”®çš„æ–¹æ³•æœ‰å¾ˆå¤šç§</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">        <span class="comment">// è®¾ç½®å¹¶è¡Œåº¦</span></span><br><span class="line">        env.setParallelism(<span class="number">2</span>);</span><br><span class="line">        env.fromElements(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;java python scala&quot;</span>, <span class="string">&quot;hello&quot;</span>, <span class="string">&quot;hello java hello&quot;</span>)</span><br><span class="line">                .keyBy(<span class="keyword">new</span> KeySelector&lt;String, Character&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Character <span class="title">getKey</span><span class="params">(String value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> value.charAt(<span class="number">0</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .print();</span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>A type cannot be a key if:</p><ol><li>it is a pojo type but does not override the hashCode() method and relies on the Object.hashCode() implementation.</li><li>it is an array of any type.</li></ol><blockquote><p>åœ¨ä»¥ä¸‹çš„æƒ…å†µä¸‹, ç±»å‹ä¸èƒ½æ˜¯é”®: </p><ol><li>å®ƒæ˜¯ä¸€ç§POJOç±»å‹, ä½†æ˜¯æ²¡æœ‰è¦†ç›–hashCode[]æ–¹æ³•å¹¶ä¸”ä¾èµ–äºObject.hashCode()å®ç°. </li><li>å®ƒæ˜¯ä»»ä½•ç±»å‹çš„æ•°ç»„.</li></ol></blockquote><h3 id="Reduce"><a href="#Reduce" class="headerlink" title="Reduce"></a>Reduce</h3><p><strong>KeyedStream</strong> â¡ <strong>DataStream</strong></p><pre class="mermaid">graph LR    KeyedStream --> DataStream</pre><p>A â€œrollingâ€ reduce on a  keyed data stream. Combines the current element with the last reduced value and emits the new value.</p><p>A reduce fuction that creates a stream of partial sums.</p><blockquote><p>é”®æ§æ•°æ®æµä¸Šçš„æ•°æ®è¿›è¡Œâ€æ»šåŠ¨â€å‡å°‘. å°†å½“å‰å…ƒç´ ä¸æœ€åå‡å°‘çš„å€¼ç»„åˆå¹¶å‘å‡ºæ–°çš„å€¼</p><p>ä¸‹é¢çš„reduceå‡½æ•°åˆ›å»ºéƒ¨åˆ†çš„æµ, å•è¯ç»Ÿè®¡ç¤ºä¾‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">        <span class="comment">// è®¾ç½®å¹¶è¡Œåº¦</span></span><br><span class="line">        env.setParallelism(<span class="number">1</span>);</span><br><span class="line">        env.fromElements(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;java python scala&quot;</span>, <span class="string">&quot;hello&quot;</span>, <span class="string">&quot;hello java hello&quot;</span>)</span><br><span class="line">                <span class="comment">// å½“ä½¿ç”¨lambdaè¡¨è¾¾å¼çš„æ—¶å€™è¦æ³¨æ„å‘ç”Ÿæ³›å‹æ“¦é™¤çš„é—®é¢˜, æ‰€ä»¥æˆ‘ä»¬å¯¹æ—¶å€™lambdaçš„å‡½æ•°åé¢</span></span><br><span class="line">                <span class="comment">// è¿½åŠ returnsæ–¹æ³•æŒ‡å®šè¾“å‡ºçš„ç»“æœç±»å‹</span></span><br><span class="line">                .flatMap(</span><br><span class="line">                        (String in, Collector&lt;Tuple2&lt;String, Integer&gt;&gt; out) -&gt; &#123;</span><br><span class="line">                            String[] strings = in.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                            <span class="keyword">for</span> (String string : strings) out.collect(Tuple2.of(string, <span class="number">1</span>));</span><br><span class="line">                        &#125;</span><br><span class="line">                ).returns(Types.TUPLE(Types.STRING, Types.INT))</span><br><span class="line">                <span class="comment">// ä»¥äºŒå…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºkey</span></span><br><span class="line">                .keyBy(r -&gt; r.f0)</span><br><span class="line">                <span class="comment">// ä½¿ç”¨reduceå¯¹ç›¸åŒkeyçš„æ¯æ¡æ•°æ®ä¿ç•™ä¸€ä»½çŠ¶æ€å€¼</span></span><br><span class="line">                .reduce(<span class="keyword">new</span> ReduceFunction&lt;Tuple2&lt;String, Integer&gt;&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Tuple2&lt;String, Integer&gt; <span class="title">reduce</span><span class="params">(Tuple2&lt;String, Integer&gt; value1, Tuple2&lt;String, Integer&gt; value2)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> Tuple2.of(</span><br><span class="line">                                value1.f0,</span><br><span class="line">                                value1.f1 + value2.f1</span><br><span class="line">                        );</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .print();</span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>:chestnut:<strong>æ•°å­—æµä¿å­˜æœ€å¤§å€¼å’Œæœ€å°å€¼ç¤ºä¾‹</strong></p><p>è‡ªå®šä¹‰source</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntegerSource</span> <span class="keyword">implements</span> <span class="title">SourceFunction</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> running = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">private</span> Random random = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(SourceContext&lt;Integer&gt; ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (running) &#123;</span><br><span class="line">            ctx.collect(random.nextInt(<span class="number">1000</span>));</span><br><span class="line">            Thread.sleep(<span class="number">1000L</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cancel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        running = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Flink Demo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">        env.setParallelism(<span class="number">1</span>);</span><br><span class="line">        env.addSource(<span class="keyword">new</span> IntegerSource())</span><br><span class="line">                <span class="comment">// åˆ›å»ºtuple, ç”¨äºå­˜å‚¨æœ€å¤§å€¼å’Œæœ€å°å€¼</span></span><br><span class="line">                .map(ele -&gt; Tuple2.of(ele, ele))</span><br><span class="line">                <span class="comment">// å› ä¸ºå­˜åœ¨æ³›å‹æ“¦é™¤é—®é¢˜, æ‰€ä»¥è¿™é‡Œè¦å£°æ˜å‘ä¸‹æ¸¸ä¼ é€’çš„æ•°æ®ç±»å‹</span></span><br><span class="line">                .returns(Types.TUPLE(Types.INT, Types.INT))</span><br><span class="line">                <span class="comment">// æ”¾åˆ°ä¸€ä¸ªé€»è¾‘åˆ†åŒºä¹‹å†…è¿›è¡Œåˆ¤æ–­</span></span><br><span class="line">                .keyBy(ele -&gt; <span class="number">1</span>)</span><br><span class="line">                .reduce(<span class="keyword">new</span> ReduceFunction&lt;Tuple2&lt;Integer, Integer&gt;&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Tuple2&lt;Integer, Integer&gt; <span class="title">reduce</span><span class="params">(Tuple2&lt;Integer, Integer&gt; value1, Tuple2&lt;Integer, Integer&gt; value2)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="comment">//value1 ä»£è¡¨å½“å‰å…ƒç´ , value2 ä»£è¡¨ä¸Šæ¸¸è¾“å‡ºçš„å…ƒç´ , æ˜¯çŠ¶æ€ä¿å­˜çš„ä¸€ç§ä½“ç°</span></span><br><span class="line">                        <span class="keyword">return</span> Tuple2.of(</span><br><span class="line">                                <span class="comment">//ä¿å­˜æœ€å¤§å€¼</span></span><br><span class="line">                                value1.f0 &gt; value2.f0 ? value1.f0 : value2.f0,</span><br><span class="line">                                <span class="comment">// ä¿å­˜æœ€å°å€¼</span></span><br><span class="line">                                value1.f1 &lt; value2.f1 ? value1.f1 : value2.f1</span><br><span class="line">                        );</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .print();</span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Sink"><a href="#Sink" class="headerlink" title="Sink"></a>Sink</h1><h1 id="RichFunction"><a href="#RichFunction" class="headerlink" title="RichFunction"></a>RichFunction</h1><p>æ¯ä¸€ä¸ªå¹¶è¡Œå­ä»»åŠ¡éƒ½æœ‰è‡ªå·±çš„å£°æ˜å‘¨æœŸ</p><ul><li>open(): åœ¨ç®—å­çš„è®¡ç®—é€»è¾‘å‰æ‰§è¡Œä¸€æ¬¡, é€‚åˆåšåˆå§‹åŒ–çš„å·¥ä½œ, æ¯”å¦‚æ‰“å¼€é“¾æ¥</li><li>close(): åœ¨ç®—å­çš„è®¡ç®—é€»è¾‘æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰§è¡Œä¸€æ¬¡, æ¯”å¦‚å…³é—­é“¾æ¥</li><li>getRuntimeContext(): ç”¨æ¥è·å–å½“å‰ç®—å­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯, æ¯”å¦‚å½“å‰ç®—å­æ‰€å¤„çš„å¹¶iæ€§å­ä»»åŠ¡çš„ç´¢å¼•ç­‰ç­‰</li></ul><p>MapFunction â¡ RichMapFunction</p><p>FilterFunction â¡ RichFilterFunction</p><p>FlatMapFunction â¡ RichFlatMapFunction</p><p>SourceFunction â¡ RichSourceFunction</p><p>SinkFunction â¡ RichSInkFunction</p><h2 id="RichMapFunction"><a href="#RichMapFunction" class="headerlink" title="RichMapFunction"></a>RichMapFunction</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">        env.setParallelism(<span class="number">1</span>);</span><br><span class="line">        env.fromElements(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">                .map(<span class="keyword">new</span> RichMapFunction&lt;Integer, Integer&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">(Configuration parameters)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">super</span>.open(parameters);</span><br><span class="line">                        System.out.println(<span class="string">&quot;æ¢¦å¼€å§‹çš„åœ°æ–¹&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">super</span>.close();</span><br><span class="line">                        System.out.println(<span class="string">&quot;æ¢¦ç»“æŸäº†&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Integer <span class="title">map</span><span class="params">(Integer value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> value * value;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .print();</span><br><span class="line"></span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ•<strong>result</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ¢¦å¼€å§‹çš„åœ°æ–¹</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">9</span><br><span class="line">16</span><br><span class="line">æ¢¦ç»“æŸäº†</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flink </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flink-Watermark</title>
      <link href="/2010/12/12/Flink-Watermark/"/>
      <url>/2010/12/12/Flink-Watermark/</url>
      
        <content type="html"><![CDATA[<p><strong>å‚è€ƒå¼•ç”¨é“¾æ¥:</strong> </p><ul><li>åŸºäºApache Flinkçš„æµå¼è®¡ç®— (å´”æ˜Ÿç¿è¯‘)</li></ul><h1 id="äº‹ä»¶æ—¶é—´ä¸æ°´ä½çº¿æ¦‚è¿°"><a href="#äº‹ä»¶æ—¶é—´ä¸æ°´ä½çº¿æ¦‚è¿°" class="headerlink" title="äº‹ä»¶æ—¶é—´ä¸æ°´ä½çº¿æ¦‚è¿°"></a>äº‹ä»¶æ—¶é—´ä¸æ°´ä½çº¿æ¦‚è¿°</h1><h2 id="äº‹ä»¶æ—¶é—´"><a href="#äº‹ä»¶æ—¶é—´" class="headerlink" title="äº‹ä»¶æ—¶é—´"></a>äº‹ä»¶æ—¶é—´</h2><p>&emsp;äº‹ä»¶æ—¶é—´æ˜¯æ•°æ®æµä¸­äº‹ä»¶å®é™…å‘ç”Ÿçš„äº‹ä»¶, å®ƒä»¥é™„åŠ åœ¨æ•°æ®æµä¸­äº‹ä»¶çš„æ—¶é—´æˆ³ä¸ºä¾æ®. è¿™äº›æ—¶é—´æˆ³é€šå¸¸åœ¨äº‹ä»¶æ•°æ®è¿›å…¥æµå¤„ç†ç®¡é“ä¹‹å‰å°±å­˜åœ¨, æ¯”å¦‚äº‹ä»¶çš„ç”Ÿæˆæ—¶é—´.  å¦‚å›¾æ‰€ç¤º, å³ä½¿äº‹ä»¶æœ‰å»¶è¿Ÿ, äº‹ä»¶æ—¶é—´çª—å£ä¹Ÿèƒ½å‡†ç¡®åœ°å°†äº‹ä»¶åˆ†é…åˆ°çª—å£ä¸­, ä»è€Œååº”å‡ºçœŸæ˜¯å‘ç”Ÿçš„æƒ…å†µ</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211211194513675.png"></p><p>&emsp;äº‹ä»¶æ—¶é—´å°†å¤„ç†é€Ÿåº¦å’Œç»“æœå†…å®¹å½»åº•è§£è€¦. åŸºäºäº‹ä»¶æ—¶é—´çš„æ“ä½œæ˜¯å¯ä»¥é¢„æµ‹çš„, å…¶ç»“æœå…·æœ‰ç¡®å®šæ€§. æ— è®ºæ•°æ®æµçš„å¤„ç†é€Ÿåº¦å¦‚ä½•, äº‹ä»¶åˆ°è¾¾ç®—å­çš„é¡ºåºæ€æ ·, åŸºäºäº‹ä»¶æ—¶é—´çš„çª—å£ä¼šç”ŸæˆåŒæ ·çš„ç»“æœ.</p><p>â€‹    &emsp;ä½¿ç”¨äº‹ä»¶æ—¶é—´è¦å…‹æœçš„æŒ‘æˆ˜ä¹‹ä¸€æ˜¯å¦‚ä½•å¤„ç†å»¶è¿Ÿäº‹ä»¶, æ™®éå­˜åœ¨çš„æ— åºé—®é¢˜ä¹Ÿå¯ä»¥å¾—åˆ°è§£å†³. å‡è®¾æœ‰ä¸€ååå«é²å‹ƒçš„ç©å®¶å’Œçˆ±ä¸½ä¸ç©çš„åŒä¸€æ¬¾åœ¨çº¿æ‰‹æ¸¸, ä½†æ˜¯å› ä¸ºç½‘ç»œä¾›åº”å•†ä¸åŒ, çˆ±ä¸½ä¸çš„æ‰‹æœºåœ¨éš§é“ä¸­æ²¡æœ‰ä¿¡å·äº†, ä½†æ˜¯é²å‹ƒçš„æ‰‹æœºä¾æ—§è”ç½‘å‘æ¸¸æˆåç«¯å‘é€æ•°æ®</p><p>&emsp;<strong>ä¾æ®äº‹ä»¶æ—¶é—´, æˆ‘ä»¬å¯ä»¥ä¿è¯åœ¨æ•°æ®ä¹±é¡ºåºçš„æƒ…å†µä¸‹ç»“æœä¾ç„¶æ­£ç¡®, è€Œä¸”ç»“åˆå¯é‡æ”¾çš„æ•°æ®æµ, æ—¶é—´æˆ³å¸¦æ¥çš„ç¡®å®šæ€§å…è®¸ä½ å¯¹å†å²æ•°æ®è¿›è¡Œâ€å¿«è¿›â€. è¿™æ„å‘³ç€ä½ å¯ä»¥é€šè¿‡é‡æ”¾æ•°æ®æµæ¥åˆ†æå†å²æ•°æ®, å°±å¦‚åŒå®ƒä»¬æ˜¯å®æ—¶äº§ç”Ÿçš„ä¸€æ ·.</strong> æ­¤å¤–, ä½ å¯ä»¥æŠŠè®¡ç®—â€å¿«è¿›â€åˆ°ç°åœ¨, è¿™æ ·ä¸€æ—¦ä½ çš„ç¨‹åºèµ¶ä¸Šäº†å½“å‰äº‹ä»¶äº§ç”Ÿçš„è¿›åº¦, å®ƒèƒ½å¤Ÿä»¥å®Œå…¨ç›¸åŒçš„ç¨‹åºé€»è¾‘ä½œä¸ºå®æ—¶åº”ç”¨ç»§ç»­è¿è¡Œ.</p><h2 id="æ°´ä½çº¿"><a href="#æ°´ä½çº¿" class="headerlink" title="æ°´ä½çº¿"></a>æ°´ä½çº¿</h2><p>&emsp;æˆ‘ä»¬è¦æ€ä¹ˆå†³å®š<strong>äº‹ä»¶æ—¶é—´çš„è§¦å‘æ—¶æœº</strong>å‘¢? æˆ–è€…è¯´, æˆ‘ä»¬éœ€è¦ç­‰å¾…å¤šä¹…æ‰èƒ½ç¡®å®šå·²ç»æ”¶åˆ°äº†æ‰€æœ‰å‘ç”Ÿåœ¨æŸä¸ªç‰¹å®šæ—¶é—´ç‚¹ä¹‹å‰çš„äº‹ä»¶? æ¢è€Œè¨€ä¹‹, æˆ‘ä»¬éœ€è¦å¤šä¹…æ‰èƒ½ç¡®å®šå·²ç»æ”¶åˆ°äº†æ‰€æœ‰å‘ç”Ÿåœ¨æŸä¸ªç‰¹å®šæ—¶é—´ç‚¹ä¹‹å‰çš„äº‹ä»¶? æ­¤å¤–, æˆ‘ä»¬å¦‚ä½•<strong>å¾—çŸ¥æ•°æ®ä¼šäº§ç”Ÿå»¶è¿Ÿ</strong>? å› ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿå®ç°çš„ä¸ç¡®å®šæ€§ä»¥åŠå¤–éƒ¨ç»„ä»¶å¯èƒ½å¼•å‘ä»»æ„å»¶è¿Ÿ, è¿™ä¸¤ä¸ªç­”æ¡ˆéƒ½æ˜¯æ²¡æœ‰å®Œç¾çš„ç­”æ¡ˆçš„. æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ°´ä½çº¿æ¥è®¾å®šäº‹ä»¶æ—¶é—´çª—å£çš„è¡Œä¸º</p><p>&emsp;æ°´ä½çº¿æ˜¯ä¸€ä¸ª<strong>å…¨å±€è¿›åº¦æŒ‡æ ‡,</strong> è¡¨ç¤º<strong>æˆ‘ä»¬ä¸ç¡®ä¿¡ä¸ä¼šå†æœ‰å»¶è¿Ÿäº‹ä»¶æ¥åˆ°çš„æŸä¸ªæ—¶é—´ç‚¹.</strong>  æœ¬è´¨ä¸Š, æ°´ä½çº¿æä¾›äº†ä¸€ä¸ªé€»è¾‘æ—¶é’Ÿ, ç”¨æ¥é€šçŸ¥ç³»ç»Ÿå½“å‰çš„äº‹ä»¶æ—¶é—´. å½“ä¸€ä¸ªç®—å­æ¥æ”¶åˆ°æ—¶é—´ä¸ºTçš„æ°´ä½çº¿, å°±å¯ä»¥è®¤ä¸ºä¸ä¼šå†æ”¶åˆ°ä»»ä½•æ—¶é—´æˆ³å°äºæˆ–ç­‰äºTçš„äº‹ä»¶äº†.  æ°´ä½çº¿æ— è®ºå¯¹äºäº‹ä»¶æ—¶é—´çª—å£è¿˜æ˜¯å¤„ç†ä¹±åºäº‹ä»¶çš„ç®—å­éƒ½å¾ˆå…³é”®. ç®—å­ä¸€æ—¦æ”¶åˆ°æŸä¸ªæ°´ä½çº¿, å°±ç›¸å½“äºæ”¶åˆ°äº†ä¿¡å·: æŸä¸ªç‰¹å®šæ—¶é—´åŒºé—´çš„æ—¶é—´æˆ³å·²ç»åˆ°é½äº†, å¯ä»¥è§¦å‘çª—å£è®¡ç®—æˆ–è€…å¯¹æ¥å—çš„æ•°æ®è¿›è¡Œæ’åºäº†. </p><p>&emsp;<strong>æ°´ä½çº¿å…è®¸æˆ‘ä»¬åœ¨ç»“æœçš„å‡†ç¡®æ€§å’Œå»¶è¿Ÿä¹‹é—´åšå‡ºå–èˆ.</strong>  æ¿€è¿›çš„æ°´ä½çº¿ç­–ç•¥ä¿è¯äº†ä½å»¶è¿Ÿ, ä½†éšä¹‹è€Œæ¥çš„æ˜¯ä½å¯ä¿¡åº¦. è¯¥æƒ…å†µä¸‹, å»¶è¿Ÿäº‹ä»¶å¯èƒ½ä¼šåœ¨æ°´ä½çº¿ä¹‹ååˆ°æ¥, æˆ‘ä»¬å¿…é¡»é¢å¤–åŠ ä¸€äº›ä»£ç æ¥å¤„ç†å®ƒä»¬. åä¹‹, å¦‚æœæ°´ä½çº¿è¿‡äºä¿å®ˆ, è™½ç„¶å¯ä¿¡åº¦å¾—åˆ°äº†ä¿è¯, ä½†å¯èƒ½ä¼šæ— æ‰€è°“åœ°å¢åŠ å¤„ç†å»¶æ—¶.</p><p>&emsp;æ— è®ºæ°´ä½çº¿æ˜¯ç”±ç”¨æˆ·å®šä¹‰è¿˜æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„, åªè¦å­˜åœ¨â€æ‹–åè…¿â€çš„ä»»åŠ¡, è¿½è¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å…¨å±€è¿›åº¦å°±å¯èƒ½å‡ºç°é—®é¢˜, å› æ­¤ç®€å•åœ°ä¾èµ–æ°´ä½çº¿å¹¶ä¸æ˜¯æ€»å¯ä»¥é«˜æ•æ— å¿§. è€Œæµå¤„ç†ç³»ç»Ÿå¾ˆå…³é”®çš„ä¸€ç‚¹æ˜¯èƒ½å¤Ÿæä¾›æŸäº›æœºåˆ¶æ¥å¤„ç†é‚£äº›å¯èƒ½æ™šäºæ°´ä½çº¿çš„åƒåˆ°æ—¶é—´. æ ¹æ®åº”ç”¨éœ€æ±‚çš„ä¸åŒ, ä½ å¯èƒ½ä¼šç›´æ¥å¿½ç•¥è¿™äº›äº‹ä»¶, å°†ä»–ä»¬å†™å…¥æ—¥å¿—æˆ–è€…åˆ©ç”¨å®ƒä»¬å»ä¿®æ­£ä¹‹å‰çš„ç»“æœ. </p><h1 id="ç®€å•æ¶æ„æè¿°"><a href="#ç®€å•æ¶æ„æè¿°" class="headerlink" title="ç®€å•æ¶æ„æè¿°"></a>ç®€å•æ¶æ„æè¿°</h1><h2 id="äº‹ä»¶æ—¶é—´å¤„ç†"><a href="#äº‹ä»¶æ—¶é—´å¤„ç†" class="headerlink" title="äº‹ä»¶æ—¶é—´å¤„ç†"></a>äº‹ä»¶æ—¶é—´å¤„ç†</h2><p>&emsp;è™½ç„¶å¤„ç†æ—¶é—´ä¸–å±…äºå¤„ç†æœºå™¨çš„æœ¬åœ°äº‹ä»¶, ç›¸å¯¹å®¹æ˜“ç†è§£, ä½†æ˜¯å®ƒä¼šäº§ç”Ÿä¸€äº›è¾ƒä¸ºéšæ„, ä¸ä¸€è‡´ä¸”æ— æ³•é‡ç°çš„ç»“æœ. ç›¸å, äº‹ä»¶æ—¶é—´è¯­ä¹‰ä¼šç”Ÿæˆå¯é‡ç°ä¸”ä¸€è‡´æ€§çš„ç»“æœ, è¿™ä¹Ÿæ˜¯å¾ˆå¤šæµå¤„ç†ç”¨ä¾‹çš„åˆšéœ€, ä½†å’ŒåŸºäºå¤„ç†æ—¶é—´è¯­ä¹‰çš„åº”ç”¨ç›¸æ¯”, åŸºäºäº‹ä»¶æ—¶é—´çš„åº”ç”¨éœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®, æ­¤å¤–, ç›¸æ¯”çº¯ç²¹ä½¿ç”¨å¤„ç†æ—¶é—´çš„å¼•æ“, æ”¯æŒäº‹ä»¶æ—¶é—´çš„æµå¤„ç†å¼•æ“å†…éƒ¨è¦æ›´åŠ çš„å¤æ‚.</p><p>&emsp;Flinkä¸ä»…é’ˆå¯¹å¸¸è§çš„äº‹ä»¶æ—¶é—´æä¾›äº†ç›´è§‚æ˜“ç”¨çš„åŸè¯­, è¿˜æ”¯æŒä¸€äº›è¡¨è¾¾èƒ½åŠ›å¾ˆå¼ºçš„API, å…è®¸ä½¿ç”¨è€…ä»¥è‡ªå®šä¹‰ç®—å­çš„æ–¹å¼æ—¶é—´æ›´é«˜çº§çš„äº‹ä»¶æ—¶é—´å¤„ç†åº”ç”¨. åœ¨é¢å¯¹è¿™äº›é«˜çº§åº”ç”¨çš„æ—¶å€™, å……åˆ†ç†è§£Flinkå†…éƒ¨äº‹ä»¶å¤„ç†æœºåˆ¶é€šå¸¸ä¼šæœ‰æ‰€å¸®åŠ©. æœ‰æ—¶å€™æ›´æ˜¯å¿…è¦çš„, Flinkåœ¨å¤„ç†æ—¶é—´è¯­ä¹‰æ—¶æ‰€é‡‡ç”¨çš„ä¸¤ä¸ªæ¦‚å¿µåˆ†åˆ«æ—¶: è®°å½•æ—¶é—´æˆ³å’Œæ°´ä½çº¿. æ¥ä¸‹è€ä¼šä»‹ç»Flinkå†…éƒ¨å¦‚ä½•å®ç°å’Œå¤„ç†æ—¶é—´æˆ³ä»¥åŠæ°´ä½çº¿ä»¥æ”¯æŒäº‹ä»¶æ—¶é—´è¯­ä¹‰çš„æµå¼åº”ç”¨</p><h2 id="æ—¶é—´æˆ³"><a href="#æ—¶é—´æˆ³" class="headerlink" title="æ—¶é—´æˆ³"></a>æ—¶é—´æˆ³</h2><p>&emsp;åœ¨äº‹ä»¶æ—¶é—´æ¨¡å¼ä¸‹, Flinkæµå¼åº”ç”¨å¤„ç†çš„æ‰€æœ‰è®°å½•éƒ½å¿…é¡»åŒ…å«æ—¶é—´æˆ³, æ—¶é—´æˆ³å°†è®°å½•å’Œç‰¹å®šçš„æ—¶é—´ç‚¹è¿›è¡Œå…³è”, è¿™äº›æ—¶é—´ç‚¹é€šå¸¸æ—¶è®°å½•æ‰€å¯¹åº”äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´. ä½†å®é™…ä¸Šåº”ç”¨å¯ä»¥è‡ªç”±é€‰æ‹©æ—¶é—´æˆ³çš„å«ä¹‰, åªè¦ä¿è¯æµè®°å½•çš„æ—¶é—´æˆ³ä¼šéšç€æ•°æ®æµçš„å‰è¿›å¤§è‡´é€’å¢å³å¯, æ­£å¦‚â€æ—¶é—´è¯­ä¹‰â€ä¸­æ‰€è¿°, åŸºæœ¬ä¸Šæ‰€æœ‰ç°å®åº”ç”¨åœºæ™¯éƒ½ä¼šå‡ºç°ä¸€å®šç¨‹åº¦çš„æ—¶é—´æˆ³ä¹±åº. </p><p>&emsp;å½“Flinkä»¥äº‹ä»¶æ—¶é—´æ¨¡å¼å¤„ç†æ•°æ®çš„æ—¶å€™, ä¼šæ ¹æ®è®°å½•çš„æ—¶é—´æˆ³è§¦å‘äº‹ä»¶ç›¸å…³ç®—å­çš„è®¡ç®—, ä¾‹å¦‚, æ—¶é—´çª—å£ç®—å­ä¼šæ ¹æ®è®°å½•å…³è”çš„æ—¶é—´æˆ³å°†å…¶åˆ†é…åˆ°çª—å£ä¸­. **Flinkå†…éƒ¨é‡‡ç”¨8å­—èŠ‚çš„Longå€¼å¯¹æ—¶é—´æˆ³è¿›è¡Œç¼–ç , å¹¶å°†å®ƒä»¬ä»¥å…ƒæ•°æ®(metadata)çš„å½¢å¼é™„åŠ åœ¨è®°å½•ä¸Š. ** å†…ç½®ç®—å­ä¼šå°†è¿™ä¸ªLongå€¼è§£æä¸ºæ¯«ç§’ç²¾åº¦çš„Unix. ä½†æ˜¯è‡ªå®šä¹‰ç®—å­å¯ä»¥æœ‰è‡ªå·±çš„æ—¶é—´æˆ³è§£ææœºåˆ¶, å¦‚å°†ç²¾åº¦è°ƒæ•´ä¸ºå¾®ç§’.</p><h2 id="æ°´ä½çº¿-1"><a href="#æ°´ä½çº¿-1" class="headerlink" title="æ°´ä½çº¿"></a>æ°´ä½çº¿</h2><p>&emsp;é™¤äº†è®°å½•çš„æ—¶é—´æˆ³, FlinkåŸºäºäº‹ä»¶æ—¶é—´çš„åº”ç”¨è¿˜å¿…é¡»æä¾›æ°´ä½çº¿(watermark). æ°´ä½çº¿ç”¨äºåœ¨äº‹ä»¶æ—¶é—´åº”ç”¨ä¸­æ¨æ–­æ¯ä¸ªä»»åŠ¡å½“å‰çš„äº‹ä»¶æ—¶é—´. åŸºäºæ—¶é—´çš„ç®—å­ä¼šä½¿ç”¨è¿™ä¸ªæ—¶é—´æ¥è§¦å‘è®¡ç®—å¹¶æ¨åŠ¨è¿›åº¦å‰è¿›, ä¾‹å¦‚: åŸºäºæ—¶é—´çª—å£çš„ä»»åŠ¡ä¼šä½¿å…¶äº‹ä»¶æ—¶é—´è¶…è¿‡çª—å£ç»“æŸè¾¹ç•Œæ—¶è¿›è¡Œæœ€ç»ˆçš„çª—å£è®¡ç®—å¹¶å‘å‡ºç»“æœ.</p><p>&emsp;åœ¨Flinkä¸­, æ°´ä½çº¿æ˜¯åˆ©ç”¨ä¸€äº›åŒ…å«Longå€¼æ—¶é—´æˆ³çš„ç‰¹æ®Šè®°å½•æ¥å®ç°çš„. å¦‚å›¾æ‰€ç¤º, å®ƒä»¬åƒå¸¦æœ‰é¢å¤–æ—¶é—´æˆ³çš„å¸¸è§„è®°å½•ä¸€æ ·åœ¨æ•°æ®ä¸­æµåŠ¨</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211211204651727.png"></p><h3 id="æ°´ä½çº¿å…·æœ‰ä¸¤ä¸ªåŸºæœ¬å±æ€§"><a href="#æ°´ä½çº¿å…·æœ‰ä¸¤ä¸ªåŸºæœ¬å±æ€§" class="headerlink" title="æ°´ä½çº¿å…·æœ‰ä¸¤ä¸ªåŸºæœ¬å±æ€§"></a>æ°´ä½çº¿å…·æœ‰ä¸¤ä¸ªåŸºæœ¬å±æ€§</h3><ol><li>å¿…é¡»æ˜¯å•è°ƒé€’å¢çš„,è¿™æ˜¯ä¸ºäº†ç¡®ä¿ä»»åŠ¡ä¸­çš„äº‹ä»¶æ—¶é—´æ—¶é’Ÿæ­£ç¡®å‰è¿›, ä¸ä¼šå€’é€€</li><li>å’Œè®°å½•çš„æ—¶é—´æˆ³å­˜åœ¨è”ç³», ä¸€ä¸ªæ—¶é—´æˆ³ä¸ºTçš„æ°´ä½çº¿è¡¨ç¤º, æ¥ä¸‹æ¥æ‰€æœ‰è®°å½•çš„æ—¶é—´æˆ³ä¸€å®šéƒ½å¤§äºT</li></ol><p>&emsp;<strong>ç¬¬äºŒä¸ªå±æ€§å¯ç”¨æ¥å¤„ç†æ•°æ®æµä¸­æ—¶é—´æˆ³ä¹±åºçš„è®°å½•, ä¾‹å¦‚ä¸Šå›¾ä¸­æ—¶é—´æˆ³ä¸º3å’Œ5çš„è®°å½•å¯èƒ½ä¼šåŒ…å«ä¹±åºçš„æ—¶é—´æˆ³, è¿™äº›ç®—å­åªæœ‰å½“è‡ªå·±çš„äº‹ä»¶ä¹‹ä¸­(ç”±æ¥å—çš„æ°´ä½çº¿é©±åŠ¨)æŒ‡ç¤ºä¸å¿…å†ç­‰é‚£äº›åŒ…å«ç›¸å…³æ—¶é—´æˆ³çš„è®°å½•çš„æ—¶å€™,  æ‰ä¼šæœ€ç»ˆè§¦å‘è®¡ç®—.</strong> å½“ä»»åŠ¡æ”¶åˆ°ä¸€ä¸ªè¿åæ°´å¹³çº¿å±æ€§, å³æ—¶é—´æˆ³å°äºæˆ–è€…å‰ä¸€ä¸ªæ°´ä½çº¿çš„è®°å½•çš„æ—¶å€™, è¯¥è®°å½•æœ¬åº”è¯¥å‚ä¸çš„è®¡ç®—å¯èƒ½å·²ç»å®Œæˆ, æˆ‘ä»¬ç§°æ­¤ç±»è®°å½•ä¸ºè¿Ÿåˆ°æ•°æ®(late record).  ä¸ºäº†å¤„ç†è¿Ÿåˆ°çš„æ•°æ®, Flinkæä¾›äº†ä¸åŒçš„æœºåˆ¶, åé¢ä¼šæ¥å—å¯¹äºè¿Ÿåˆ°æ•°æ®çš„å¤„ç†</p><p>&emsp;æ°´å¹³çº¿çš„æ„ä¹‰ä¹‹ä¸€åœ¨äºå®ƒå…è®¸åº”ç”¨æ§åˆ¶ç»“æœçš„å®Œæ•´æ€§å’Œå»¶è¿Ÿ. å¦‚æœæ°´ä½çº¿å’Œè®°å½•çš„æ—¶é—´æˆ³éå¸¸æ¥è¿‘, é‚£ç»“æœçš„å¤„ç†å»¶è¿Ÿå°±ä¼šå¾ˆä½, å› ä¸ºä»»åŠ¡æ— éœ€ç­‰å¾…è¿‡å¤šè®°å½•å°±å¯ä»¥è§¦å‘æœ€ç»ˆçš„è®¡ç®—.  ä½†æ˜¯åŒæ—¶ç»“æœçš„å®Œæ•´æ€§å¯èƒ½ä¼šå—åˆ°å½±å“, å› ä¸ºå¯èƒ½æœ‰éƒ¨åˆ†ç›¸å…³è®°å½•è¢«è§†ä¸ºæ˜¯è¿Ÿåˆ°çš„æ•°æ®, æ²¡èƒ½å‚ä¸è¿ç®—. ç›¸å, éå¸¸â€ä¿å®ˆâ€çš„æ°´ä½çº¿ä¼šå¢åŠ å¤„ç†çš„å»¶è¿Ÿ,  ä½†åŒæ—¶ç»“æœçš„å®Œæ•´æ€§ä¹Ÿä¼šæœ‰æ‰€æå‡.</p><h2 id="æ°´ä½çº¿ä¼ æ’­å’Œäº‹ä»¶æ—¶é—´"><a href="#æ°´ä½çº¿ä¼ æ’­å’Œäº‹ä»¶æ—¶é—´" class="headerlink" title="æ°´ä½çº¿ä¼ æ’­å’Œäº‹ä»¶æ—¶é—´"></a>æ°´ä½çº¿ä¼ æ’­å’Œäº‹ä»¶æ—¶é—´</h2><p>Flinkå†…éƒ¨å°†æ°´ä½çº¿å®ç°ä¸ºç‰¹æ®Šçš„è®°å½•,  å®ƒä»¬å¯ä»¥é€šè¿‡ç®—å­ä»»åŠ¡è¿›è¡Œæ¥å—å’Œå‘é€, ä»»åŠ¡å†…éƒ¨çš„æ—¶é—´æœåŠ¡ (time service)ä¼šç»´æŠ¤ä¸€äº›è®¡æ—¶å™¨(timer),  å®ƒä»¬ä¾é æ¥æ”¶åˆ°æ°´ä½çº¿æ¥æ¿€æ´». è¿™äº›è®¡æ—¶å™¨æ˜¯ç”±ä»»åŠ¡å†æ—¶é—´æœåŠ¡å†…æ³¨å†Œ, å¹¶åœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œè®¡ç®—. ä¾‹å¦‚, çª—å£ç®—å­ä¼šä¸ºæ¯ä¸ªæ´»åŠ¨çª—å£æ³¨å†Œä¸€ä¸ªè®¡æ—¶å™¨, å®ƒä»¬ä¼šåœ¨äº‹ä»¶æ—¶é—´è¶…è¿‡çª—å£çš„ç»“æŸæ—¶é—´æ—¶æ¸…ç†çª—å£çŠ¶æ€.</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flink </tag>
            
            <tag> Watermark </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flink-Windowså‡½æ•°</title>
      <link href="/2010/12/12/Flink-Windows%E5%87%BD%E6%95%B0/"/>
      <url>/2010/12/12/Flink-Windows%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒå¼•ç”¨é“¾æ¥: </p><ul><li><a href="https://github.com/legendtkl/paper_reading/blob/main/realtime-compute/Chandy-Lamport.md">åˆ†å¸ƒå¼å¿«ç…§ç®—æ³•: Chandy-Lamport</a></li><li>äº”åˆ†é’Ÿå­¦å¤§æ•°æ®å¾®ä¿¡å…¬ä¼—å·</li><li>å°šç¡…è°·å¤§æ•°æ®å­¦ä¹ æ–‡æ¡£</li><li>Flink1.13å®˜æ–¹æ–‡æ¡£</li></ul><h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>windows are at the heart of processing infinite streams. Windows split the stream into â€œbucketsâ€ of finite size, over which we can apply computations. This document focuses on how windowing is performed in Flink and how the programmer can benefit to the maximum from its offered functitonality.</p><p>The general structure if w windowed Flink program is presented below, The first snippet refers to keyed streams, while the second to non-keyed ones. As one can see, the only difference is the keyBy(â€¦) call for the keyed streams and the window(â€¦) which becomes windowAll(â€¦) for non-keyed streams, This is also going to serve as a roadmap for the rest of the page.</p><blockquote><p>windowsæ˜¯å¤„ç†æ— ç•Œæµçš„æ ¸å¿ƒ. windowså°†æµåˆ†æˆæœ‰é™å¤§å°çš„â€æ¡¶â€, æˆ‘ä»¬å¯ä»¥åœ¨è¿™äº›æ¡¶ä¸Šæ˜ ç”¨è®¡ç®—. æˆ‘ä»¬é‡ç‚¹ä»‹ç»å¦‚ä½•åœ¨Flinkä¸­æ‰§è¡Œçª—å£åŒ–ä»¥åŠç¨‹åºå‘˜å¦‚ä½•ä»å…¶æä¾›çš„åŠŸèƒ½ä¸­è·å¾—æœ€å¤§çš„æ”¶ç›Š</p><p>çª—å£åŒ–çš„Flinkçš„ç¨‹åºä¸€èˆ¬ç»“æ„å¦‚ä¸‹æ‰€ç¤º. ç¬¬ä¸€ä¸ªç‰‡æ®µæ˜¯æŒ‡ç›‘æ§æµ, ç¬¬äºŒä¸ªæŒ‡æ§çš„æ˜¯éé”®æ§æµ, å¦‚æ‚¨æ‰€è§, å”¯ä¸€çš„åŒºåˆ«æ˜¯keyBy(â€¦)å¯¹é”®æ§æµçš„è°ƒç”¨æ˜¯window, å¯¹äºéé”®æ§æµè°ƒç”¨çš„æ˜¯windowAll. è¿™ä¹Ÿå°†ä½œä¸ºé¡µé¢å…¶ä½™éƒ¨åˆ†çš„è·¯çº¿å›¾</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">stream</span><br><span class="line">       .keyBy(...)               &lt;-  keyed versus non-keyed windows</span><br><span class="line">       .window(...)              &lt;-  required: <span class="string">&quot;assigner&quot;</span></span><br><span class="line">      [.trigger(...)]            &lt;-  optional: <span class="string">&quot;trigger&quot;</span> (<span class="keyword">else</span> <span class="keyword">default</span> trigger)</span><br><span class="line">      [.evictor(...)]            &lt;-  optional: <span class="string">&quot;evictor&quot;</span> (<span class="keyword">else</span> no evictor)</span><br><span class="line">      [.allowedLateness(...)]    &lt;-  optional: <span class="string">&quot;lateness&quot;</span> (<span class="keyword">else</span> zero)</span><br><span class="line">      [.sideOutputLateData(...)] &lt;-  optional: <span class="string">&quot;output tag&quot;</span> (<span class="keyword">else</span> no side output <span class="keyword">for</span> late data)</span><br><span class="line">       .reduce/aggregate/apply()      &lt;-  required: <span class="string">&quot;function&quot;</span></span><br><span class="line">      [.getSideOutput(...)]      &lt;-  optional: <span class="string">&quot;output tag&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">stream</span><br><span class="line">       .windowAll(...)           &lt;-  required: <span class="string">&quot;assigner&quot;</span></span><br><span class="line">      [.trigger(...)]            &lt;-  optional: <span class="string">&quot;trigger&quot;</span> (<span class="keyword">else</span> <span class="keyword">default</span> trigger)</span><br><span class="line">      [.evictor(...)]            &lt;-  optional: <span class="string">&quot;evictor&quot;</span> (<span class="keyword">else</span> no evictor)</span><br><span class="line">      [.allowedLateness(...)]    &lt;-  optional: <span class="string">&quot;lateness&quot;</span> (<span class="keyword">else</span> zero)</span><br><span class="line">      [.sideOutputLateData(...)] &lt;-  optional: <span class="string">&quot;output tag&quot;</span> (<span class="keyword">else</span> no side output <span class="keyword">for</span> late data)</span><br><span class="line">       .reduce/aggregate/apply()      &lt;-  required: <span class="string">&quot;function&quot;</span></span><br><span class="line">      [.getSideOutput(...)]      &lt;-  optional: <span class="string">&quot;output tag&quot;</span></span><br></pre></td></tr></table></figure><p>In the above, the commands in square brackets ([â€¦]) are optional. This reveals that Flink allows you to customize your windowing logic in many different ways so that it best fits your needs.</p><blockquote><p>åœ¨ä¸Šé¢, æ–¹æ‹¬å·([â€¦])ä¸­çš„å‘½ä»¤æ˜¯å¯é€‰çš„, è¿™è¡¨æ˜Flinkå…è®¸æ‚¨ä»¥å¤šç§ä¸åŒçš„æ–¹å¼è‡ªå®šä¹‰çª—å£é€»è¾‘, ä½¿å…¶æœ€é€‚åˆæ‚¨çš„éœ€æ±‚.</p></blockquote><pre class="mermaid">graph LR    subgraph bound1        a[Event] --> b[Event] --> c[Event]    end    subgraph bound2        c --> d[Event] --> e[Event] --> f[Event]    end    f --> g[Event] --> h[Event] --> ...</pre><h1 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h1><p>in a nutshell , a window is created as soon as the first element that should belong to this window arrives, and the window is conpletely removed when the time (even or processing time) passes its end timestamp plus the user-specified allowed lastness(see <a href="https://nightlies.apache.org/flink/flink-docs-release-1.13/zh/docs/dev/datastream/operators/windows/#allowed-lateness">Allowed Lateness</a>). Flink guarantees removal only for time-based windows and not for other types, eg. global windows (see <a href="https://nightlies.apache.org/flink/flink-docs-release-1.13/zh/docs/dev/datastream/operators/windows/#window-assigners">Window Assigners</a>). For Exemple , with an event-time-based windowing strategy that creates non-overlapping(or tumbling) windwos every 5 minutes and has an allowed lateness of 1 min, Flink will create a new window for the interval between 12:00 and 12:05 when the first element with a timestamp that falls into this interval arrives, and it will remove it when the watermark passes the 12:06 timestamp.</p><blockquote><p>ç®€è€Œè¨€ä¹‹, å½“åœ°ä¸€ä¸ªåº”è¯¥å±äºè¿™ä¸ªåˆ›å»ºå£çš„å…ƒç´ åˆ°è¾¾çš„æ—¶å€™, å°±ä¼šåˆ›å»ºä¸€ä¸ªçª—å£, è€Œå½“æ—¶é—´(äº‹ä»¶äº‹ä»¶æˆ–è€…å¤„ç†æ—¶é—´)è¶…è¿‡å…¶ç»“æŸæ—¶é—´æˆ³åŠ ä¸Šç”¨æˆ·æŒ‡å®šçš„å…è®¸å»¶è¿Ÿæ—¶, è¯¥çª—å£å°±ä¼šè¢«å®Œå…¨åˆ é™¤. Flinkåªä¿è¯åŸºäºæ—¶é—´çš„çª—å£çš„æº¢å‡º, è€Œä¸ä¿è¯å…¶ä»–çš„ç±»å‹, ä¾‹å¦‚å…¨å±€çª—å£. ä¾‹å¦‚, å¯¹äºä¸€ä¸ªåŸºäºäº‹ä»¶äº‹ä»¶çš„çª—å£ç­–ç•¥, æ¯äº”åˆ†é’Ÿåƒuæ˜‚å»ºä¸€ä¸ªä¸é‡å (æˆ–è€…ç¿»æ»š)çš„çª—å£, å¹¶ä¸”å…è®¸åˆ†é’Ÿçš„å»¶è¿Ÿ, å½“åœ°ä¸€ä¸ªè‚²æœ‰æ—¶é—´æˆ³çš„å…ƒç´ åˆ°è¾¾è¿™ä¸ªåŒºé—´çš„æ—¶å€™, Flinkå°†ä¸º12:00å’Œ12:05ä¹‹é—´çš„åŒºé—´åˆ›å»ºä¸€ä¸ªæ–°çš„çª—å£, å¹¶ä¸”å½“æ°´å°é€šè¿‡12:06çš„æ—¶é—´æˆ³çš„æ—¶å€™, å°†ä¼šåˆ é™¤</p></blockquote><p>in addition, each window will have a Trigger (see <a href="https://nightlies.apache.org/flink/flink-docs-release-1.13/zh/docs/dev/datastream/operators/windows/#triggers">Trigger</a>) and a function(ProcessWindowFunction, ReduceFunction, Or AggregateFunction)(see <a href="https://nightlies.apache.org/flink/flink-docs-release-1.13/zh/docs/dev/datastream/operators/windows/#window-functions">Window Functions</a>) attached to it, The function will contain the computation to be applied to the contents of the window , while the Trigger specifies the condition of the windwo , window is considered ready for the function to be applied. A triggering policy might be something like â€œwhen the number of elements in the window is more than 4â€, or â€œwhen the watermark passes the end of the windowâ€. A trigger can also decide to purge a windowâ€™s contents any time between its creation and removal , Purging in this case only refers to the elements in the window, and not the window metadata. This means that new data can still be added to that window.</p><blockquote><p>æ­¤å¤–, æ¯ä¸€ä¸ªçª—å£éƒ½ä¼šæœ‰ä¸€ä¸ªè§¦å‘å™¨å’Œä¸€ä¸ªå‡½æ•°(ProcessWindowFunction,ReduceFunctionæˆ–åˆ™AggregateFunction)é™„åŠ åˆ°å®ƒ. è¯¥å‡½æ•°å°†åŒ…å«åº”ç”¨äºçª—å£å†…å®¹çš„è®¡ç®—, è€Œè§¦å‘å™¨åˆ™æŒ‡å®šçª—å£è¢«è®¤ä¸ºæœ±å®‰å¤‡å¥½åº”ç”¨è¯¥å‡½æ•°çš„æ¡ä»¶. è§¦å‘ç­–ç•¥å¯èƒ½æ˜¯â€å½“çª—å£ä¸­çš„å…ƒç´ æ•°é‡è¶…è¿‡4â€æˆ–è€…â€å½“æ°´å°é€šè¿‡çª—å£çš„æœ«ç«¯çš„æ—¶å€™â€. è§¦å‘å™¨ä¹Ÿå¯ä»¥å†³å®šçª—å£åˆ›å»ºå’Œåˆ é™¤ä¹‹é—´çš„ä»»ä½•æ—¶é—´æ¸…é™¤å…¶ä¸­çš„å†…å®¹. åœ¨è¿™ç§æƒ…å†µä¸‹, æ¸…é™¤åªæŒ‡çª—å£ä¸­çš„å…ƒç´ , è€Œä¸æ˜¯çª—å£çš„å…ƒæ•°æ®. è¿™æ„å‘³ç€, æ–°çš„æ•°æ®ä»ç„¶å¯ä»¥è¢«æ·»åŠ åˆ°è¯¥çª—å£.</p></blockquote><p>Apart from the above , you can specify an Evictor(see <a href="https://nightlies.apache.org/flink/flink-docs-release-1.13/zh/docs/dev/datastream/operators/windows/#evictors">Evictor</a>) which will be able to remove elements from the window after the trigger fires and before and/or after the function is applied.</p><p>In the following we go into more deetail for each of the components above. We start with the required parts in the above snippet(see <a href="https://nightlies.apache.org/flink/flink-docs-release-1.13/zh/docs/dev/datastream/operators/windows/#keyed-vs-non-keyed-windows">Keyed vs Non-Keyed Windows</a>, <a href="https://nightlies.apache.org/flink/flink-docs-release-1.13/zh/docs/dev/datastream/operators/windows/#window-assigner">Windwo Assigner</a>, and <a href="https://nightlies.apache.org/flink/flink-docs-release-1.13/zh/docs/dev/datastream/operators/windows/#window-function">Window Function</a>)before moving to the optional ones.</p><blockquote><p>é™¤äº†ä¸Šé¢çš„è¿™äº›, ä½ è¿˜å¯ä»¥æŒ‡å®šä¸€ä¸ªEvictor, ä»–å°†èƒ½å¤Ÿåœ¨è§¦å‘å™¨å‡ºå‘ä¹‹å, åœ¨å‡½æ•°åº”ç”¨ä¹‹å‰å’Œ/æˆ–è€…ä¹‹åä»çª—å£ä¸­ç§»é™¤å…ƒç´ .</p><p>åœ¨ä¸‹æ–‡ä¸­, æˆ‘ä»¬å°†ä¼šå¯¹ä¸Šè¿°çš„ç»„ä»¶è¿›è¡Œæ›´åŠ è¯¦ç»†çš„è®¨è®º, æˆ‘ä»¬ä»ä¸Šè¿°ç‰‡æ®µä¸­çš„å¿…è¦éƒ¨åˆ†å¼€å§‹, ç„¶åå†è½¬åˆ°å¯é€‰éƒ¨åˆ†</p></blockquote><h1 id="çª—å£ç±»å‹"><a href="#çª—å£ç±»å‹" class="headerlink" title="çª—å£ç±»å‹"></a>çª—å£ç±»å‹</h1><ul><li><p>æ—¶é—´çª—å£</p><p>:one:æ»šåŠ¨æ—¶é—´çª—å£</p><p>:two:æ»‘åŠ¨æ—¶é—´çª—å£</p><p>:three:ä¼šè¯çª—å£</p></li><li><p>è®¡æ•°çª—å£</p><p>:one:æ»šåŠ¨è®¡æ•°çª—å£</p><p>:two:æ»‘åŠ¨æŠ€æœ¯çª—å£</p></li></ul><h1 id="æ»šåŠ¨çª—å£"><a href="#æ»šåŠ¨çª—å£" class="headerlink" title="æ»šåŠ¨çª—å£"></a>æ»šåŠ¨çª—å£</h1><p>A tumbing windows assigner assigns each element to a window of sprcified window size. Tubming windows have a fixed size and do not overlap. For example, if you specify a tumbling window with a size of 5 minutes, the current window will be evaluated and a new window will be  started every five minutes as illisrated by the following figure.</p><blockquote><p>æ»šåŠ¨çª—å£åˆ†é…å™¨å°†æ¯ä¸ªå…ƒç´ åˆ†é…åˆ°ä¸€ä¸ªæŒ‡å®šçª—å£å¤§å°çš„çª—å£. æ»šåŠ¨çª—å£æœ‰ä¸€ä¸ªå›ºå®šçš„å°ºå¯¸, å¹¶ä¸”ä¸é‡å . ä¾‹å¦‚, å¦‚æœä½ æŒ‡å®šä¸€ä¸ªå¤§å°ä¸º5åˆ†é’Ÿçš„æ»šåŠ¨çª—å£, å½“å‰çš„çª—å£å°†ä¼šè¢«è¯„ä¼°, å¹¶ä¸”æ¯5åˆ†é’Ÿå¼€å§‹ä¸€ä¸ªæ–°çš„çª—å£. å¦‚ä¸‹å›¾æ‰€ç¤º.</p></blockquote><p><strong>:red_circle:Flinkçª—å£æ˜¯å·¦é—­å³å¼€çš„, ä¾‹å¦‚0-5sæœ€åä¸€ä¸ªæ—¶é—´æˆ³æ˜¯4999â€‹</strong></p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/tumbling-windows.svg"></p><pre class="mermaid">graph LR    A[æ•°æ®æµ]    subgraph "key1-window-[0~5]"        F[key2-event] --> G[key2-event]    end    subgraph "key1-window-[0~5]"        D[key1-event] --> E[key1-event]    end    A --> F    A --> D</pre><h1 id="æ»‘åŠ¨çª—å£"><a href="#æ»‘åŠ¨çª—å£" class="headerlink" title="æ»‘åŠ¨çª—å£"></a>æ»‘åŠ¨çª—å£</h1>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flink </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git</title>
      <link href="/2010/12/12/Git/"/>
      <url>/2010/12/12/Git/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flink-ä»‹ç»ä¸æ¶æ„</title>
      <link href="/2010/12/12/Flink-%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%9E%B6%E6%9E%84/"/>
      <url>/2010/12/12/Flink-%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%9E%B6%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒå¼•ç”¨é“¾æ¥: </p><ul><li><a href="https://github.com/legendtkl/paper_reading/blob/main/realtime-compute/Chandy-Lamport.md">åˆ†å¸ƒå¼å¿«ç…§ç®—æ³•: Chandy-Lamport</a></li><li>äº”åˆ†é’Ÿå­¦å¤§æ•°æ®å¾®ä¿¡å…¬ä¼—å·</li><li>å°šç¡…è°·å¤§æ•°æ®å­¦ä¹ æ–‡æ¡£</li><li>Flink1.13å®˜æ–¹æ–‡æ¡£</li></ul><h1 id="Flinkæµå¼å¤„ç†çš„ç®€ä»‹"><a href="#Flinkæµå¼å¤„ç†çš„ç®€ä»‹" class="headerlink" title="Flinkæµå¼å¤„ç†çš„ç®€ä»‹"></a>Flinkæµå¼å¤„ç†çš„ç®€ä»‹</h1><h2 id="Flinkæ˜¯ä»€ä¹ˆ"><a href="#Flinkæ˜¯ä»€ä¹ˆ" class="headerlink" title="Flinkæ˜¯ä»€ä¹ˆ"></a>Flinkæ˜¯ä»€ä¹ˆ</h2><p>Apache Flinkæ˜¯ä¸€ä¸ªæ¡†æ¶å’Œåˆ†å¸ƒå¼å¤„ç†å¼•æ“, å¯¹äºæœ‰ç•Œæµå’Œæ— ç•Œæµè¿›è¡ŒçŠ¶æ€è®¡ç®—.</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ol><li>æ”¯æŒé«˜åå, ä½å»¶æ—¶, é«˜æ€§èƒ½çš„å¤„ç†</li><li>æ”¯æŒå¸¦æœ‰äº‹ä»¶æ—¶é—´çš„çª—å£æ“ä½œ</li><li>æ”¯æŒæœ‰çŠ¶æ€è®¡ç®—çš„Exactly-onceè¯­ä¹‰</li><li>æ”¯æŒé«˜åº¦çµæ´»çš„çª—å£æ“ä½œ, æ”¯æŒåŸºäºtime, count, session ä»¥åŠ data-drivençš„æ“ä½œ</li><li>æ”¯æŒå…·æœ‰BackpressureåŠŸèƒ½çš„æŒç»­æµæ¨¡å‹</li><li>æ”¯æŒåŸºäºè½»é‡çº§åˆ†å¸ƒå¼å¿«ç…§ snapshotå®ç°çš„å®¹é”™</li><li>ä¸€ä¸ªè¿è¡Œæ—¶åŒæ—¶æ”¯æŒbatch on streamingå¤„ç†å’Œstreamingå¤„ç†</li><li>Flinkæ”¯æŒåœ¨jvmå†…éƒ¨å®ç°äº†è‡ªå·±çš„å†…å­˜ç®¡ç†</li><li>æ”¯æŒè¿­ä»£è®¡ç®—</li><li>æ”¯æŒç¨‹åºè‡ªåŠ¨åŒ–: é¿å…ç‰¹å®šæƒ…å†µä¸‹shuffle, æ’åºç­‰æ˜‚è´µæ“ä½œ, ä¸­é—´ç»“æœæœ‰å¿…è¦è¿›è¡Œç¼“å­˜</li></ol><h2 id="FlinkåŸºçŸ³"><a href="#FlinkåŸºçŸ³" class="headerlink" title="FlinkåŸºçŸ³"></a>FlinkåŸºçŸ³</h2><p>Flinkä¹‹æ‰€ä»¥è¿™ä¹ˆæµç•…, ç¦»ä¸å¼€å®ƒæœ€é‡è¦çš„å››ä¸ªåŸºçŸ³ : CheckPoint, State, Time, Window</p><h3 id="CheckPoint"><a href="#CheckPoint" class="headerlink" title="CheckPoint"></a>CheckPoint</h3><p>CheckPointæœºåˆ¶, è¿™æ˜¯Flinkæœ€é‡è¦çš„ä¸€ä¸ªç‰¹æ€§, FlinkåŸºäºChandy-Lamportç®—æ³•å®ç°äº†ä¸€ä¸ªåˆ†å¸ƒå¼çš„ä¸€è‡´æ€§å¿«ç…§, ä»è€Œæä¾›äº†ä¸€è‡´æ€§çš„è¯­ä¹‰. <a href="https://github.com/legendtkl/paper_reading/blob/main/realtime-compute/Chandy-Lamport.md">Chandy-Lamport</a>ç®—æ³•æ˜¯åœ¨1985å¹´çš„æ—¶å€™è¢«æå‡ºæ¥äº†, ä½†æ˜¯å¹¶æ²¡æœ‰è¢«å¾ˆå¹¿æ³›çš„åº”ç”¨, è€ŒFlinkåˆ™æ˜¯å°†è¿™ä¸ªç®—æ³•å‘æ‰¬å…‰å¤§äº†</p><blockquote><p>Chandy-Lamport</p><p> Spark çš„ Structured Streaming çš„ Continuous Processing Mode çš„å®¹é”™å¤„ç†ä½¿ç”¨äº†åˆ†å¸ƒå¼å¿«ç…§ï¼ˆDistributed Snapshotï¼‰ç®—æ³• Chandy-Lamport ç®—æ³•</p></blockquote><h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p>æä¾›äº†ä¸€è‡´æ€§çš„è¯­ä¹‰ä¹‹å, ä¸ºäº†æ›´åŠ è½»æ¾çš„ç®¡ç†çŠ¶æ€, æä¾›äº†ä¸€å¥—ç®€å•æ˜äº†çš„çŠ¶æ€API, é‡Œé¢æä¾›äº†ValueState, ListState, MapState, BroadCastStateç­‰, ä½¿å¾—State APIèƒ½å¤Ÿè‡ªåŠ¨çš„äº«å—ä¸€è‡´æ€§çš„è¯­ä¹‰</p><h3 id="Watermark"><a href="#Watermark" class="headerlink" title="Watermark"></a>Watermark</h3><p>èƒ½å¤Ÿæ”¯æŒåŸºäºæ—¶é—´çš„æ—¶é—´çš„å¤„ç†, æˆ–è€…è¯´åŸºäºç³»ç»Ÿæ—¶é—´çš„å¤„ç†, èƒ½å¤Ÿå®¹å¿æ•°æ®çš„å»¶æ—¶, å®¹å¿æ•°æ®çš„è¿Ÿåˆ°, å®¹å¿ä¹±åºçš„æ•°æ®</p><h3 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h3><p>Flinkæä¾›äº†å¼€ç®±å³ç”¨çš„å„ç§çª—å£, æ¯”å¦‚æ»‘åŠ¨çª—å£, æ»šåŠ¨çª—å£, ä¼šè¯çª—å£ä»¥åŠéå¸¸çµæ´»çš„è‡ªå®šä¹‰çš„çª—å£</p><h2 id="æ‰¹å¤„ç†å’Œæµå¤„ç†"><a href="#æ‰¹å¤„ç†å’Œæµå¤„ç†" class="headerlink" title="æ‰¹å¤„ç†å’Œæµå¤„ç†"></a>æ‰¹å¤„ç†å’Œæµå¤„ç†</h2><p>Flinkåˆ†åˆ«æä¾›äº†é¢å‘æµå¼å¤„ç†çš„æ¥å£(Data Stream API)å’Œé¢å‘æ‰¹å¤„ç†çš„(DataSet API), å› æ­¤Flinkæ—¢å¯ä»¥å®Œæˆæµå¼å¤„ç†, ä¹Ÿå¯ä»¥å®Œæˆæ‰¹å¤„ç†</p><h1 id="Flinkè¿è¡Œæ¶æ„"><a href="#Flinkè¿è¡Œæ¶æ„" class="headerlink" title="Flinkè¿è¡Œæ¶æ„"></a>Flinkè¿è¡Œæ¶æ„</h1><h2 id="æ¶æ„å¯¹æ¯”"><a href="#æ¶æ„å¯¹æ¯”" class="headerlink" title="æ¶æ„å¯¹æ¯”"></a>æ¶æ„å¯¹æ¯”</h2><h3 id="HDFSä¸»ä»æ¶æ„"><a href="#HDFSä¸»ä»æ¶æ„" class="headerlink" title="HDFSä¸»ä»æ¶æ„"></a>HDFSä¸»ä»æ¶æ„</h3><pre class="mermaid">graph LR    A[NameNode] --> B[DataNode]    A --> C[DataNode]    A --> D[DataNode]</pre><h3 id="Sparkæ¶æ„"><a href="#Sparkæ¶æ„" class="headerlink" title="Sparkæ¶æ„"></a>Sparkæ¶æ„</h3><pre class="mermaid">graph LR     A[Driver] --> B[Executer]    A --> C[Executer]    A --> D[Executer]</pre><h3 id="Flinkæ¶æ„"><a href="#Flinkæ¶æ„" class="headerlink" title="Flinkæ¶æ„"></a>Flinkæ¶æ„</h3><p>Flinkè¿è¡Œæ—¶ç”±ä¸¤ç§ç±»å‹ç»„æˆ, ä¸€ä¸ªJobManager(ä½œä¸šç®¡ç†å™¨, Masterè¿›ç¨‹)å’Œä¸€ä¸ªæˆ–è€…å¤šä¸ªTaskManagerç»„æˆ(ä»»åŠ¡ç®¡ç†å™¨, slaveè¿›ç¨‹)</p><pre class="mermaid">graph LR    A[JobManager] --> B[TaskManager]    A --> C[TaskManager]    A --> D[TaskManager]</pre><h2 id="Flinkç¨‹åºç»“æ„"><a href="#Flinkç¨‹åºç»“æ„" class="headerlink" title="Flinkç¨‹åºç»“æ„"></a>Flinkç¨‹åºç»“æ„</h2><p>Flinkç¨‹åºçš„åŸºæœ¬ç»“æ„å—æ˜¯æµå’Œè½¬æ¢, ä»æ¦‚å¿µä¸Šè®², æµæ˜¯æ•°æ®è®°å½•çš„æµ, è€Œè½¬æ¢æ˜¯å°†ä¸€ä¸ªæˆ–è€…å¤šä¸ªæµä½œä¸ºä¸€ä»½æˆ–å¯¹å„æµçš„æ“ä½œ, è¾“å…¥, å¹¶äº§ç”Ÿä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°æ®æµ</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211112091257543.png"></p><h3 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h3><p>Source: æ•°æ®æº, Flinkåœ¨æµå¤„ç†å’Œæ‰¹å¤„ç†çš„sourceå¤§æ¦‚æœ‰4ç±»</p><blockquote><p>åŸºäºæœ¬åœ°é›†åˆçš„Source</p><p>åŸºäºæ–‡ä»¶çš„Source</p><p>åŸºäºç½‘ç»œå¥—æ¥å­—çš„Source</p><p>è‡ªå®šä¹‰çš„Source</p></blockquote><p>è‡ªå®šä¹‰çš„Sourceå¸¸è§çš„åˆApache kafka, RabbitMQç­‰, å½“ç„¶ä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„Source</p><h3 id="Transformation"><a href="#Transformation" class="headerlink" title="Transformation"></a>Transformation</h3><p>æ•°æ®è½¬åŒ–çš„å„ç§æ“ä½œ, åˆMap/FlatMap/Filter/KeyBy/Reduce/Fold/Aggregations/Window/WindowAll/Union/Window join/Split/Selectç­‰, æ“ä½œå¾ˆå¤š, å¯ä»¥å°†æ•°æ®è½¬æ¢è®¡ç®—æˆä¸ºä½ æƒ³è¦çš„æ•°æ®</p><h3 id="Sink"><a href="#Sink" class="headerlink" title="Sink"></a>Sink</h3><p>æ¥æ”¶å™¨, Flinkå°†è½¬æ¢è®¡ç®—åçš„æ•°æ®å‘é€çš„åœ°ç‚¹, éœ€è¦å­˜å‚¨æ•°æ®. Flinkå¸¸è§çš„Sinkæœ‰å¦‚ä¸‹å‡ ç±»: </p><ul><li>å†™å…¥æ–‡ä»¶</li><li>æ§åˆ¶å°æ‰“å°</li><li>å†™å…¥socket</li><li>è‡ªå®šä¹‰sink</li></ul><p>è‡ªå®šä¹‰sinkå¸¸è§çš„æœ‰Apache kafka, RabbitMQ, MySQL,ElasticSearch, Apache Cassandra, HDFSç­‰ç­‰, æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å±äºè‡ªå·±çš„sink</p><h2 id="Flinkå¹¶è¡Œæ•°æ®æµ"><a href="#Flinkå¹¶è¡Œæ•°æ®æµ" class="headerlink" title="Flinkå¹¶è¡Œæ•°æ®æµ"></a>Flinkå¹¶è¡Œæ•°æ®æµ</h2><p>Flinkç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™, ä¼šè¢«æ˜ å°„æˆä¸ºä¸€ä¸ªStreamingDataflow, ä¸€ä¸ªStreaming Dataflowæ˜¯ä¸€ç»„Streamå’ŒTransformation Operatorç»„æˆçš„. åœ¨å¯åŠ¨çš„æ—¶å€™ä»ä¸€ä¸ªæˆ–è€…å¤šä¸ªSourceOperatorå¼€å§‹, ç»“æŸè¯­ä¸€ä¸ªæˆ–è€…å¤šä¸ªSink Operator.</p><h3 id="å¹¶è¡Œå’Œåˆ†å¸ƒå¼"><a href="#å¹¶è¡Œå’Œåˆ†å¸ƒå¼" class="headerlink" title="å¹¶è¡Œå’Œåˆ†å¸ƒå¼"></a>å¹¶è¡Œå’Œåˆ†å¸ƒå¼</h3><p><strong>Flinkç¨‹åºçš„æœ¬è´¨ä¸Šæ˜¯å¹¶è¡Œçš„å’Œåˆ†å¸ƒå¼çš„,</strong> åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­, ä¸€ä¸ªæµ(stream)åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªæµçš„åˆ†åŒº, è€Œæ¯ä¸€ä¸ªoperatoråŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªoperatorå­ä»»åŠ¡. æ“ä½œå­ä»»åŠ¡ä¹‹é—´æ˜¯å½¼æ­¤ç‹¬ç«‹çš„, åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­æ‰§è¡Œ, ç”šè‡³æ˜¯åœ¨ä¸åŒçš„æœºå™¨æˆ–è€…ä¸åŒçš„å®¹å™¨ä¸Š. è€Œoperatorå­ä»»åŠ¡çš„æ•°é‡æ˜¯è¿™ä¸€ç‰¹å®šOperatorå¹¶è¡Œåº¦. ç›¸åŒç¨‹åºä¸­çš„ä¸åŒoperatoræœ‰ä¸åŒçº§åˆ«çš„å¹¶è¡Œåº¦.</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20211113141754.jpg"></p><p>ä¸€ä¸ªStreamå¯ä»¥è¢«åˆ†æˆå¤šä¸ªStreamçš„åˆ†åŒº, ä¹Ÿå°±æ˜¯Stream Partition. ä¸€ä¸ªOperatorä¹Ÿå¯ä»¥è¢«åˆ†ä¸ºå¤šä¸ªOperator Subtask, å¦‚å›¾æ‰€ç¤º. Sourceè¢«åˆ†æˆSource1å’ŒSource2, å®ƒä»¬åˆ†åˆ«æ˜¯Sourceçš„Operator Subtask. <strong>æ¯ä¸€ä¸ªOperator Subtaskéƒ½æ˜¯åœ¨ä¸åŒçš„çº¿ç¨‹å½“ä¸­ç‹¬ç«‹è¿è¡Œçš„</strong>. ä¸€ä¸ªOperatorçš„å¹¶è¡Œåº¦, å°±ç­‰äºOperator Subtaskçš„ä¸ªæ•°, ä¸Šå›¾Sourceçš„å¹¶è¡Œåº¦ä¸º2, è€Œä¸€ä¸ªStreamçš„å¹¶è¡Œåº¦å°±ç­‰äºå®ƒç”ŸæˆOperatorçš„å¹¶è¡Œåº¦</p><h3 id="One-to-One"><a href="#One-to-One" class="headerlink" title="One to One"></a>One to One</h3><p>ä¸¤ä¸ªoperatorç”¨æ­¤æ¨¡å¼ä¼ é€’çš„æ—¶å€™, ä¼šä¿æŒæ•°æ®çš„åˆ†åŒºå’Œæ•°æ®çš„æ’åº, å¦‚ä¸Šå›¾çš„Source1åˆ°Map1, å®ƒå°±ä¼šä¿ç•™Sourceçš„åˆ†åŒºç‰¹æ€§, ä»¥åŠåˆ†åŒºå…ƒç´ å¤„ç†çš„æœ‰åºæ€§.</p><h3 id="Redistributing"><a href="#Redistributing" class="headerlink" title="Redistributing"></a>Redistributing</h3><p>é‡æ–°åˆ†é…æ¨¡å¼, è¿™ç§æ¨¡å¼æˆ–æ”¹å˜æ•°æ®çš„åˆ†åŒº, æ¯ä¸€ä¸ªoperator subtask ä¼šæ ¹æ®é€‰æ‹©çš„transformationå°†æ•°æ®å‘é€åˆ°ä¸åŒçš„ç›®æ ‡subtasks, æ¯”å¦‚keyBy()ä¼šé€šè¿‡hashcodeé‡æ–°åˆ†åŒº, broadcast() å’Œ rebalance() æ–¹æ³•ä¼šéšæœºé‡æ–°åˆ†åŒº.</p><h2 id="Taskå’Œ-Operator-chain"><a href="#Taskå’Œ-Operator-chain" class="headerlink" title="Taskå’Œ Operator chain"></a>Taskå’Œ Operator chain</h2><p>Flinkçš„æ‰€æœ‰æ“ä½œéƒ½ç§°ä¹‹ä¸ºOperator, å®¢æˆ·ç«¯åœ¨æäº¤ä»»åŠ¡çš„æ—¶å€™ä¼šå¯¹Operatorè¿›è¡Œä¼˜åŒ–æ“ä½œ, èƒ½è¿›è¡Œåˆå¹¶çš„Operatorä¼šè¢«åˆå¹¶ä¸ºä¸€ä¸ªOperator, <strong>åˆå¹¶åçš„Operatorç§°ä¸ºOperator chain, å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ‰§è¡Œé“¾, æ¯ä¸ªæ‰§è¡Œé“¾ä¼šåœ¨TaskManagerä¸Šç‹¬ç«‹çš„çº¿ç¨‹ä¸­æ‰§è¡Œ.</strong></p><p>å¯¹äºåˆ†å¸ƒå¼æ‰§è¡Œï¼Œ Flinkå°†ç®—å­çš„subtasksé“¾æ¥æˆä¸ºtaskã€‚æ¯ä¸ªTaskç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œ å°†ç®—å­é“¾æ¥æˆä¸ºTaskæ˜¯ä¸ªæœ‰ç”¨çš„ä¼˜åŒ–ï¼š</p><blockquote><p>å‡å°‘äº†çº¿ç¨‹é—´ä¹‹é—´çš„åˆ‡æ¢ï¼Œ ç¼“å†²çš„å¼€é”€ï¼Œ å¹¶ä¸”å‡å°‘å»¶è¿Ÿçš„åŒæ—¶æå‡æ•´ä½“çš„ååé‡ï¼Œé“¾è¡Œä¸ºæ˜¯å¯ä»¥é…ç½®çš„</p></blockquote><p>ä½¿ç”¨äº†5ä¸ªSubTaskæ‰§è¡Œï¼Œ å› æ­¤å­˜åœ¨5ä¸ª<strong>å¹¶è¡Œ</strong>çš„çº¿ç¨‹</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/tasks_chains.svg"></p><h2 id="Flinkä»»åŠ¡è°ƒåº¦ä¸æ‰§è¡Œ"><a href="#Flinkä»»åŠ¡è°ƒåº¦ä¸æ‰§è¡Œ" class="headerlink" title="Flinkä»»åŠ¡è°ƒåº¦ä¸æ‰§è¡Œ"></a>Flinkä»»åŠ¡è°ƒåº¦ä¸æ‰§è¡Œ</h2><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/processes.svg"></p><ol><li>Flink Programä¼šå°†Program Dataflowé€šè¿‡Graph Builderæ„å»ºDataflow Graph</li><li>ActorSystemåˆ›å»ºActorå°†æ•°æ®æµå›¾å‘é€ç»™JobManagerä¸­çš„Actor</li><li>JobManageä¼šä¸æ–­æ¥å—TaskManagerçš„å¿ƒè·³ä¿¡æ¯, ä»è€Œå¯ä»¥è·å–åˆ°æœ‰æ•ˆçš„TaskManager</li><li>JobManageré€šè¿‡è°ƒåº¦å™¨åœ¨TaskManagerä¸­è°ƒåº¦æ‰§è¡ŒTask(åœ¨Fllinkä¸­ä¸­æœ€å°çš„è°ƒåº¦å•å…ƒå°±æ˜¯Task, å¯¹åº”å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹)</li><li>åœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­, taskä¸taskä¹‹é—´æ˜¯å¯ä»¥è¿›è¡Œæ•°æ®ä¼ è¾“çš„</li></ol><blockquote><p>Clientå¹¶ä¸æ˜¯è¿è¡Œæ—¶å’Œç¨‹åºæ‰§è¡Œçš„ä¸€éƒ¨åˆ†ï¼Œ è€Œæ˜¯ç”¨äºå‡†å¤‡æ•°æ®æµå¹¶å°†å…¶å‘é€ç»™JobManagerã€‚ ä¹‹åï¼Œ å®¢æˆ·ç«¯å¯ä»¥æ–­å¼€é“¾æ¥ï¼ˆåˆ†ç¦»æ¨¡å¼ï¼‰ï¼Œ æˆ–è€…ä¿æŒé“¾æ¥æ¥æ¥å—è¿›ç¨‹æŠ¥å‘Šï¼ˆé™„åŠ æ¨¡å¼ï¼‰ã€‚</p><p>å®¢æˆ·ç«¯å¯ä»¥ä½œä¸ºå‡ºå‘æ‰§è¡ŒJava/Scalaç¨‹åºçš„ä¸€éƒ¨åˆ†è¿è¡Œï¼Œ äº¦å¯ä»¥åœ¨å‘½ä»¤è¡Œè¿›ç¨‹<code>./bin/flink run ...</code>ä¸­è¿è¡Œ</p><p>å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å¯åŠ¨JobManagerå’ŒTaskManagerï¼š</p><p>ç›´æ¥åœ¨æœºå™¨ä¸Šä½œä¸ºstandaloneé›†ç¾¤å¯åŠ¨ï¼Œ åœ¨å®¹å™¨ä¸­å¯åŠ¨ï¼Œ æˆ–è€…é€šè¿‡yarnæˆ–è€…mesosç­‰èµ„æºæ¡†æ¶ç®¡ç†å¹¶å¯åŠ¨ï¼Œ TaskManagerè¿æ¥åˆ°JobManager, å®£å¸ƒè‡ªå·±å¯ç”¨ï¼Œ å¹¶åˆ†é…å·¥ä½œ</p></blockquote><h3 id="JobClient"><a href="#JobClient" class="headerlink" title="JobClient"></a>JobClient</h3><ol><li>ä¸»è¦å·¥ä½œæ˜¯æäº¤ä»»åŠ¡, æäº¤ä¹‹åå¯ä»¥ç»“æŸè¿›ç¨‹, ä¹Ÿå¯ä»¥ç­‰å¾…ç»“æœè¿”å›</li><li>JobClientä¸æ˜¯Flinkç¨‹åºæ‰§è¡Œçš„å†…éƒ¨éƒ¨åˆ†, ä½†å®ƒæ˜¯ä»»åŠ¡æ‰§è¡Œçš„èµ·ç‚¹</li><li>JobClientè´Ÿè´£æ¥å—ç”¨æˆ·çš„ç¨‹åºä»£ç , ç„¶ååˆ›å»ºæ•°æ®æµ, å°†æ•°æ®æµæäº¤ç»™JobManagerä»¥ä¾¿è¿›ä¸€æ­¥æ‰§è¡Œ, æ‰§è¡Œå®Œæ¯•ä¹‹å, JobClientå°†ç»“æœè¿”å›ç»™å®¢æˆ·</li></ol><h3 id="JobManager"><a href="#JobManager" class="headerlink" title="JobManager"></a>JobManager</h3><p>ä½œä¸šç®¡ç†å™¨å°±æ˜¯ä¸€ä¸ªJVMè¿›ç¨‹, å…¶ä¸­åŒ…å«ä¸‰ç±»çº¿ç¨‹</p><p>:chestnut:ä¸‰ç±»çº¿ç¨‹</p><ul><li>ResurceManagerï¼š Flinkçš„èµ„æºç®¡ç†å™¨ï¼Œ èµ„æºæ˜¯ä»»åŠ¡æ’æ§½ï¼ˆTask Slotï¼‰</li><li>Dispatcherï¼š åˆ†å‘å™¨ï¼Œæä¾›äº†Restæ¥å£ï¼Œ ç”¨äºæäº¤Flinkåº”ç”¨ç¨‹åºï¼Œ å¹¶ä¸ºæ¯ä¸ªFlinkçš„åº”ç”¨ç¨‹åºå¯åŠ¨ä¸€ä¸ªæ–°çš„JobMaster. å®ƒè¿˜è¿è¡Œäº†FlinkWebUIç”¨æ¥æä¾›ä½œä¸šçš„æ‰§è¡Œä¿¡æ¯</li><li>JobMaster: æ¯ä¸ªä½œä¸šï¼ˆJobï¼‰å¯¹åº”ä¸€ä¸ªï¼Œè´Ÿè´£ç®¡ç†å•ä¸ªJobGraphçš„æ‰§è¡Œï¼Œ Flinkä¸­å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªä½œä¸šï¼Œ æ¯ä¸ªä½œä¸šéƒ½æœ‰è‡ªå·±çš„JobMaster</li></ul><pre class="mermaid">graph LR    A[JobManager] --> B([ResourceManager])    A --> C([Dispatcher])    A --> D([JobMaster])</pre><p>:one:ä¸»è¦èŒè´£æ˜¯è°ƒåº¦å·¥ä½œå¹¶åè°ƒä»»åŠ¡æ£€æŸ¥ç‚¹</p><p>:two:é›†ç¾¤ä¸­è‡³å°‘è¦å­˜åœ¨ä¸€ä¸ªmaster, masterè´Ÿè´£è°ƒåº¦task, åè°ƒcheckpointså’Œå®¹é”™</p><p>:three:é«˜å¯ç”¨è®¾ç½®çš„è¯å¯ä»¥æœ‰å¤šä¸ªmaster, ä½†æ˜¯ä¿è¯ä¸€ä¸ªæ˜¯leader, å…¶ä»–æ˜¯standby</p><p>:four:JobManageråŒ…å«Actor System, Scheduler, CheckPointä¸‰ä¸ªé‡è¦çš„ç»„ä»¶</p><p>:five:JobManagerä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°ä»»åŠ¡ä¹‹å, é¦–å…ˆç”Ÿæˆä¼˜åŒ–è¿‡çš„æ‰§è¡Œè®¡åˆ’, å†è°ƒåº¦åˆ°TaskManagerä¸­è¿›è¡Œæ‰§è¡Œ</p><h3 id="TaskManager"><a href="#TaskManager" class="headerlink" title="TaskManager"></a>TaskManager</h3><ul><li>TaskSlotï¼š ä»»åŠ¡æ’æ§½ï¼Œ æ˜¯ä¸€ä¸ªç‰©ç†åˆ†åŒº</li><li>ä¸åŒçš„ä»»åŠ¡æ’æ§½å°±æ˜¯ä¸åŒçš„ç‰©ç†åˆ†åŒº</li><li>æ¯ä¸ªä»»åŠ¡æ’æ§½æ˜¯ä¸€ä¸ªå†…å­˜åˆ†ç‰‡</li><li>å†…å­˜çš„æœ¬è´¨æ˜¯å­—èŠ‚æ•°ç»„</li></ul><pre class="mermaid">graph LR    A[TaskManager] --> B([Task Slot])    A --> C([Task Slot])    A --> D([Task Slot])</pre><p>:one:ä¸»è¦èŒè´£æ˜¯ä»JobManagerå¤„æ¥æ”¶ä»»åŠ¡, å¹¶éƒ¨ç½²å¯åŠ¨, æ¥å—ä¸Šæ¸¸çš„æ•°æ®å¹¶å¤„ç†</p><p>:two:TaskManageræ˜¯åœ¨JVMä¸­çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡çš„å·¥ä½œèŠ‚ç‚¹</p><p>:three:TaskManageråœ¨åˆ›å»ºä¹‹å¤„å°±è®¾ç½®å¥½äº†Slot, æ¯ä¸ªSlotå¯ä»¥æ‰§è¡Œä¸€ä¸ªä»»åŠ¡</p><h2 id="ä»»åŠ¡æ§½å’Œæ§½å…±äº«"><a href="#ä»»åŠ¡æ§½å’Œæ§½å…±äº«" class="headerlink" title="ä»»åŠ¡æ§½å’Œæ§½å…±äº«"></a>ä»»åŠ¡æ§½å’Œæ§½å…±äº«</h2><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/tasks_slots.svg"></p><p>æ¯ä¸ªTaskManageræ˜¯ä¸€ä¸ªJVMè¿›ç¨‹ï¼Œ å¯ä»¥åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­æ‰§è¡Œä¸€ä¸ªæˆ–è€…å¤šä¸ªå­ä»»åŠ¡ã€‚ ä¸ºäº†æ§åˆ¶ä¸€ä¸ªTaskManagerèƒ½å¤Ÿæ¥å—å¤šå°‘ä¸ªtaskã€‚ TaskManageré€šè¿‡task slotè¿›è¡Œæ§åˆ¶ï¼Œ ä¸€ä¸ªTaskManagerè‡³å°‘æ‹¥æœ‰ä¸€ä¸ªtask slot</p><h3 id="ä»»åŠ¡æ§½"><a href="#ä»»åŠ¡æ§½" class="headerlink" title="ä»»åŠ¡æ§½"></a>ä»»åŠ¡æ§½</h3><p>æ¯ä¸ªtask slotè¡¨ç¤ºTaskManagerè¡¨ç¤ºèµ„æºçš„ä¸€ä¸ªå›ºå®šå¤§å°çš„å­é›†</p><p>Flinkå°†è¿›ç¨‹çš„å†…å­˜åˆ’åˆ†åˆ°å¤šä¸ªslotä¸­ã€‚</p><p>é€”ä¸­æœ‰ä¸¤ä¸ªTaskManagerï¼Œ æ¯ä¸ªTaskManageræœ‰3ä¸ªslotï¼Œ æ¯ä¸ªslotå ç”¨1/3çš„å†…å­˜</p><p>å†…å­˜è¢«åˆ’åˆ†åˆ°ä¸åŒçš„slotä¹‹åå¯ä»¥è·å¾—å¦‚ä¸‹å¥½å¤„ï¼š</p><p>:one:TaskManageræœ€å¤šèƒ½åŒæ—¶å¹¶å‘æ‰§è¡Œçš„ä»»åŠ¡æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œ é‚£å°±æ˜¯3ä¸ªï¼Œ å› ä¸ºä¸èƒ½è¶…è¿‡slotçš„æ•°é‡</p><p>:two:slotæœ‰ç‹¬å çš„å†…å­˜ç©ºé—´ï¼Œ è¿™æ ·åœ¨ä¸€ä¸ªTaskManagerä¸­å¯ä»¥è¿è¡Œå¤šä¸ªä¸åŒçš„ä½œä¸šï¼Œ ä½œä¸šä¹‹é—´ä¸ä¼šå—åˆ°å½±å“ã€‚</p><h3 id="æ§½å…±äº«"><a href="#æ§½å…±äº«" class="headerlink" title="æ§½å…±äº«"></a>æ§½å…±äº«</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ Flinkå…è®¸å­ä»»åŠ¡å…±äº«æ’æ§½ï¼Œ å³ä½¿å®ƒä»¬æ˜¯ä¸åŒtaskçš„subtaskï¼Œ åªè¦å®ƒä»¬æ¥è‡ªäºåŒä¸€ä¸ªä½œä¸šï¼Œ ç»“æœæ˜¯ä¸€ä¸ªslotå¯ä»¥ä¿å­˜ä½œä¸šçš„æ•´ä¸ªç®¡é“ã€‚ å…è®¸æ’æ§½å…±äº«æœ‰ä¸¤ä¸ªä¸»è¦çš„å¥½å¤„ï¼š</p><p>:one:åªéœ€è¦è®¡ç®—Jobæœ€é«˜å¹¶è¡Œåº¦ï¼ˆparallelismï¼‰çš„task slotï¼Œ åªè¦è¿™ä¸ªæ»¡è¶³ï¼Œ å…¶ä»–çš„jobä¹Ÿå¯ä»¥æ»¡è¶³</p><p>:two:èµ„æºåˆ†é…æ›´åŠ çš„å…¬å¹³ï¼Œ å¦‚æœæœ‰æ¯”è¾ƒç©ºé—²çš„slotå¯å°†æ›´å¤šçš„ä»»åŠ¡åˆ†é…ç»™ä»–ã€‚ å›¾ä¸­è‹¥æ²¡æœ‰ä»»åŠ¡æ§½å…±äº«ï¼Œ è´Ÿè½½ä¸é«˜çš„Source/Mapç­‰subtaskå°†ä¼šå æ®è®¸å¤šçš„èµ„æºï¼Œ è€Œè´Ÿè½½è¾ƒé«˜çš„çª—å£subtaskåˆ™ä¼šç¼ºä¹èµ„æº</p><p>:three:æœ‰äº†ä»»åŠ¡æ§½å…±äº«ï¼Œ å¯ä»¥å°†åŸºæœ¬å¹¶è¡Œåº¦ï¼ˆbase parallelismï¼‰ä»2æå‡è‡³6ï¼Œ æé«˜äº†åˆ†é…èµ„æºçš„åˆ©ç”¨ç‡ã€‚ åŒæ—¶è¿˜å¯ä»¥ä¿éšœTaskManagerç»™subtaskåˆ†é…çš„slotæ–¹æ¡ˆæ›´åŠ çš„å…¬å¹³</p><h3 id="ä¸åŒçš„DAGç»“æ„-æœ‰äº‰è®®"><a href="#ä¸åŒçš„DAGç»“æ„-æœ‰äº‰è®®" class="headerlink" title="ä¸åŒçš„DAGç»“æ„(æœ‰äº‰è®®)"></a>ä¸åŒçš„DAGç»“æ„(æœ‰äº‰è®®)</h3><pre class="mermaid">graph LR    StreamGraph -->|å®¢æˆ·ç«¯| JobGraph -->|ä½œä¸šç®¡ç†å™¨| ExecutionGraph -->|éƒ¨ç½²| PhysicalGraph</pre><ul><li><p>StreamGraph: æ˜¯æ ¹æ®ç”¨æˆ·é€šè¿‡Stream APIç¼–å†™çš„ä»£ç ç”Ÿæˆçš„æœ€åˆçš„å›¾, ç”¨æ¥è¡¨ç¤ºç¨‹åºçš„æ‹“æ‰‘ç»“æ„</p></li><li><p>JobGraph: StreamGraph åœ¨ç¼–è¯‘é˜¶æ®µç»è¿‡ä¼˜åŒ–ä¹‹åç”Ÿæˆäº†JobGraph, æäº¤ç»™JobManagerçš„æ•°æ®ç»“æ„. ä¸»è¦çš„æœ‰åä¸º, å°†å¤šä¸ªç¬¦åˆæ¡ä»¶(çª„ä¾èµ–, æ²¡æœ‰shuffle, å¹¶è¡Œåº¦ç›¸åŒ)çš„ç®—ç»„ä¸²è”åœ¨ä¸€èµ·ä½œä¸ºä¸€ä¸ªèŠ‚ç‚¹, ä¿è¯ä¸²è”èµ·æ¥çš„èŠ‚ç‚¹é‡Œé¢æ‰€æœ‰çš„ç®—å­éƒ½åœ¨åŒä¸€ä¸ªä»»åŠ¡æ’æ§½æ‰§è¡Œ, è¿™æ ·ç®—å­ä¹‹é—´çš„æ•°æ®å°±æ˜¯æœ¬åœ°è½¬å‘çš„(æ— åºåºåˆ—åŒ–å’Œç½‘ç»œio), éœ€è¦ä¸¤ä¸ªæ¡ä»¶</p><blockquote><ul><li>ä¸¤ä¸ªç®—å­ä¹‹é—´æ²¡æœ‰shuffleçš„å­˜åœ¨</li><li>ä¸¤ä¸ªç®—å­çš„å¹¶è¡Œåº¦å¿…é¡»ç›¸åŒ</li></ul></blockquote></li><li><p>ExecutionGraph: JobManageræ ¹æ®JobGraphç”ŸæˆExecutionGraph, ExecutionGraphæ˜¯JobGraphçš„å¹¶è¡ŒåŒ–ç‰ˆæœ¬, æ˜¯è°ƒåº¦æ›¾æœ€æ ¸å¿ƒçš„æ•°æ®ç»“æ„</p></li><li><p>PhysicalGraph: JobManageræ ¹æ®ExecutionGraphå¯¹jobè¿›è¡Œè°ƒåº¦ä¹‹å, åœ¨å„ä¸ªTaskManagerä¸Šéƒ¨ç½²Taskåå½¢æˆçš„å›¾ , å¹¶ä¸æ˜¯å…·ä½“çš„æ•°æ®ç»“æ„</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flink </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch</title>
      <link href="/2010/12/12/ElasticSearch/"/>
      <url>/2010/12/12/ElasticSearch/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>â€‹    ElasticSearch æ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨. å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“, åŸºäºRestful webæ¥å£. ElasticSearchæ˜¯ç”¨Javaå¼€å‘çš„, å¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒ, æ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“.</p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul><li>ä¸ºç”¨æˆ·æä¾›æŒ‰å…³é”®å­—æŸ¥è¯¢çš„å…¨æ–‡æœç´¢çš„åŠŸèƒ½</li><li>å®ç°ä¼ä¸šæµ·é‡æ•°æ®çš„å¤„ç†åˆ†æçš„è§£å†³æ–¹æ¡ˆ. å¤§æ•°æ®é¢†åŸŸçš„é‡è¦çš„ä¸€ä»½å­, å¦‚è‘—åçš„ELKæ¡†æ¶</li><li>ä½œä¸ºOLAPæ•°æ®åº“, å¯¹æ•°æ®è¿›è¡Œç»Ÿè®¡åˆ†æ</li></ul><h2 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><h3 id="å¤©ç„¶çš„åˆ†å¸ƒå¼æ•°æ®åº“"><a href="#å¤©ç„¶çš„åˆ†å¸ƒå¼æ•°æ®åº“" class="headerlink" title="å¤©ç„¶çš„åˆ†å¸ƒå¼æ•°æ®åº“"></a>å¤©ç„¶çš„åˆ†å¸ƒå¼æ•°æ®åº“</h3><p>â€‹    eså°†æ•°æ®åˆ’åˆ†æˆä¸ºå¤šä¸ªshard, ä¸‹é¢çš„å›¾ä¸­P0-P2, å¤šä¸ªshard, å¯ä»¥ç»„æˆä¸€ç»„å®Œæ•´çš„æ•°æ®, è¿™äº›shardå¯ä»¥åˆ†å¸ƒåœ¨é›†ç¾¤ä¸­çš„å„ä¸ªæœºå™¨çš„èŠ‚ç‚¹ä¸­. éšç€æ•°æ®çš„ä¸æ–­å¢åŠ , é›†ç¾¤å¯ä»¥å¢åŠ å¤šä¸ªåˆ†ç‰‡, å°†å¤šä¸ªåˆ†ç‰‡æ”¾åœ¨å¤šä¸ªæœºå­ä¸Š, è¾¾åˆ°è´Ÿè½½å‡è¡¡å’Œæ¨ªå‘æ‰©å±•.</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211030141411975.png"></p><h3 id="å¤©ç„¶ç´¢å¼•ä¹‹å€’æ’ç´¢å¼•"><a href="#å¤©ç„¶ç´¢å¼•ä¹‹å€’æ’ç´¢å¼•" class="headerlink" title="å¤©ç„¶ç´¢å¼•ä¹‹å€’æ’ç´¢å¼•"></a>å¤©ç„¶ç´¢å¼•ä¹‹å€’æ’ç´¢å¼•</h3><p>â€‹    esçš„æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯é»˜è®¤è¿›è¡Œç´¢å¼•çš„, è¿™ç‚¹å’Œmysqlæ­£å¥½ç›¸å, mysqlæ˜¯é»˜è®¤ä¸åŠ ç´¢å¼•çš„, è¦æ·»åŠ ç´¢å¼•å¿…é¡»ç‰¹åˆ«è¯´æ˜, esåªæœ‰ä¸æ·»åŠ ç´¢å¼•çš„æ—¶å€™æ‰éœ€è¦è¿›è¡Œè¯´æ˜.</p><p>â€‹    è€Œä¸”esä½¿ç”¨çš„æ˜¯å€’æ’ç´¢å¼•, å’Œmysqlçš„B+Treeç´¢å¼•æ˜¯ä¸åŒçš„</p><p><strong>ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“</strong></p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211030142414194.png"></p><blockquote><p>å¼Šç«¯:</p><ol><li>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å¯¹äºå…³é”®è¯çš„æŸ¥è¯¢, åªèƒ½é€å­—é€è¡Œçš„è¿›è¡ŒåŒ¹é…, æ€§èƒ½éå¸¸å·®</li><li>åŒ¹é…çš„æ–¹å¼ä¸åˆç†, å¦‚æœç”¨likeè¿›è¡ŒåŒ¹é…, æ ¹æœ¬åŒ¹é…ä¸åˆ°. ä½†æ˜¯è€ƒè™‘åˆ°ä½¿ç”¨è€…çš„ç”¨æˆ·ä½“éªŒçš„è¯, é™¤äº†å®Œå…¨åŒ¹é…çš„è®°å½•, è¿˜åº”è¯¥æ˜¾ç¤ºä¸€éƒ¨åˆ†è¿‘ä¼¼åŒ¹é…çš„è®°å½•, è‡³å°‘åº”è¯¥åŒ¹é…åˆ°â€æ‰‹æœºâ€</li></ol></blockquote><p><strong>å€’æ’ç´¢å¼•æ˜¯æ€ä¹ˆå¤„ç†çš„</strong></p><p>å…¨æ–‡æœç´¢å¼•æ“ç›®å‰ä¸»æµçš„ç´¢å¼•æŠ€æœ¯å°±æ˜¯å€’æ’ç´¢å¼•çš„æ–¹å¼</p><p>ä¼ ç»Ÿçš„ä¿å­˜æ•°æ®çš„æ–¹å¼éƒ½æ˜¯</p><p>è®°å½• -&gt; å•è¯</p><p>å€’æ’ç´¢å¼•çš„ä¿å­˜æ•°æ®çš„æ–¹å¼æ˜¯</p><p>å•è¯ -&gt; è®°å½•</p><p>æ¯”å¦‚æœç´¢â€çº¢æµ·è¡ŒåŠ¨â€</p><p>ä½†æ˜¯æ•°æ®åº“ä¸­ä¿å­˜çš„æ•°æ®å¦‚å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211030143011898.png"></p><p>é‚£ä¹ˆæœç´¢å¼•æ“æ˜¯å¦‚ä½•èƒ½å°†ä¸¤è€…åŒ¹é…ä¸Šçš„å‘¢?</p><p>åŸºäºåˆ†è¯æŠ€æœ¯æ„å»ºå€’æ’ç´¢å¼•:</p><p>é¦–å…ˆæ¯ä¸ªè®°å½•ä¿å­˜æ•°æ®çš„æ—¶å€™, éƒ½ä¸ä¼šç›´æ¥å­˜å…¥æ•°æ®åº“, ç³»ç»Ÿä¼šå…ˆå¯¹æ•°æ®è¿›è¡Œåˆ†è¯, ç„¶åä»¥å€’æ’ç´¢å¼•ç»“æ„è¿›è¡Œä¿å­˜, å¦‚ä¸‹:</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211030143834809.png"></p><p>â€‹    ä¹‹åå½“ç”¨æˆ·è¿›è¡Œæœç´ çš„æ—¶å€™, ä¼šå°†æœç´¢çš„å…³é”®è¯ä¹Ÿè¿›è¡Œåˆ†è¯, å°†â€çº¢æµ·è¡ŒåŠ¨â€åˆ†å‰²æˆä¸ºâ€çº¢æµ·â€å’Œâ€è¡ŒåŠ¨â€ä¸¤ä¸ªå•è¯. </p><p>â€‹    è¿™æ ·çš„è¯, ä¼šå…ˆä½¿ç”¨â€çº¢æµ·â€è¿›è¡ŒåŒ¹é…, å¾—åˆ°id = 1å’Œid = 2çš„è®°å½•ç¼–å·, ç„¶åå†ç”¨â€è¡ŒåŠ¨â€åŒ¹é…å¯ä»¥è¿…é€Ÿçš„å®šä½idä¸º1å’Œ3çš„è®°å½•.</p><p>â€‹    å…¨æ–‡ç´¢å¼•é€šå¸¸è¿˜ä¼šæ ¹æ®åŒ¹é…ç¨‹åº¦è¿›è¡Œæ‰“åˆ†, æ˜¾ç„¶1å·è®°å½•èƒ½åŒ¹é…çš„æ¬¡æ•°æ›´å¤š. æ‰€ä»¥æ˜¾ç¤ºçš„æ—¶å€™ä»¥è¯„åˆ†è¿›è¡Œæ’åº, 1å·è®°å½•ä¼šæ’åˆ°æœ€å‰é¢, è€Œ2,3å·è®°å½•ä¹Ÿå¯ä»¥åŒ¹é…åˆ°</p><p><strong>ç´¢å¼•ç»“æ„å¯¹æ¯”</strong></p><p>B+Tree</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211030145330037.png"></p><p>Luceneå€’æ’ç´¢å¼•ç»“æ„</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211030145352628.png"></p><p>å¯ä»¥çœ‹åˆ°luceneä¸ºå€’æ’ç´¢å¼•éƒ¨åˆ†åˆå¢åŠ äº†ä¸€å±‚Term Indexç»“æ„, ç”¨äºå¿«é€Ÿå®šä½, è€Œè¿™ä¸ªTerm Indexæ˜¯ç¼“å­˜åœ¨å†…å­˜ä¸­çš„, ä½†æ˜¯mysqlçš„B+Treeå¹¶ä¸åœ¨å†…å­˜ä¸­, æ‰€ä»¥æ•´ä½“æ¥çœ‹ESçš„é€Ÿåº¦æ›´åŠ å¿«, ä½†æ˜¯åŒæ—¶ä¹Ÿæ›´åŠ æ¶ˆè€—èµ„æº</p><blockquote><p>Term Index =&gt; Term Dictonary =&gt; posting list</p></blockquote><h3 id="å¤©ç„¶ç´¢å¼•ä¹‹Doc-Valueåˆ—å¼å­˜å‚¨"><a href="#å¤©ç„¶ç´¢å¼•ä¹‹Doc-Valueåˆ—å¼å­˜å‚¨" class="headerlink" title="å¤©ç„¶ç´¢å¼•ä¹‹Doc Valueåˆ—å¼å­˜å‚¨"></a>å¤©ç„¶ç´¢å¼•ä¹‹Doc Valueåˆ—å¼å­˜å‚¨</h3><p>â€‹    å€’æ’ç´¢å¼•åœ¨æœç´¢åŒ…å«æŒ‡å®šçš„è¯æ¡å’Œæ–‡æ¡£æ—¶å€™éå¸¸çš„é«˜æ•ˆ, ä½†æ˜¯åœ¨ç›¸åçš„æ“ä½œæ—¶è¡¨ç°å¾ˆå·®, è¿™ä¸ªç›¸åçš„æ“ä½œæŒ‡çš„æ˜¯: æŸ¥è¯¢ä¸€ä¸ªæ–‡æ¡£ä¸­åŒ…å«å“ªäº›è¯æ¡.</p><p>â€‹    å…·ä½“æ¥è¯´, å€’æ’ç´¢å¼•åœ¨æœç´¢çš„æ—¶å€™æœ€ä¸ºé«˜æ•ˆ, ä½†æ˜¯åœ¨æ’åº, èšåˆç­‰ä¸æŒ‡å®šå­—æ®µç›¸å…³çš„æ“ä½œæ—¶æ•ˆç‡æ˜¯ä½ä¸‹çš„, è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨doc_values.</p><p>â€‹    åœ¨ElasticSearchä¸­, Doc Valueså°±æ˜¯ä¸€ç§åˆ—å¼å­˜å‚¨ç»“æ„, é»˜è®¤çš„æƒ…å†µä¸‹æ¯ä¸ªå­—æ®µçš„DocValueséƒ½æ˜¯æ¿€æ´»çš„. </p><p>â€‹    ç´¢å¼•ä¸­æŸä¸ªå­—æ®µçš„å­˜å‚¨ç»“æ„å¦‚ä¸‹:</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211030150221406.png"></p><p>â€‹    åˆ—å¼å­˜å‚¨ç»“æ„éå¸¸é€‚åˆæ’åº, èšåˆä»¥åŠå­—æ®µç›¸å…³çš„è„šæœ¬æ“ä½œ, è€Œä¸”è¿™ç§å­˜å‚¨æ–¹å¼ä¾¿äºå‹ç¼©, å°¤å…¶æ˜¯æ•°å­—ç±»å‹. å‹ç¼©ä¹‹åèƒ½å¤Ÿå¤§å¤§çš„å‡å°ç£ç›˜çš„å­˜å‚¨ç©ºé—´, æå‡è®¿é—®é€Ÿåº¦</p><h2 id="Luceneä¸elasticsearchçš„å…³ç³»"><a href="#Luceneä¸elasticsearchçš„å…³ç³»" class="headerlink" title="Luceneä¸elasticsearchçš„å…³ç³»"></a>Luceneä¸elasticsearchçš„å…³ç³»</h2><p>â€‹    å¾…è¡¥å……</p><h1 id="elasticsearchçš„åŸºæœ¬æ¦‚å¿µ"><a href="#elasticsearchçš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="elasticsearchçš„åŸºæœ¬æ¦‚å¿µ"></a>elasticsearchçš„åŸºæœ¬æ¦‚å¿µ</h1><h2 id="å¯¹è±¡åè¯è§£é‡Š"><a href="#å¯¹è±¡åè¯è§£é‡Š" class="headerlink" title="å¯¹è±¡åè¯è§£é‡Š"></a>å¯¹è±¡åè¯è§£é‡Š</h2><table><thead><tr><th>å¯¹è±¡åè¯</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>cluster</td><td>æ•´ä¸ªelasticsearché»˜è®¤å°±æ˜¯é›†ç¾¤çŠ¶æ€çš„, æ•´ä¸ªé›†ç¾¤æ˜¯ä¸€ä»½å®Œæ•´, äº’ç›¸å¤‡ä»½çš„æ•°æ®</td></tr><tr><td>node</td><td>é›†ç¾¤ä¸­çš„ä¸€ä¸ªé˜¶æ®µ, ä¸€èˆ¬æŒ‡ä¸€ä¸ªè¿›ç¨‹å°±æ˜¯ä¸€ä¸ªnode</td></tr><tr><td>shard</td><td>åˆ†ç‰‡, å³ä½¿ä¸€ä¸ªèŠ‚ç‚¹ä¸­çš„æŠ¤å…·ä¹Ÿä¼šé€šè¿‡hashç®—æ³•, åˆ†æˆå¤šä¸ªåˆ†ç‰‡å­˜æ”¾, 7.xé»˜è®¤æ˜¯1ç‰‡, åç»­çš„ç‰ˆæœ¬é»˜è®¤æ˜¯5ç‰‡</td></tr><tr><td>index</td><td>indexç›¸å½“ä¸table</td></tr><tr><td>type</td><td>ä¸€ç§é€»è¾‘åˆ†åŒº, 7.xç‰ˆæœ¬å·²ç»åºŸé™¤, ç”¨å›ºå®šçš„_docå ä½ä»£æ›¿</td></tr><tr><td>document</td><td>ç±»ä¼¼äºrdbmsçš„row, é¢å‘å¯¹è±¡é‡Œé¢çš„object</td></tr><tr><td>field</td><td>ç›¸å½“äºå­—æ®µ, å±æ€§</td></tr></tbody></table><h2 id="æœåŠ¡çŠ¶æ€æŸ¥è¯¢"><a href="#æœåŠ¡çŠ¶æ€æŸ¥è¯¢" class="headerlink" title="æœåŠ¡çŠ¶æ€æŸ¥è¯¢"></a>æœåŠ¡çŠ¶æ€æŸ¥è¯¢</h2><ul><li><p>GET /_cat/indices?v æŸ¥è¯¢å„ä¸ªç´¢å¼•çš„çŠ¶æ€</p><blockquote><p>indices  indexçš„å¤æ•°</p></blockquote><p><strong>è¡¨å¤´çš„å«ä¹‰</strong></p><ul><li>health ç´¢å¼•çš„å¥åº·çŠ¶æ€</li><li>index ç´¢å¼•å</li><li>pri ç´¢å¼•ä¸»åˆ†ç‰‡æ•°é‡</li><li>req ç´¢å¼•å¤åˆ¶åˆ†ç‰‡æ•°é‡</li><li>store.size ç´¢å¼•ä¸»åˆ†ç‰‡, å¤åˆ¶åˆ†ç‰‡, æ€»å ç”¨å­˜å‚¨ç©ºé—´</li><li>pri.store.size ç´¢å¼•æ€»æš‚ç”¨ç©ºé—´, ä¸è®¡ç®—å¤åˆ¶åˆ†ç‰‡çš„å ç”¨ç©º&gt;</li></ul></li><li><p>GET /_cat/health?v æœåŠ¡æ•´ä½“çŠ¶æ€æŸ¥è¯¢</p><ul><li>cluster é›†ç¾¤åç§°</li><li>status é›†ç¾¤çŠ¶æ€, greenä»£è¡¨æ˜¯å¥åº·( å¥åº·æŒ‡çš„æ˜¯æ‰€æœ‰ä¸»åˆ†ç‰‡éƒ½æ­£å¸¸è€Œä¸”æ¯ä¸ªä¸»åˆ†ç‰‡éƒ½è‡³å°‘æœ‰ä¸€ä¸ªå‰¯æœ¬, é›†ç¾¤çŠ¶æ€ ), yellowä»£è¡¨åˆ†é…äº†æ‰€æœ‰ä¸»åˆ†ç‰‡, ä½†æ˜¯è‡³å°‘ç¼ºå°‘ä¸€ä¸ªå‰¯æœ¬, æ­¤æ—¶é›†ç¾¤çš„æ•°æ®ä»ç„¶æ˜¯å®Œæ•´çš„, ä¸»å‰¯æœ¬éƒ½åœ¨å•ç‚¹, redä»£è¡¨éƒ¨åˆ†ä¸»åˆ†ç‰‡ä¸å¯ç”¨, å¯èƒ½å·²ç»ä¸¢å¤±äº†æ•°æ®</li><li>node.total ä»£è¡¨åœ¨çº¿çš„èŠ‚ç‚¹çš„æ€»æ•°é‡</li><li>node.data ä»£è¡¨åœ¨çº¿çš„æ•°æ®èŠ‚ç‚¹çš„æ•°é‡</li><li>shard active_shards å­˜æ´»çš„åˆ†ç‰‡çš„æ•°é‡</li><li>pri  active_primary_shards å­˜æ´»çš„ä¸»åˆ†ç‰‡çš„æ•°é‡</li><li>relo relocating_shards è¿ç§»ä¸­çš„åˆ†ç‰‡æ•°é‡, æ­£å¸¸æƒ…å†µä¸‹æ•°é‡æ˜¯ä¸º0çš„</li><li>init initializing_shards åˆå§‹åŒ–ä¸­çš„åˆ†ç‰‡æ•°é‡, æ­£å¸¸æƒ…å†µä¸‹æ•°é‡ä¸º0</li><li>unassign unassigned_shards æœªåˆ†é…çš„åˆ†ç‰‡, æ­£å¸¸æƒ…å†µä¸‹ä¸º0</li><li>pending_tasks å‡†å¤‡ä¸­çš„ä»»åŠ¡, ä»»åŠ¡æŒ‡çš„æ˜¯è¿ç§»åˆ†ç‰‡ç­‰ , æ­£å¸¸æƒ…å†µä¸‹ä¸º0</li><li>max_task_wait_time ä»»åŠ¡æœ€é•¿ç­‰å¾…æ—¶é—´</li><li>active_shards_percent æ­£å¸¸åˆ†ç‰‡ç™¾åˆ†æ¯”, æ­£å¸¸æƒ…å†µä¸º0</li></ul></li><li><p>GET /_cat/nodes?v æŸ¥è¯¢å„ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€</p><ul><li>heap.percent å †å†…å­˜å ç”¨ç™¾åˆ†æ¯”</li><li>ram.percent å†…å­˜å ç”¨ç™¾åˆ†æ¯”</li><li>cpu cpuå ç”¨ç™¾åˆ†æ¯”</li><li>master å…¶ä¸­*è¡¨ç¤ºé›†ç¾¤ä¸­çš„ä¸»èŠ‚ç‚¹</li><li>name è¡¨ç¤ºèŠ‚ç‚¹åå­—</li></ul></li><li><p>GET /_cat/shards/xxx æŸ¥è¯¢æŸä¸ªç´¢å¼•çš„åˆ†ç‰‡æƒ…å†µ</p><ul><li>index ç´¢å¼•åç§°</li><li>shard åˆ†ç‰‡åºå·</li><li>pri req pè¡¨ç¤ºçš„æ˜¯è¯¥åˆ†ç‰‡çš„ä¸»åˆ†ç‰‡, rè¡¨ç¤ºçš„æ˜¯è¯¥åˆ†ç‰‡çš„å¤åˆ¶åˆ†ç‰‡</li><li>store è¡¨ç¤ºè¯¥åˆ†ç‰‡å ç”¨çš„å­˜å‚¨ç©ºé—´</li><li>node æ‰€å±èŠ‚ç‚¹å’ŒèŠ‚ç‚¹åç§°</li><li>docs åˆ†ç‰‡å­˜æ”¾çš„æ–‡æ¡£æ•°é‡</li></ul></li></ul><h1 id="elasticsearch-restful-api-DSL"><a href="#elasticsearch-restful-api-DSL" class="headerlink" title="elasticsearch restful api(DSL)"></a>elasticsearch restful api(DSL)</h1><p>DSLå…¨ç§°ä¸º Domain Specific Language, å³ç‰¹å®šé¢†åŸŸä¸“ç”¨è¯­è¨€</p><h2 id="esä¸­ä¿å­˜çš„æ•°æ®"><a href="#esä¸­ä¿å­˜çš„æ•°æ®" class="headerlink" title="esä¸­ä¿å­˜çš„æ•°æ®"></a>esä¸­ä¿å­˜çš„æ•°æ®</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span>  <span class="title">Movie</span> </span>&#123;</span><br><span class="line"> String id;</span><br><span class="line">     String name;</span><br><span class="line">     Double doubanScore;</span><br><span class="line">     List&lt;Actor&gt; actorList;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Actor</span></span>&#123;</span><br><span class="line">String id;</span><br><span class="line">String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    è¿™ä¸¤ä¸ªå¯¹è±¡å¦‚æœæ”¾åœ¨å…³ç³»å‹æ•°æ®åº“ä¿å­˜, ä¼šè¢«æ‹†æˆä¸¤å¼ è¡¨, ä½†æ˜¯elasticsearchä½¿ç”¨ä¸€ä¸ªjsonè¡¨ç¤ºä¸€ä¸ªdocument.</p><p>â€‹    æ‰€ä»¥å®ƒä¿å­˜åˆ°esä¸­åº”è¯¥æ˜¯:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;operation red sea&quot;</span>,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="string">&quot;8.5&quot;</span>,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhangyi&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;haiqing&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhanghanyu&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯¹æ•°æ®çš„æ“ä½œ"><a href="#å¯¹æ•°æ®çš„æ“ä½œ" class="headerlink" title="å¯¹æ•°æ®çš„æ“ä½œ"></a>å¯¹æ•°æ®çš„æ“ä½œ</h2><ul><li><p>å¢åŠ ä¸€ä¸ªç´¢å¼•</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT /movie_index</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤ä¸€ä¸ªç´¢å¼•</p><p>esæ˜¯ä¸åˆ é™¤ä¹Ÿä¸ä¼šä¿®æ”¹ä»»ä½•æ•°æ®çš„, è€Œæ˜¯å¢åŠ äº†ç‰ˆæœ¬å·</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE /movie_index</span><br></pre></td></tr></table></figure></li><li><p>æ–°å¢æ–‡æ¡£</p><p>æ ¼å¼PUT /movie_index/type/id</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">PUT /movie_index/_doc/<span class="number">1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;operation red sea&quot;</span>,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="number">8.5</span>,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhang yi&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">2</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;hai qing&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">3</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhang han yu&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line">PUT /movie_index/_doc/<span class="number">2</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">2</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;operation meigong river&quot;</span>,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="number">8.0</span>,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">3</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhang han yu&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PUT /movie_index/_doc/<span class="number">3</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">3</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;incident red sea&quot;</span>,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="number">5.0</span>,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">4</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhang chen&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä¹‹å‰æ²¡æœ‰åˆ›å»ºè¿‡indexæˆ–åˆ™å’Œtype, esä¼šè¿›è¡Œè‡ªåŠ¨åˆ›å»º</p></blockquote></li><li><p>æ–°å¢æ–‡æ¡£(éå¹‚ç­‰æ“ä½œ)</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /movie_index/_doc</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">3</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;incident red sea&quot;</span>,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="number">5.0</span>,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">4</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhang chen&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p> é‡å¤æ‰§è¡Œä¼šæ–°å¢é‡å¤çš„æ•°æ®, _idä¼šéšæœºç”Ÿæˆ</p></blockquote></li><li><p>ä¿®æ”¹ - æ•´ä½“æ›¿æ¢ (PUT)</p><p>å’Œæ–°å¢æ²¡æœ‰åŒºåˆ«, è¦æ±‚æ˜¯å¿…é¡»åŒ…æ‹¬å…¨éƒ¨çš„å­—æ®µ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PUT /movie_index/_doc/<span class="number">3</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;incident red sea&quot;</span>,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="number">5.0</span>,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhang chen&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹- æŸä¸€ä¸ªå­—æ®µ (POST)</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST movie_index/_update/<span class="number">3</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;doc&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="number">7.0</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤ä¸€ä¸ªdocument</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE movie_index/_doc/<span class="number">3</span></span><br></pre></td></tr></table></figure></li><li><p>ç›´æ¥ç”¨idæŸ¥æ‰¾</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_doc/<span class="number">1</span></span><br></pre></td></tr></table></figure></li><li><p>æœç´¢typeçš„å…¨éƒ¨æ•°æ®, ä¹Ÿå°±æ˜¯æœç´¢docé‡Œé¢çš„å…¨éƒ¨æ•°æ®</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br></pre></td></tr></table></figure></li><li><p>æŒ‰ç…§æ¡ä»¶è¿›è¡ŒæŸ¥è¯¢</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;match_all&quot;</span>: &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>match_all  å…¨éƒ¨åŒ¹é…</p></blockquote></li><li><p>æŒ‰ç…§åˆ†è¯è¿›è¡ŒæŸ¥è¯¢</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;red&quot;</span>&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ ¹æ®åŒ¹é…çš„æˆéƒ½, ä¼šå½±åƒæ•°æ®çš„ç›¸å…³åº¦è¯„åˆ†, è€Œç›¸å…³åº¦è¯„åˆ†ä¼šå½±å“é»˜è®¤æ’å.</p></blockquote><p>è¯„åˆ†å…¬å¼:</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211105142315586.png"></p><p>æ­£é¢å› ç´ : å‘½ä¸­æ¬¡æ•°, å‘½ä¸­é•¿åº¦æ¯”ä¾‹</p><p>è´Ÿé¢å› ç´ : å…³é”®è¯åœ¨è¯¥å­—æ®µçš„å…¶ä»–è¯æ¡ä¸­å‡ºç°çš„æ¬¡æ•°</p></li><li><p>æŒ‰ç…§åˆ†è¯çš„å­å±æ€§è¿›è¡ŒæŸ¥è¯¢</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;<span class="attr">&quot;actorList.name&quot;</span>:<span class="string">&quot;zhang&quot;</span>&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŒ‰ç…§çŸ­è¯­è¿›è¡ŒæŸ¥è¯¢ match_phrase</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;match_phrase&quot;</span>: &#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;operation red&quot;</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æŒ‰ç…§çŸ­è¯­è¿›è¡ŒæŸ¥è¯¢, ä¸å†åˆ©ç”¨åˆ†è¯æŠ€æœ¯, ç›´æ¥ç”¨çŸ­è¯­åœ¨åŸå§‹æ•°æ®ä¸­è¿›è¡ŒåŒ¹é…</p></blockquote></li><li><p>è¿‡æ»¤- ç¬¦åˆæŸ¥è¯¢</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123; </span><br><span class="line">    <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;bool&quot;</span>:&#123;</span><br><span class="line">          <span class="attr">&quot;filter&quot;</span>:[ &#123;<span class="attr">&quot;term&quot;</span>: &#123;  <span class="attr">&quot;actorList.id&quot;</span>: <span class="string">&quot;3&quot;</span>  &#125;&#125; </span><br><span class="line">           ], </span><br><span class="line">           <span class="attr">&quot;must&quot;</span>:&#123;<span class="attr">&quot;match&quot;</span>:&#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;red&quot;</span>&#125;&#125;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>mustå’Œshouldçš„åŒºåˆ«: mustæ˜¯å¿…é¡»æœ‰, shouldæ˜¯åœ¨å…¶ä»–æ¡ä»¶å‘½ä¸­çš„æƒ…å†µä¸‹, shouleå‘½ä¸­ç»™åˆ†å¹¶æ˜¾ç¤º, å¦‚æœshouldæœªå‘½ä¸­åˆ™åªæ˜¾ç¤ºä¸ç»™åˆ†</p></blockquote></li><li><p>è¿‡æ»¤ - æŒ‰ç…§èŒƒå›´è¿›è¡Œè¿‡æ»¤</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">     <span class="attr">&quot;bool&quot;</span>: &#123;</span><br><span class="line">       <span class="attr">&quot;filter&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;range&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;doubanScore&quot;</span>: &#123;<span class="attr">&quot;gte&quot;</span>: <span class="number">8</span>&#125;</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äºæ“ä½œç¬¦çš„èŒƒå›´</p><table><thead><tr><th>æ“ä½œç¬¦</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>gt</td><td>å¤§äº</td></tr><tr><td>lt</td><td>å°äº</td></tr><tr><td>gte</td><td>å¤§äºç­‰äº great than or equals</td></tr><tr><td>lte</td><td>å°äºç­‰äº less than or equals</td></tr></tbody></table></li><li><p>æ ¹æ®æŸ¥è¯¢æ¡ä»¶è¿›è¡Œåˆ é™¤å’Œä¿®æ”¹</p><p><strong>_delete_by_query</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST movie_index/_doc/_delete_by_query </span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;term&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;actorList.name.keyword&quot;</span>: <span class="string">&quot;zhang chen&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>_update_by_query</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST movie_index/_doc/_update_by_query</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;script&quot;</span>:<span class="string">&quot;ctx._source[&#x27;actorList &#x27;][0][ &#x27;name&#x27;]=&#x27;zhang san feng&#x27;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;term&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;actorList.name.keyword&quot;</span>: <span class="string">&quot;zhang chen&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ’åº sort</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;red sea&quot;</span>&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  , <span class="attr">&quot;sort&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;doubanScore&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;order&quot;</span>: <span class="string">&quot;desc&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åˆ†é¡µæŸ¥è¯¢</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123; <span class="attr">&quot;match_all&quot;</span>: &#123;&#125; &#125;,</span><br><span class="line">  <span class="attr">&quot;from&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;size&quot;</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>é«˜äº®æ˜¾ç¤º</p><p>ç”¨äºç½‘é¡µä¸­é€šç”¨çš„ç‰¹æ®Šæ ‡ç­¾æ¥é«˜äº®æ˜¾ç¤ºç»“æœä¸­çš„å…³é”®å­—</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;match&quot;</span>: &#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;red sea&quot;</span>&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;highlight&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;fields&quot;</span>: &#123;<span class="attr">&quot;name&quot;</span>:&#123;&#125; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é«˜äº®æ ‡ç­¾</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;match&quot;</span>: &#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;red sea&quot;</span>&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;highlight&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;fields&quot;</span>: &#123;<span class="attr">&quot;name&quot;</span>:&#123;<span class="attr">&quot;pre_tags&quot;</span>: <span class="string">&quot;&lt;span color=&#x27;red&#x27;&gt;&quot;</span>,<span class="attr">&quot;post_tags&quot;</span>:<span class="string">&quot;&lt;/span&gt;&quot;</span>&#125;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>èšåˆ aggs</p><p>å–å‡ºæ¯ä¸ªæ¼”å‘˜å…±å‚æ¼”äº†å¤šå°‘éƒ¨ç”µå½±</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123; </span><br><span class="line">  <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;groupby_actor&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;actorList.name.keyword&quot;</span>  </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯ä¸ªæ¼”å‘˜å‚æ¼”ç”µå½±çš„å¹³å‡åˆ†æ˜¯å¤šå°‘åˆ†, å¹¶æŒ‰ç…§è¯„åˆ†è¿›è¡Œæ’åº</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_search</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;groupby_actor_id&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;field&quot;</span>: <span class="string">&quot;actorList.name.keyword&quot;</span>,</span><br><span class="line"><span class="attr">&quot;order&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;avg_score&quot;</span>: <span class="string">&quot;desc&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;avg_score&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;avg&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;field&quot;</span>: <span class="string">&quot;doubanScore&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>èšåˆçš„æ—¶å€™ä¸ºä½•è¦åŠ ä¸Š.keywordåç¼€å‘¢?</p><p>â€‹    .keywordæ˜¯æŸä¸ªå­—ç¬¦ä¸²å­—æ®µ, ä¸“é—¨å­˜å‚¨ä¸åˆ†è¯æ ¼å¼çš„å‰¯æœ¬, åœ¨æŸäº›åœºæ™¯ä¸­åªå…è®¸ç”¨ä¸åˆ†è¯çš„æ ¼å¼, æ¯”å¦‚è¿‡æ»¤filter, æ¯”å¦‚èšåˆaggs, æ‰€ä»¥å­—æ®µè¦åŠ ä¸Š.keywordçš„åç¼€</p></li></ul><h2 id="SQLçš„ä½¿ç”¨"><a href="#SQLçš„ä½¿ç”¨" class="headerlink" title="SQLçš„ä½¿ç”¨"></a>SQLçš„ä½¿ç”¨</h2><p>elasticsearch sqlæ˜¯6.3ç‰ˆæœ¬ä»¥åçš„åŠŸèƒ½, å¯ä»¥æ”¯æŒä¸€äº›æœ€åŸºæœ¬çš„sqlæŸ¥è¯¢è¯­å¥.</p><p>å½“å‰æƒ…å†µ: </p><ul><li><p>åªæ”¯æŒselectæ“ä½œ, insert , update, deleteä¸€å¾‹ä¸æ”¯æŒ</p></li><li><p>6.3ä»¥å‰çš„ç‰ˆæœ¬ä¸æ”¯æŒ</p></li><li><p>sqlæ¯”dslæ›´ä¸°å¯Œçš„å‡½æ•°. å‚è€ƒ: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/sql-functions.html">elasticæ–‡æ¡£</a></p></li><li><p>ä¸æ”¯æŒçª—å£å‡½æ•°</p></li><li><p>sqlå°‘ä¸€äº›ç‰¹çš„åŠŸèƒ½, æ¯”å¦‚é«˜äº®, åˆ†é¡µ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET  /_sql?format=txt</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>:<span class="string">&quot;select actorList.name.keyword, avg(doubanScore) from movie_index  where match(name,&#x27;red&#x27;) group by actorList.name.keyword limit 1 &quot;</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="ä¸­æ–‡åˆ†è¯"><a href="#ä¸­æ–‡åˆ†è¯" class="headerlink" title="ä¸­æ–‡åˆ†è¯"></a>ä¸­æ–‡åˆ†è¯</h2><p>elasticsearchæœ¬èº«è‡ªå¸¦çš„ä¸­æ–‡åˆ†è¯, å°±æ˜¯å•çº¯çš„æŠŠä¸­æ–‡ä¸€ä¸ªå­—ä¸€ä¸ªå­—çš„åˆ†å¼€, æ ¹æœ¬æ²¡æœ‰è¯æ±‡çš„ç›–é¢, ä½†æ˜¯åœ¨å®é™…çš„åº”ç”¨ä¸­, ç”¨æˆ·éƒ½æ˜¯ä»¥è¯æ±‡ä¸ºæ¡ä»¶, è¿›è¡ŒæŸ¥è¯¢å’ŒåŒ¹é…çš„, å¦‚æœèƒ½å¤ŸæŠŠæ–‡ç« ä»¥è¯æ±‡ä¸ºå•ä½åˆ†æ¥çš„è¯, é‚£ä¹ˆä¸ç”¨æˆ·çš„æŸ¥è¯¢æ¡ä»¶èƒ½å¤Ÿæ›´åŠ è´´åˆ‡çš„åŒ¹é…ä¸Š, æŸ¥è¯¢çš„é€Ÿåº¦ä¹Ÿæ›´åŠ çš„å¿«é€Ÿ</p><p><a href="https://github.com/medcl/elasticsearch-analysis-ik">åˆ†è¯å™¨ä¸‹è½½åœ°å€</a></p><p>ä¸åŒçš„åˆ†è¯å™¨, åˆ†è¯æœ‰ç€æ˜æ˜¾çš„åŒºåˆ«, æ‰€ä»¥ä»¥åå®šä¹‰ä¸€ä¸ªtypeä¸èƒ½å†ä½¿ç”¨é»˜è®¤çš„mappingäº†, è¦æ‰‹å·¥åˆ›å»ºmapping, å› ä¸ºéœ€è¦é€‰æ‹©åˆ†è¯å™¨</p><h2 id="å…³äºmapping"><a href="#å…³äºmapping" class="headerlink" title="å…³äºmapping"></a>å…³äºmapping</h2><p>ä¹‹å‰è¯´typeå¯ä»¥ç†è§£ä¸ºtable, é‚£ä¹ˆæ¯ä¸ªå­—æ®µçš„æ•°æ®ç±»å‹æ˜¯å¦‚ä½•å®šä¹‰çš„å‘¢</p><ul><li><p>æŸ¥çœ‹mapping</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET movie_index/_mapping/xxx</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šæ¯ä¸ªtypeä¸­çš„å­—æ®µæ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹, æ˜¯ç”±mappingå®šä¹‰çš„. </p><p>ä½†æ˜¯å¦‚æœæ²¡æœ‰è®¾å®šmapping, ç³»ç»Ÿä¼šè‡ªåŠ¨çš„æ ¹æ®ä¸€æ¡æ•°æ®çš„æ ¼å¼æ¥æ¨æ–­å‡ºåº”è¯¥çš„æ•°æ®æ ¼å¼</p><ul><li>true/false  boolean</li><li>1020  long</li><li>20.1 float</li><li>â€œ2018-02-21â€  date</li><li>â€œhello worldâ€  text + keyword</li></ul><p>é»˜è®¤çš„æƒ…å†µä¸‹åªæœ‰textä¼šè¿›è¡Œåˆ†è¯, keyworldæ˜¯ä¸ä¼šåˆ†è¯çš„å­—ç¬¦ä¸²</p><p>mappingé™¤äº†è‡ªåŠ¨å®šä¹‰, è¿˜å¯ä»¥æ‰‹åŠ¨å®šä¹‰, ä½†æ˜¯åªèƒ½å¯¹æ–°å®¶çš„, æ²¡æœ‰æ•°æ®çš„å­—æ®µè¿›è¡Œå®šä¹‰. ä¸€æ—¦æœ‰äº†æ•°æ®å°±æ— æ³•å†æ¬¡è¿›è¡Œä¿®æ”¹</p><blockquote><p>æ³¨æ„: è™½ç„¶æ¯ä¸ªfieldçš„æ•°æ®æ”¾åœ¨ä¸åŒçš„typeä¸‹, ä½†æ˜¯åŒä¸€ä¸ªåå­—çš„fieldåœ¨ä¸€ä¸ªindexä¸‹åªèƒ½æœ‰ä¸€ç§mappingå®šä¹‰</p></blockquote></li><li><p>åŸºäºä¸­æ–‡åˆ†è¯æ­å»ºç´¢å¼•</p><ol><li><p>å»ºç«‹mapping</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">PUT movie_chn</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;settings&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;number_of_shards&quot;</span>: <span class="number">1</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;type&quot;</span>: <span class="string">&quot;long&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line"><span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;ik_smart&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;type&quot;</span>: <span class="string">&quot;double&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;type&quot;</span>: <span class="string">&quot;long&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ’å…¥æ•°æ®</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">PUT /movie_chn/_doc/<span class="number">1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;çº¢æµ·è¡ŒåŠ¨&quot;</span>,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="number">8.5</span>,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;å¼ è¯‘&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">2</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;æµ·æ¸…&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">3</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;å¼ æ¶µäºˆ&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line">PUT /movie_chn/_doc/<span class="number">2</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">2</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;æ¹„å…¬æ²³è¡ŒåŠ¨&quot;</span>,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="number">8.0</span>,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">3</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;å¼ æ¶µäºˆ&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line">PUT /movie_chn/_doc/<span class="number">3</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">3</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;çº¢æµ·äº‹ä»¶&quot;</span>,</span><br><span class="line"><span class="attr">&quot;doubanScore&quot;</span>: <span class="number">5.0</span>,</span><br><span class="line"><span class="attr">&quot;actorList&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;id&quot;</span>: <span class="number">4</span>,</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;å¼ æ™¨&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢æ•°æ®</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">GET /movie_chn/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;çº¢æµ·æˆ˜å½¹&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET /movie_chn/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;term&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;actorList.name&quot;</span>: <span class="string">&quot;å¼ è¯‘&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol></li></ul><h2 id="åˆ†å‰²ç´¢å¼•"><a href="#åˆ†å‰²ç´¢å¼•" class="headerlink" title="åˆ†å‰²ç´¢å¼•"></a>åˆ†å‰²ç´¢å¼•</h2><p>åˆ†å‰²ç´¢å¼•å°±æ˜¯æ ¹æ®æ—¶é—´é—´éš”å°†ä¸€ä¸ªä¸šåŠ¡æ•°æ®çš„ç´¢å¼•åˆ‡åˆ†æˆä¸ºå¤šä¸ªç´¢å¼•</p><p>æ¯”å¦‚å°†order_info å˜æˆorder_info_20200101, order_info_20200102</p><p><strong>è¿™æ ·åšæ˜¯æœ‰ä¸¤ä¸ªå¥½å¤„çš„</strong></p><ol><li>æŸ¥è¯¢èŒƒå›´ä¼˜åŒ–: å› ä¸ºä¸€èˆ¬æƒ…å†µä¸‹å¹¶ä¸ä¼šæŸ¥è¯¢å…¨éƒ¨æ—¶é—´å‘¨æœŸæ•°æ®, é‚£ä¹ˆé€šè¿‡åˆ‡åˆ†ç´¢å¼•, ç‰©ç†ä¸Šå‡å°‘äº†æ‰«ææ•°æ®çš„èŒƒå›´, ä¹Ÿæ˜¯å¯¹æ€§èƒ½çš„ä¼˜åŒ–</li><li>ç»“æ„å˜åŒ–çš„çµæ´»æ€§: å› ä¸ºelasticsearchä¸å…è®¸å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹, ä½†æ˜¯å®é™…ä½¿ç”¨ä¸­ç´¢å¼•çš„ç»“æ„å’Œé…ç½®é‚£ä¹ˆåªè¦å¯¹ä¸‹ä¸€ä¸ªæ—¶é—´é—´éš”çš„ç´¢å¼•è¿›è¡Œä¿®æ”¹, åŸæ¥çš„ç´¢å¼•ä½ç½®ä¿å­˜åŸçŠ¶, è¿™æ ·å°±ä¿è¯äº†ä¸€å®šçš„çµæ´»æ€§</li></ol><h2 id="ç´¢å¼•åˆ«å-aliases"><a href="#ç´¢å¼•åˆ«å-aliases" class="headerlink" title="ç´¢å¼•åˆ«å _aliases"></a>ç´¢å¼•åˆ«å _aliases</h2><p>ç´¢å¼•åˆ«åå°±åƒä¸€ä¸ªå¿«æ·æ–¹å¼æˆ–è€…è½¯è¿æ¥, å¯ä»¥æŒ‡å‘ä¸€ä¸ªæˆ–è€…å¤šä¸ªç´¢å¼•, ä¹Ÿå¯ä»¥ç»™ä»»ä½•ä¸€ä¸ªéœ€è¦ç´¢å¼•åç§°çš„apiæ¥ä½¿ç”¨, åˆ«åå¸¦ç»™æˆ‘ä»¬æå¤§çš„çµæ´»æ€§, å…è®¸æˆ‘ä»¬åšä¸‹é¢çš„æ“ä½œ</p><ol><li>ç»™å¤šä¸ªç´¢å¼•åˆ†ç»„(ä¾‹å¦‚, last_three_months)</li><li>ç»™ç´¢å¼•çš„ä¸€ä¸ªå­é›†åˆ›å»ºè§†å›¾</li><li>åœ¨è¿è¡Œçš„é›†ç¾¤ä¸­å¯ä»¥æ— ç¼çš„ä»ä¸€ä¸ªç´¢å¼•åˆ‡æ¢åˆ°å¦ä¸€ä¸ªç´¢å¼•</li></ol><ul><li><p>åˆ›å»ºç´¢å¼•åˆ«å</p><p>åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ç›´æ¥å£°æ˜</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">PUT movie_chn_2020</span><br><span class="line">&#123;  <span class="attr">&quot;aliases&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;movie_chn_2020-query&quot;</span>: &#123;&#125;</span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;movie&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>:&#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;long&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>:&#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">          , <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;ik_smart&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;doubanScore&quot;</span>:&#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;double&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;actorList&quot;</span>:&#123;</span><br><span class="line">          <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;id&quot;</span>:&#123;</span><br><span class="line">              <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;long&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>:&#123;</span><br><span class="line">              <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;keyword&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºå·²ç»å­˜åœ¨çš„ç´¢å¼•å¢åŠ åˆ«å</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST  _aliases</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;actions&quot;</span>: [</span><br><span class="line">        &#123; <span class="attr">&quot;add&quot;</span>:    &#123; <span class="attr">&quot;index&quot;</span>: <span class="string">&quot;movie_chn_xxxx&quot;</span>, <span class="attr">&quot;alias&quot;</span>: <span class="string">&quot;movie_chn_2020-query&quot;</span> &#125;&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥é€šè¿‡å¢åŠ è¿‡æ»¤æ¡ä»¶ç¼©å°æŸ¥è¯¢èŒƒå›´, å»ºç«‹ä¸€ä¸ªå­é›†çš„è§†å›¾</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST  _aliases</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;actions&quot;</span>: [</span><br><span class="line">        &#123; <span class="attr">&quot;add&quot;</span>:    </span><br><span class="line">&#123; <span class="attr">&quot;index&quot;</span>: <span class="string">&quot;movie_chn_xxxx&quot;</span>, </span><br><span class="line"><span class="attr">&quot;alias&quot;</span>: <span class="string">&quot;movie_chn0919-query-zhhy&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;filter&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;term&quot;</span>: &#123;  <span class="attr">&quot;actorList.id&quot;</span>: <span class="string">&quot;3&quot;</span></span><br><span class="line">                 &#125;</span><br><span class="line">               &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢åˆ«å</p><p>å’Œæ™®é€šçš„ç´¢å¼•æ²¡ä»€ä¹ˆåŒºåˆ«</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET movie_chn_2020-query/_search</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤æŸä¸ªç´¢å¼•çš„åˆ«å</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST  _aliases</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;actions&quot;</span>: [</span><br><span class="line">        &#123; <span class="attr">&quot;remove&quot;</span>:    &#123; <span class="attr">&quot;index&quot;</span>: <span class="string">&quot;movie_chn_xxxx&quot;</span>, <span class="attr">&quot;alias&quot;</span>: <span class="string">&quot;movie_chn_2020-query&quot;</span> &#125;&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä¸ºæŸä¸ªåˆ«åè¿›è¡Œæ— ç¼çš„åˆ‡æ¢</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /_aliases</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;actions&quot;</span>: [</span><br><span class="line">        &#123; <span class="attr">&quot;remove&quot;</span>: &#123; <span class="attr">&quot;index&quot;</span>: <span class="string">&quot;movie_chn_xxxx&quot;</span>, <span class="attr">&quot;alias&quot;</span>: <span class="string">&quot;movie_chn_2020-query&quot;</span> &#125;&#125;,</span><br><span class="line">        &#123; <span class="attr">&quot;add&quot;</span>:    &#123; <span class="attr">&quot;index&quot;</span>: <span class="string">&quot;movie_chn_yyyy&quot;</span>, <span class="attr">&quot;alias&quot;</span>: <span class="string">&quot;movie_chn_2020-query&quot;</span> &#125;&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢åˆ«åçš„åˆ—è¡¨</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET  _cat/aliases?v</span><br></pre></td></tr></table></figure></li></ul><h2 id="ç´¢å¼•æ¨¡æ¿"><a href="#ç´¢å¼•æ¨¡æ¿" class="headerlink" title="ç´¢å¼•æ¨¡æ¿"></a>ç´¢å¼•æ¨¡æ¿</h2><p>index Template ç´¢å¼•æ¨¡æ¿, é¡¾åæ€ä¹‰, å°±æ˜¯åˆ›å»ºç´¢å¼•çš„ç£¨å…·, å…¶ä¸­å¯ä»¥å®šä¹‰ä¸€ç³»åˆ—çš„è§„åˆ™æ¥å¸®åŠ©æˆ‘ä»¬æ„å»ºç¬¦åˆç‰¹å®šä¸šåŠ¡çš„éœ€æ±‚çš„ç´¢å¼• mappingså’Œsettings, é€šè¿‡ä½¿ç”¨index Templateå¯ä»¥è®©æˆ‘ä»¬çš„ç´¢å¼•å…·å¤‡å¯é¢„çŸ¥çš„ä¸€è‡´æ€§</p><ul><li><p>åˆ›å»ºæ¨¡æ¿</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">PUT _template/template_movie2020</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;index_patterns&quot;</span>: [<span class="string">&quot;movie_test*&quot;</span>],                  </span><br><span class="line">  <span class="attr">&quot;settings&quot;</span>: &#123;                                               </span><br><span class="line">    <span class="attr">&quot;number_of_shards&quot;</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;aliases&quot;</span> : &#123; </span><br><span class="line">    <span class="attr">&quot;&#123;index&#125;-query&quot;</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">&quot;movie_test-query&quot;</span>:&#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;                                          </span><br><span class="line"><span class="attr">&quot;_doc&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;movie_name&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;ik_smart&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­â€index_patternâ€:[â€œmovie_test*â€]çš„å«ä¹‰å°±æ˜¯å‡¡æ˜¯å¾€movie_testå¼€å¤´çš„ç´¢å¼•å†™å…¥æ•°æ®çš„æ—¶å€™, å¦‚æœç´¢å¼•ä¸å­˜åœ¨, é‚£ä¹ˆesä¼šæ ¹æ®æ­¤æ¨¡æ¿è‡ªåŠ¨åˆ›å»ºç´¢å¼•</p><p>åœ¨â€aliasesâ€ä¸­ç”¨{index}è¡¨ç¤º, è·å¾—çœŸæ­£çš„åˆ›å»ºçš„æ‰€ä»¥åç§°</p><p><strong>æµ‹è¯•</strong>ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST movie_test_2020xxxx/_doc</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;id&quot;</span>:<span class="string">&quot;333&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;zhang3&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹ç³»ç»Ÿä¸­å·²æœ‰çš„æ¨¡æ¿æ¸…å•</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET  _cat/templates</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹æŸä¸ªæ¨¡æ¿æ¸…å•</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET  _template/template_movie2020</span><br><span class="line">æˆ–è€…</span><br><span class="line">GET  _template/template_movie*</span><br></pre></td></tr></table></figure></li></ul><h1 id="åˆ†å¸ƒå¼è¯»å†™åŸç†"><a href="#åˆ†å¸ƒå¼è¯»å†™åŸç†" class="headerlink" title="åˆ†å¸ƒå¼è¯»å†™åŸç†"></a>åˆ†å¸ƒå¼è¯»å†™åŸç†</h1><h2 id="å†™æµç¨‹"><a href="#å†™æµç¨‹" class="headerlink" title="å†™æµç¨‹"></a>å†™æµç¨‹</h2><p>æ–°å»ºç´¢å¼•å’Œåˆ é™¤è¯·æ±‚éƒ½æ˜¯å†™æ“ä½œ, å¿…é¡»åœ¨ä¸»åˆ†ç‰‡ä¸Šé¢å®Œæˆä¹‹åæ‰èƒ½è¢«å¤åˆ¶åˆ°ç›¸å…³çš„å‰¯æœ¬åˆ‡ç‰‡</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211110085454992.png"></p><p>æ–°å»º, ç´¢å¼•å’Œåˆ é™¤æ–‡æ¡£æ‰€éœ€è¦çš„æ­¥éª¤</p><ol><li>å®¢æˆ·ç«¯å‘node1å‘é€æ–°å»º, ç´¢å¼•æˆ–è€…åˆ é™¤çš„è¯·æ±‚</li><li>èŠ‚ç‚¹ä½¿ç”¨æ–‡æ¡£çš„_idç¡®å®šæ–‡æ¡£å±äºåˆ†ç‰‡0, è¯·æ±‚ä¼šè¢«è½¬å‘åˆ°node3ä¸Š, å› ä¸ºåˆ†ç‰‡0çš„ä¸»åˆ†ç‰‡ç›®å‰è¢«åˆ†é…åœ¨node3ä¸Š</li><li>node3åœ¨ä¸»åˆ†ç‰‡ä¸Šé¢æ‰§è¡Œè¯·æ±‚, å¦‚æœæˆåŠŸä¹‹å, ä»–å°†è¯·æ±‚å¹¶è¡Œè½¬å‘åˆ°node1å’Œnode2ä¸Šçš„å‰¯æœ¬åˆ†ç‰‡ä¸Š, ä¸€æ—¦æ‰€æœ‰çš„å‰¯æœ¬åˆ†ç‰‡éƒ½æŠ¥å‘ŠæˆåŠŸä¹‹å, node3å°†å‘åè°ƒèŠ‚ç‚¹æŠ¥å‘ŠæˆåŠŸ, åè°ƒèŠ‚ç‚¹å‘å®¢æˆ·ç«¯æŠ¥å‘ŠæˆåŠŸ</li></ol><blockquote><p>åè°ƒèŠ‚ç‚¹: æ¥å—å®¢æˆ·ç«¯è¯·æ±‚çš„èŠ‚ç‚¹</p></blockquote><p>å¦‚ä½•æ ¹æ®_idè®¡ç®—åº”è¯¥è½¬å‘åˆ°å“ªä¸ªåˆ†ç‰‡?</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shard =  hash(routing)  % number_of_primary_shards</span><br></pre></td></tr></table></figure><p>routing æ˜¯ä¸€ä¸ªå¯å˜å€¼ï¼Œé»˜è®¤æ˜¯æ–‡æ¡£çš„ _id ï¼Œä¹Ÿå¯ä»¥è®¾ç½®æˆä¸€ä¸ªè‡ªå®šä¹‰çš„å€¼ã€‚ routing é€šè¿‡ hash å‡½æ•°ç”Ÿæˆä¸€ä¸ªæ•°å­—ï¼Œç„¶åè¿™ä¸ªæ•°å­—å†é™¤ä»¥ number_of_primary_shards ï¼ˆä¸»åˆ†ç‰‡çš„æ•°é‡ï¼‰åå¾—åˆ°ä½™æ•° ã€‚è¿™ä¸ªåˆ†å¸ƒåœ¨ 0 åˆ° number_of_primary_shards-1 ä¹‹é—´çš„ä½™æ•°ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€å¯»æ±‚çš„æ–‡æ¡£æ‰€åœ¨åˆ†ç‰‡çš„ä½ç½®ã€‚</p><p>é‚£ä¹ˆå¦‚æœshardçš„æ•°é‡å˜åŒ–, æ˜¯ä¸æ˜¯æ•°æ®å°±è¦é‡æ–°rehashå‘¢, ä¸ä¼š, å› ä¸ºä¸€ä¸ªindex çš„shardsæ•°é‡æ˜¯ä¸èƒ½æ”¹å˜çš„.</p><h2 id="è¯»æµç¨‹-æœ‰è¯­ä¹‰ç–‘é—®"><a href="#è¯»æµç¨‹-æœ‰è¯­ä¹‰ç–‘é—®" class="headerlink" title="è¯»æµç¨‹(æœ‰è¯­ä¹‰ç–‘é—®)"></a>è¯»æµç¨‹(æœ‰è¯­ä¹‰ç–‘é—®)</h2><p>æˆ‘ä»¬å¯ä»¥å†²ä¸»åˆ†ç‰‡æˆ–åˆ™å’Œå…¶ä»–å‰¯æœ¬ä»»æ„çš„å‰¯æœ¬åˆ†ç‰‡æ£€ç´¢æ–‡æ¡£</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211110090517450.png"></p><p>ä»ä¸»åˆ†ç‰‡æˆ–è€…å‰¯æœ¬åˆ†ç‰‡æ£€ç´¢æ–‡æ¡£çš„æ­¥éª¤é¡ºåº:</p><ol><li>å®¢æˆ·ç«¯å‘node1å‘é€è·å–è¯·æ±‚</li><li>èŠ‚ç‚¹ä½¿ç”¨æ–‡æ¡£çš„_idæ¥å­¦é¡¶æ–‡æ¡£æ•°æ®åˆ†ç‰‡0, åˆ†ç‰‡0çš„å‰¯æœ¬åˆ†ç‰‡å­˜å‚¨åœ¨æ‰€æœ‰çš„ä¸‰ä¸ªèŠ‚ç‚¹ä¸Š, åœ¨è¿™ç§æƒ…å†µä¸‹, å®ƒå°†è¯·æ±‚è½¬å‘åˆ°node2ä¸Š</li><li>node2å°†æ–‡æ¡£è¿”å›ç»™node1, ç„¶åå°†æ–‡æ¡£è¿”å›ç»™å®¢æˆ·ç«¯</li></ol><blockquote><p>åœ¨å¤„ç†è¯»å–è¯·æ±‚æ—¶, åè°ƒèŠ‚ç‚¹åœ¨æ¯æ¬¡è¯·æ±‚çš„æ—¶å€™éƒ½ä¼šé€šè¿‡è½®è¯¢æ‰€æœ‰å‰¯æœ¬åˆ†ç‰‡æ¥è¾¾åˆ°è´Ÿè½½å‡è¡¡, åœ¨æ–‡æ¡£è¢«æ£€ç´¢çš„æ—¶å€™, å·²ç»è¢«ç´¢å¼•çš„æ–‡æ¡£å¯èƒ½å·²ç»å­˜åœ¨äºä¸»åˆ†ç‰‡ä¸Š, ä½†æ˜¯è¿˜æ²¡æœ‰å¤åˆ¶åˆ°å‰¯æœ¬åˆ†ç‰‡ä¸Š. åœ¨è¿™ç§æƒ…å†µä¸‹, å‰¯æœ¬åˆ†ç‰‡å¯èƒ½ä¼šæŠ¥å‘Šæ–‡æ¡£ä¸å­˜åœ¨, ä½†æ˜¯ä¸»åˆ†ç‰‡å¯èƒ½ä¼šæˆåŠŸè¿”å›æ–‡æ¡£. ä¸€æ—¦ç´¢å¼•è¯·æ±‚æˆåŠŸè¿”å›ç»™å®¢æˆ·ç«¯, æ–‡æ¡£åœ¨ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡éƒ½æ˜¯å¯ç”¨çš„</p></blockquote><h2 id="æœç´¢æµç¨‹"><a href="#æœç´¢æµç¨‹" class="headerlink" title="æœç´¢æµç¨‹"></a>æœç´¢æµç¨‹</h2><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211110091212193.png"></p><ul><li><p>æœç´¢è¢«æ‰§è¡Œæˆä¸ºä¸€ä¸ªäºŒé˜¶æ®µ, æˆ‘ä»¬æˆä¸º Query Then Fetch</p></li><li><p>åœ¨åˆå§‹æŸ¥è¯¢é˜¶æ®µ, æŸ¥è¯¢ä¼šå¹¿æ’­å¯¼ç´¢å¼•ä¸­æ¯ä¸€ä¸ªåˆ†ç‰‡æ‹·è´(ä¸»åˆ†ç‰‡æˆ–è€…å‰¯æœ¬åˆ†ç‰‡), æ¯ä¸ªåˆ†ç‰‡åœ¨æœ¬åœ°æ‰§è¡Œæœç´¢å¹¶æ„å»ºä¸€ä¸ªåŒ¹é…æ–‡æ¡£çš„å¤§å°ä¸º from + sizeçš„ä¼˜å…ˆé˜Ÿåˆ—</p><blockquote><p>ps: åœ¨æœç´¢çš„æ—¶å€™æ˜¯ä¼šæŸ¥è¯¢FileSystem Cacheçš„, ä½†æ˜¯æœ‰éƒ¨åˆ†æ•°æ®è¿˜åœ¨Memory Buffer, æ‰€ä»¥æœç´¢æ˜¯è¿‘å®æ—¶çš„</p></blockquote></li><li><p>æ¯ä¸ªåˆ†ç‰‡è¿”å›å„è‡ªæœ‰é™é˜Ÿåˆ—ä¸­æ‰€æœ‰æ–‡æ¡£çš„idå’Œæ’åºå€¼ç»™åè°ƒèŠ‚ç‚¹, å®ƒåˆå¹¶è¿™äº›å€¼åˆ°è‡ªå·±çš„ä¼˜å…ˆé˜Ÿåˆ—ä¸­æ¥äº§ç”Ÿä¸€ä¸ªå…¨å±€æ’åºåçš„ç»“æœåˆ—è¡¨</p></li><li><p>æ¥ä¸‹æ¥å°±æ˜¯å–å›é˜¶æ®µ, åè°ƒèŠ‚ç‚¹åˆ¤åˆ«å‡ºé‚£äº›æ–‡æ¡£éœ€è¦è¢«å–å›å¹¶å‘ç›¸å…³çš„åˆ†ç‰‡æäº¤å¤šä¸ªgetè¯·æ±‚, æ¯ä¸ªåˆ†ç‰‡åŠ è½½å¹¶ä¸°å¯Œæ–‡æ¡£, å¦‚æœæœ‰éœ€è¦çš„è¯, æ¥ç€è¿”å›æ–‡æ¡£ç»™åè°ƒèŠ‚ç‚¹, ä¸€æ—¦æ‰€æœ‰çš„æ–‡æ¡£éƒ½è¢«å–å›äº†, åè°ƒèŠ‚ç‚¹è¿”å›ç»“æœç»™å®¢æˆ·ç«¯</p></li><li><p>Query Then Fetchçš„æœç´¢ç±»å‹åœ¨æ–‡æ¡£ç›¸å…³æ€§æ‰“åˆ†çš„æ—¶å€™å‚è€ƒçš„æ˜¯æœ¬åˆ†ç‰‡çš„æ•°æ®, è¿™æ ·åœ¨æ–‡æ¡£çš„æ•°é‡æ¯”è¾ƒå°‘çš„æ—¶å€™å¯èƒ½ä¸ä¼šå‡†ç¡®, DFS Query Then Fetchå¢åŠ äº†ä¸€ä¸ªé¢„æŸ¥è¯¢çš„å¤„ç†, è¯¢é—®Termå’ŒDocument frequency, è¿™ä¸ªè¯„åˆ†ä¼šæ›´åŠ çš„å‡†ç¡®, ä½†æ˜¯æ€§èƒ½å¯èƒ½ä¼šå˜å·®</p></li></ul><h2 id="æ–‡æ¡£çš„ä¿®æ”¹å’Œå¹¶å‘æ§åˆ¶"><a href="#æ–‡æ¡£çš„ä¿®æ”¹å’Œå¹¶å‘æ§åˆ¶" class="headerlink" title="æ–‡æ¡£çš„ä¿®æ”¹å’Œå¹¶å‘æ§åˆ¶"></a>æ–‡æ¡£çš„ä¿®æ”¹å’Œå¹¶å‘æ§åˆ¶</h2><p>elasticsearchä¸­çš„å…¨éƒ¨æ–‡æ¡£æ•°æ®éƒ½æ˜¯ä¸å¯å˜çš„, æ•°æ®ä¸å¯ä»¥è¢«ä¿®æ”¹, åªèƒ½é€šè¿‡ç‰ˆæœ¬å·çš„æ”¾æ˜¯ä¸æ–­å¢åŠ , è¿™æ ·åšçš„ä¸»è¦ç›®çš„æ˜¯è§£å†³æ›´æ–°è¿‡ç¨‹ä¸­çš„å¹¶å‘å†²çªé—®é¢˜</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211110092515040.png"></p><ul><li><p>æ‚²è§‚å¹¶å‘æ§åˆ¶</p><p>è¿™ç§æ–¹æ³•è¢«å…³ç³»å‹æ•°æ®åº“å¹¿æ³›ä½¿ç”¨, å®ƒå‡å®šæœ‰å˜æ›´å†²çªå¯èƒ½å‘ç”Ÿ, å› æ­¤é˜»å¡è®¿é—®èµ„æºä»¥é˜²æ­¢å†²çª, ä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯è¯»å–ä¸€è¡Œæ•°æ®ä¹‹å‰å…ˆå°†å…¶é”ä½, ç¡®ä¿åªæœ‰é˜²æ­¢é”çš„çº¿ç¨‹èƒ½å¤Ÿå¯¹è¿™è¡Œæ•°æ®è¿›è¡Œä¿®æ”¹.</p></li><li><p>ä¹è§‚å¹¶å‘æ§åˆ¶</p><p>elasticsearchä¸­ä½¿ç”¨çš„è¿™ç§æ–¹æ³•å‡å®šå†²çªæ˜¯ä¸å¯èƒ½å‘ç”Ÿçš„, å¹¶ä¸”ä¸ä¼šé˜»å¡æ­£åœ¨å°è¯•çš„æ“ä½œ, ç„¶è€Œ, å¦‚æœå…ƒæ•°æ®åœ¨è¯»å†™å½“ä¸­è¢«ä¿®æ”¹, æ›´æ–°å°†ä¼šå¤±è´¥, ç¨‹åºåœ¨æ¥ä¸‹æ¥å°†å†³å®šåº”è¯¥å¦‚ä½•è§£å†³å†²çª. ä¾‹å¦‚å¯ä»¥é‡æ–°ç»™å—¯è¡Œ, ä½¿ç”¨æ–°çš„æ•°æ®, æˆ–è€…å°†ç›¸å…³çš„æƒ…å†µæŠ¥å‘Šç»™å®¢æˆ·</p></li></ul><h2 id="åˆ é™¤æ–¹å¼"><a href="#åˆ é™¤æ–¹å¼" class="headerlink" title="åˆ é™¤æ–¹å¼"></a>åˆ é™¤æ–¹å¼</h2><p>å¦‚æœè¯¥æ–‡æ¡£è¢«åˆ é™¤, ä¹Ÿä¸ä¼šç›´æ¥ç‰©ç†åˆ é™¤, è€Œæ˜¯é€šè¿‡ç»™æ–‡æ¡£æ‰“ä¸Šåˆ é™¤çš„æ ‡è®°, è¿›è¡Œé€»è¾‘åˆ é™¤, ç›´åˆ°è¯¥ç´¢å¼•è§¦å‘åˆå¹¶çš„æ—¶å€™, æ‰ä¼šè¿›è¡Œç‰©ç†åˆ é™¤, é‡Šæ”¾å­˜å‚¨ç©ºé—´</p><h2 id="å…³äºshardä¸æ®µçš„åˆ’åˆ†"><a href="#å…³äºshardä¸æ®µçš„åˆ’åˆ†" class="headerlink" title="å…³äºshardä¸æ®µçš„åˆ’åˆ†"></a>å…³äºshardä¸æ®µçš„åˆ’åˆ†</h2><p>ç”±äºç´¢å¼•æ˜¯ä»¥å¤©ä¸ºå•ä½è¿›è¡Œå»ºç«‹çš„, å¦‚æœä¸šåŠ¡çº¿å¾ˆå¤š, æ¯ä¸ªç´¢å¼•åˆä¸æ³¨æ„æ§åˆ¶åˆ†ç‰‡, å¦‚ç§¯æœˆç´¯ä¸‹æ¥ä¸€ä¸ªé›†ç¾¤å‡ ä¸‡åˆ°å‡ åä¸‡ä¸ªåˆ†ç‰‡ä¹Ÿæ˜¯ä¸éš¾è§åˆ°çš„.</p><h2 id="shardå¤ªå¤šå¸¦æ¥çš„å±å®³"><a href="#shardå¤ªå¤šå¸¦æ¥çš„å±å®³" class="headerlink" title="shardå¤ªå¤šå¸¦æ¥çš„å±å®³"></a>shardå¤ªå¤šå¸¦æ¥çš„å±å®³</h2><p> æ¯ä¸ªåˆ†ç‰‡éƒ½æœ‰luceneç´¢å¼•, è¿™äº›ç´¢å¼•éƒ½ä¼šæ¶ˆè€—cpuå’Œå†…å­˜, åŒæ ·çš„æ•°æ®, åˆ†ç‰‡è¶Šå¤š, é¢å¤–æ¶ˆè€—çš„cpuå’Œå†…å­˜å°±ä¼šè¶Šå¤š, ä¼šå‡ºç°1+1&gt;2çš„æƒ…å†µ</p><p>shardçš„ç›®çš„æ˜¯ä¸ºäº†è´Ÿè½½å‡è¡¡è®©æ¯ä¸ªè§‰ç‚¹çš„ç¡¬ä»¶å……åˆ†å‘æŒ¥, ä½†æ˜¯å¦‚æœåˆ†ç‰‡å¤šçš„æƒ…å†µä¸‹, åœ¨å•ä¸ªå‡ ç‚¹ä¸Šçš„å¤šä¸ªshardåŒæ—¶æ¥å—è¯·æ±‚, å¹¶å¯¹æœ¬èŠ‚ç‚¹çš„èµ„æºå½¢æˆäº†ç«äº‰, å®é™…ä¸Šåè€Œé€ æˆäº†å†…å­˜çš„æ¶ˆè€—.</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>HDFS-ä¼˜åŒ–</title>
      <link href="/2010/12/12/HDFS-%E4%BC%98%E5%8C%96/"/>
      <url>/2010/12/12/HDFS-%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Interview-FLink</title>
      <link href="/2010/12/12/Interview-Flink/"/>
      <url>/2010/12/12/Interview-Flink/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> Interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flink </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxç¯å¢ƒç¼–ç¨‹ï¼šä»åº”ç”¨åˆ°å†…æ ¸</title>
      <link href="/2010/12/12/Linux%E7%8E%AF%E5%A2%83%E7%BC%96%E7%A8%8B%EF%BC%9A%E4%BB%8E%E5%BA%94%E7%94%A8%E5%88%B0%E5%86%85%E6%A0%B8/"/>
      <url>/2010/12/12/Linux%E7%8E%AF%E5%A2%83%E7%BC%96%E7%A8%8B%EF%BC%9A%E4%BB%8E%E5%BA%94%E7%94%A8%E5%88%B0%E5%86%85%E6%A0%B8/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡ä»¶IO"><a href="#æ–‡ä»¶IO" class="headerlink" title="æ–‡ä»¶IO"></a>æ–‡ä»¶IO</h1><h2 id="Linuxä¸­çš„æ–‡ä»¶"><a href="#Linuxä¸­çš„æ–‡ä»¶" class="headerlink" title="Linuxä¸­çš„æ–‡ä»¶"></a>Linuxä¸­çš„æ–‡ä»¶</h2><h3 id="æ–‡ä»¶-æ–‡ä»¶æè¿°ç¬¦å’Œæ–‡ä»¶è¡¨"><a href="#æ–‡ä»¶-æ–‡ä»¶æè¿°ç¬¦å’Œæ–‡ä»¶è¡¨" class="headerlink" title="æ–‡ä»¶, æ–‡ä»¶æè¿°ç¬¦å’Œæ–‡ä»¶è¡¨"></a>æ–‡ä»¶, æ–‡ä»¶æè¿°ç¬¦å’Œæ–‡ä»¶è¡¨</h3><p>&emsp;Linuxå†…æ ¸å°†ä¸€åˆ‡è§†ä¸ºæ–‡ä»¶, Linuxä¸Šçš„æ–‡ä»¶æ—¢å¯ä»¥æ˜¯äº‹å®ä¸Šçš„çœŸæ­£çš„ç‰©ç†æ–‡ä»¶, ä¹Ÿå¯ä»¥è®¾å¤‡, ç®¡é“, ç”šè‡³è¿˜å¯ä»¥æ˜¯ä¸€å—å†…å­˜. ç‹­ä¹‰çš„æ–‡ä»¶æ˜¯æŒ‡æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç‰©ç†æ–‡ä»¶, è€Œå¹¿ä¹‰çš„æ–‡ä»¶åˆ™æ˜¯Linuxç®¡ç†çš„æ‰€æœ‰å¯¹è±¡. è¿™äº›å¹¿ä¹‰çš„æ–‡ä»¶åˆ©ç”¨VFSæœºåˆ¶, ä»¥æ–‡ä»¶ç³»ç»Ÿçš„å½¢å¼æŒ‚è½½åœ¨Linuxå†…æ ¸ä¸­, å¯¹å¤–æä¾›ä¸€è‡´çš„æ–‡ä»¶æ“ä½œæ¥å£.</p><p>&emsp;ä»æ•°å€¼ä¸Šçœ‹, æ–‡ä»¶æè¿°ç¬¦å°±æ˜¯ä¸€ä¸ªéè´Ÿçš„æ•´æ•°, å…¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå¥æŸ„, æ‰€ä»¥ä¹Ÿå¯ä»¥è®¤ä¸ºæ–‡ä»¶æè¿°ç¬¦å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„å¥æŸ„. é‚£ä¹ˆ, ä»€ä¹ˆæ˜¯å¥æŸ„å‘¢? ä¸€åˆ‡å¯¹äºç”¨æˆ·é€æ˜çš„è¿”å›å€¼, å³å¯ä»¥è§†ä¸ºæ˜¯å¥æŸ„. ç”¨æˆ·ç©ºé—´åˆ©ç”¨æ–‡ä»¶æè¿°ç¬¦ä¸å†…æ ¸è¿›è¡Œäº¤äº’, è€Œå†…æ ¸æ‹¿åˆ°æ–‡ä»¶æè¿°ç¬¦ä¹‹å, å¯ä»¥é€šè¿‡å®ƒå¾—åˆ°ç”¨äºç®¡ç†æ–‡ä»¶çš„çœŸæ­£çš„æ•°æ®ç»“æ„.</p><p><strong>&emsp;ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ä¹Ÿå°±æ˜¯å¥æŸ„</strong>, æœ‰ä¸¤ä¸ªå¥½å¤„: ä¸€æ˜¯å¢åŠ äº†å®‰å…¨æ€§, å¥æŸ„ç±»å‹å¯¹äºç”¨æˆ·å®Œå…¨é€æ˜, ç”¨æˆ·æ— æ³•é€šè¿‡ä»»ä½•hackingçš„æ–¹å¼, ç¼¸ç›–å¥æŸ„å¯¹åº”çš„å†…éƒ¨ç»“æœ, æ¯”å¦‚Linuxå†…æ ¸çš„æ–‡ä»¶æè¿°ç¬¦, åªæœ‰å†…æ ¸æ‰èƒ½é€šè¿‡è¯¥å€¼å¾—åˆ°å¯¹åº”çš„æ–‡ä»¶ç»“æ„; äºŒæ˜¯å¢åŠ å¯å¯æ‰©å±•æ€§, ç”¨æˆ·çš„ä»£ç åªä¾èµ–ä¸å¥æŸ„çš„å€¼, è¿™æ ·å®é™…ç»“æ„çš„ç±»å‹å°±å¯ä»¥éšæ—¶å‘ç”Ÿå˜åŒ–, ä¸å¥æŸ„çš„æ˜ å°„å…³ç³»ä¹Ÿå¯ä»¥éšæ—¶å‘ç”Ÿæ”¹å˜, è¿™äº›å˜åŒ–éƒ½ä¸ä¼šå½±å“ä»»ä½•ç°æœ‰çš„ç”¨è¿‡æˆ·ä»£ç . </p><p>&emsp;Linuxçš„æ¯ä¸ªè¿›ç¨‹éƒ½ä¼šç»´æŠ¤ä¸€ä¸ªæ–‡ä»¶è¡¨, ä»¥ä¾¿ç»´æŠ¤è¯¥è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„ä¿¡æ¯, åŒ…æ‹¬æ‰“å¼€çš„æ–‡ä»¶ä¸ªæ•°, æ¯ä¸ªæ‰“å¼€æ–‡ä»¶çš„åç§»é‡ç­‰ä¿¡æ¯. </p><h3 id="å†…æ ¸æ–‡ä»¶è¡¨çš„å®ç°"><a href="#å†…æ ¸æ–‡ä»¶è¡¨çš„å®ç°" class="headerlink" title="å†…æ ¸æ–‡ä»¶è¡¨çš„å®ç°"></a>å†…æ ¸æ–‡ä»¶è¡¨çš„å®ç°</h3><p>å†…æ ¸ä¸­è¿›ç¨‹å¯¹åº”çš„ç»“æ„æ˜¯task_struct, è¿›ç¨‹çš„æ–‡ä»¶è¡¨ä¿å­˜åœ¨task_struct -&gt; filesä¸­</p><p>files_structæ˜¯å¦‚ä½•ä½¿ç”¨é»˜è®¤çš„fdtabå’Œfd_arrayçš„, initæ˜¯Linuxçš„ç¬¬ä¸€ä¸ªè¿›ç¨‹, å®ƒçš„æ–‡ä»¶è¡¨æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡, ä»£ç å¦‚ä¸‹: </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">struct  files_struct  init_files  =  &#123;</span><br><span class="line">.count=  ATOMIC_INIT(1),</span><br><span class="line">.fdt=  &amp;init_files.fdtab,</span><br><span class="line">.fdtab=  &#123;</span><br><span class="line">.max_fds=  NR_OPEN_DEFAULT,</span><br><span class="line">.fd=  &amp;init_files.fd_array[0],</span><br><span class="line"></span><br><span class="line">.close_on_exec    =  (fd_set  *)&amp;init_files.close_on_exec_init,</span><br><span class="line">.open_fds=  (fd_set  *)&amp;init_files.open_fds_init,</span><br><span class="line">&#125;,</span><br><span class="line">.file_lock    =      SPIN_LOCK_UNLOCKED(init_task.file_lock),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Interview-HDFS</title>
      <link href="/2010/12/12/Interview-HDFS/"/>
      <url>/2010/12/12/Interview-HDFS/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> Interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
            <tag> HDFS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flink-çŸ¥è¯†ç‚¹</title>
      <link href="/2010/12/12/Flink-%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2010/12/12/Flink-%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€å•ä»‹ç»ä¸€ä¸‹FLink"><a href="#ç®€å•ä»‹ç»ä¸€ä¸‹FLink" class="headerlink" title="ç®€å•ä»‹ç»ä¸€ä¸‹FLink"></a>ç®€å•ä»‹ç»ä¸€ä¸‹FLink</h2><p>&emsp;Flinkæ˜¯ä¸€ä¸ªæ¡†æ¶å’Œåˆ†å¸ƒå¼å¤„ç†å¼•æ“, ç”¨äºå¯¹æœ‰ç•Œæµå’Œæ— ç•Œæµè¿›è¡Œæœ‰çŠ¶æ€çš„è®¡ç®—. å¹¶ä¸”Flinkè¿˜æä¾›äº†æ•°æ®åˆ†å¸ƒ, å®¹é”™æœºåˆ¶ä»¥åŠèµ„æºç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½. Flinkæä¾›äº†è¯¸å¤šé«˜æŠ½è±¡å±‚çš„APIä¸€è¾¹ç”¨æˆ·ç¼–å†™åˆ†å¸ƒå¼ä»»åŠ¡. </p><p>&emsp;DataSet API, å¯¹é™æ€æ•°æ®è¿›è¡Œæ‰¹å¤„ç†æ“ä½œ, å°†é™æ€æ•°æ®æŠ½è±¡æˆä¸ºåˆ†å¸ƒå¼çš„æ•°æ®é›†, ç”¨æˆ·å¯ä»¥ä½¿ç”¨Flinkæä¾›çš„å„ç§æ“ä½œç¬¦å¯¹åˆ†å¸ƒå¼æ•°æ®é›†è¿›è¡Œå¤„ç†, æ”¯æŒJava, Scala, Python</p><p>&emsp;DataStream API, å¯¹äºæ•°æ®æµè¿›è¡Œæµå¤„ç†æ“ä½œ, å°†æµå¼çš„æ•°æ®æŠ½è±¡æˆåˆ†å¸ƒå¼çš„æ•°æ®æµ, ç”¨æˆ·å¯ä»¥æ–¹ä¾¿çš„å¯¹åˆ†å¸ƒå¼æ•°æ®æµè¿›è¡Œå„ç§æ“ä½œ, æ”¯æŒJavaå’ŒScala</p><p>&emsp;Table API, å¯¹ç»“æ„åŒ–æ•°æ®è¿›è¡ŒæŸ¥è¯¢æ“ä½œ, å°†ç»“æ„åŒ–æ•°æ®æŠ½è±¡æˆå…³ç³»è¡¨, å¹¶é€šè¿‡ç±»SQLçš„DSLå¯¹è¾¨æè¡¨è¿›è¡Œå„ç§æŸ¥è¯¢æ“ä½œ, æ”¯æŒJavaå’ŒScala</p><p>â€‹    æ­¤å¤–Flinkè¿˜å¯¹ç‰¹å®šçš„åº”ç”¨é¢†åŸŸæä¾›äº†é¢†åŸŸåº“, ä¾‹å¦‚: Flink ML, Flinkçš„æœºå™¨å­¦ä¹ åº“, æä¾›äº†æœºå™¨å­¦ä¹ Pipelines APIå¹¶å®ç°äº†å¤šç§æœºå™¨å­¦ä¹ ç®—æ³•, Gelly, Flink çš„å›¾è®¡ç®—åº“, æä¾›äº†å›¾è®¡ç®—çš„ç›¸å…³APIä»¥åŠå¤šç§å›¾è®¡ç®—ç®—æ³•å®ç°. </p><h2 id="Flinkå’ŒSpark-Streamingçš„åŒºåˆ«"><a href="#Flinkå’ŒSpark-Streamingçš„åŒºåˆ«" class="headerlink" title="Flinkå’ŒSpark Streamingçš„åŒºåˆ«"></a>Flinkå’ŒSpark Streamingçš„åŒºåˆ«</h2><p>&emsp;Flinkæ˜¯æ ‡å‡†çš„å®æ—¶å¤„ç†å¼•æ“, åŸºäºäº‹ä»¶é©±åŠ¨, è€ŒSpark Streamingæ˜¯ä¸ºæ‰¹å¤„ç†æ¨¡å‹(Micro-Batch)çš„æ¨¡å‹.</p><p>ğŸŒ°<strong>ä¸»è¦åŒºåˆ«</strong></p><ol><li><p>æ¶æ„æ¨¡å‹</p><p>1ï¸âƒ£ SparkStreamingåœ¨è¿è¡Œçš„æ—¶å€™çš„ä¸»è¦è§’è‰²æ˜¯: Master, Worker, Driver, Executor</p><p>2ï¸âƒ£ Flinkåœ¨è¿è¡Œæ—¶ä¸»è¦åŒ…å«JobManager, TaskManagerå’ŒSlot</p></li><li><p>ä»»åŠ¡è°ƒåº¦</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> é¢è¯•ç›¸å…³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flink </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿</title>
      <link href="/2010/12/12/Hadoop-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2010/12/12/Hadoop-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Redis</title>
      <link href="/2010/12/12/Redis/"/>
      <url>/2010/12/12/Redis/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><ul><li>redisæ˜¯ä¸€ä¸ªå¼€æºçš„key-valueå­˜å‚¨ç³»ç»Ÿ</li><li>å’Œmemcachedä¸€æ ·çš„, ä¸ºäº†ä¿è¯æ•°æ®çš„æ•ˆç‡, æ‰€ä»¥æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­</li><li>å’Œmemcachedç±»ä¼¼, å®ƒæ”¯æŒçš„å­˜å‚¨çš„valueç±»å‹æ›´åŠ çš„å¤š, åŒ…æ‹¬string, list, set, zset</li></ul>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdownä½¿ç”¨-å…¬å¼ç¬¦å·</title>
      <link href="/2010/12/12/Markdown%E4%BD%BF%E7%94%A8-%E5%85%AC%E5%BC%8F%E7%AC%A6%E5%8F%B7/"/>
      <url>/2010/12/12/Markdown%E4%BD%BF%E7%94%A8-%E5%85%AC%E5%BC%8F%E7%AC%A6%E5%8F%B7/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> æ–‡æ¡£ç¼–è¾‘ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Netty, Redis, Zookeeperé«˜å¹¶å‘å®æˆ˜(é˜…è¯»ä¸­)</title>
      <link href="/2010/12/12/Netty,%20Redis,%20Zookeeper%E9%AB%98%E5%B9%B6%E5%8F%91%E5%AE%9E%E6%88%98,%20/"/>
      <url>/2010/12/12/Netty,%20Redis,%20Zookeeper%E9%AB%98%E5%B9%B6%E5%8F%91%E5%AE%9E%E6%88%98,%20/</url>
      
        <content type="html"><![CDATA[<h1 id="é«˜å¹¶å‘æ—¶ä»£çš„å¿…å¤‡æŠ€èƒ½"><a href="#é«˜å¹¶å‘æ—¶ä»£çš„å¿…å¤‡æŠ€èƒ½" class="headerlink" title="é«˜å¹¶å‘æ—¶ä»£çš„å¿…å¤‡æŠ€èƒ½"></a>é«˜å¹¶å‘æ—¶ä»£çš„å¿…å¤‡æŠ€èƒ½</h1><p>&emsp;&emsp;é«˜å¹¶å‘æ—¶ä»£å·²ç„¶åˆ°æ¥, Netty, Redis, Zookeeperæ˜¯é«˜å¹¶å‘æ—¶ä»£çš„å¿…å¤‡å·¥å…·.</p><h2 id="Nettyä¸ºä½•è¿™ä¹ˆç«"><a href="#Nettyä¸ºä½•è¿™ä¹ˆç«" class="headerlink" title="Nettyä¸ºä½•è¿™ä¹ˆç«"></a>Nettyä¸ºä½•è¿™ä¹ˆç«</h2><p>&emsp;&emsp;Nettyæ˜¯JBOOSæä¾›çš„ä¸€ä¸ªJavaå¼€æºæ¡†æ¶, æ˜¯åŸºäºNIOçš„å®¢æˆ·ç«¯, æœåŠ¡å™¨ç¼–ç¨‹æ¡†æ¶, å®ƒæ—¢èƒ½å¿«é€Ÿå¼€å‘é«˜å¹¶å‘, é«˜å¯ç”¨ , é«˜å¯é æ€§çš„ç½‘ç»œæœåŠ¡å™¨ç¨‹åº, ä¹Ÿèƒ½å¼€å‘é«˜å¯ç”¨, é«˜å¯é çš„å®¢æˆ·ç«¯. </p><blockquote><p>NIOæ˜¯æŒ‡éé˜»å¡è¾“å…¥è¾“å‡º(Non-Blocking IO), ä¹Ÿç§°éé˜»å¡IO.</p></blockquote><h2 id="é«˜å¹¶å‘åˆ©å™¨Redis-ç©º"><a href="#é«˜å¹¶å‘åˆ©å™¨Redis-ç©º" class="headerlink" title="é«˜å¹¶å‘åˆ©å™¨Redis(ç©º)"></a>é«˜å¹¶å‘åˆ©å™¨Redis(ç©º)</h2><h2 id="åˆ†å¸ƒå¼åˆ©å™¨Zookeeper-ç©º"><a href="#åˆ†å¸ƒå¼åˆ©å™¨Zookeeper-ç©º" class="headerlink" title="åˆ†å¸ƒå¼åˆ©å™¨Zookeeper(ç©º)"></a>åˆ†å¸ƒå¼åˆ©å™¨Zookeeper(ç©º)</h2><h2 id="é«˜å¹¶å‘IMçš„ç»¼åˆå®è·µ-ç©º"><a href="#é«˜å¹¶å‘IMçš„ç»¼åˆå®è·µ-ç©º" class="headerlink" title="é«˜å¹¶å‘IMçš„ç»¼åˆå®è·µ(ç©º)"></a>é«˜å¹¶å‘IMçš„ç»¼åˆå®è·µ(ç©º)</h2><h2 id="Netty-Redis-Zookeeperå®è·µè®¡åˆ’-ç©º"><a href="#Netty-Redis-Zookeeperå®è·µè®¡åˆ’-ç©º" class="headerlink" title="Netty, Redis, Zookeeperå®è·µè®¡åˆ’(ç©º)"></a>Netty, Redis, Zookeeperå®è·µè®¡åˆ’(ç©º)</h2><h2 id="æœ¬ç« å°ç»“-ç©º"><a href="#æœ¬ç« å°ç»“-ç©º" class="headerlink" title="æœ¬ç« å°ç»“(ç©º)"></a>æœ¬ç« å°ç»“(ç©º)</h2><h1 id="é«˜å¹¶å‘IOçš„åº•å±‚åŸç†"><a href="#é«˜å¹¶å‘IOçš„åº•å±‚åŸç†" class="headerlink" title="é«˜å¹¶å‘IOçš„åº•å±‚åŸç†"></a>é«˜å¹¶å‘IOçš„åº•å±‚åŸç†</h1><h2 id="IOè¯»å†™çš„åŸºæœ¬åŸç†"><a href="#IOè¯»å†™çš„åŸºæœ¬åŸç†" class="headerlink" title="IOè¯»å†™çš„åŸºæœ¬åŸç†"></a>IOè¯»å†™çš„åŸºæœ¬åŸç†</h2><p>&emsp;å¤§å®¶çŸ¥é“, ç”¨æˆ·ç¨‹åºåœ¨è¿›è¡ŒIOè¯»å†™çš„æ—¶å€™, ä¾èµ–äºåº•å±‚çš„IOè¯»å†™, åŸºæœ¬ä¸Šä¼šç”¨åˆ°åº•çš„read&amp;writeä¸¤å¤§ç³»ç»Ÿè°ƒç”¨. åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸­, IOè¯»å†™çš„ç³»ç»Ÿè°ƒç”¨çš„åç§°å¯èƒ½ä¸å®Œå…¨ä¸€æ ·, ä½†æ˜¯åŸºæœ¬åŠŸèƒ½æ˜¯ä¸€æ ·çš„.</p><p>&emsp;è¿™é‡Œè®¾è®¡ä¸€ä¸ªåŸºç¡€åªæ˜¯: readç³»ç»Ÿè°ƒç”¨, å¹¶ä¸æ˜¯ç›´æ¥ä»ç‰©ç†è®¾å¤‡æŠŠæ•°æ®è¯»å–åˆ°å†…å­˜ä¸­; writeç³»ç»Ÿè°ƒç”¨, ä¹Ÿä¸æ˜¯ç›´æ¥æŠŠæ•°æ®å†™å…¥åˆ°ç‰©ç†è®¾å¤‡ä¸­. ä¸Šå±‚åº”ç”¨æ— è®ºæ˜¯è°ƒç”¨æ“ä½œç³»ç»Ÿçš„read, è¿˜æ˜¯è°ƒç”¨æ“ä½œç³»ç»Ÿçš„write, éƒ½ä¼šæ¶‰åŠç¼“å†²åŒº. <strong>å…·ä½“æ¥è¯´, è°ƒç”¨æ“ä½œç³»ç»Ÿçš„read, æ˜¯æŠŠæ•°æ®ä»å†…æ ¸ç¼“å†²åŒºå¤åˆ¶åˆ°è¿›ç¨‹ç¼“å†²åŒº; è€Œwriteç³»ç»Ÿè°ƒç”¨, æ˜¯æŠŠæ•°æ®ä»è¿›ç¨‹ç¼“å†²åŒºå¤åˆ¶åˆ°å†…å­˜ç¼“å†²åŒº.</strong></p><p>&emsp;ä¹Ÿå°±æ˜¯è¯´, <strong>ä¸Šå±‚ç¨‹åºçš„IOæ“ä½œ, å®é™…ä¸Šä¸æ˜¯ç‰©ç†è®¾å¤‡çº§åˆ«çš„è¯»å†™, è€Œæ˜¯ç¼“å­˜çš„å¤åˆ¶.</strong> read&amp;writeä¸¤å¤§ç³»ç»Ÿçš„è°ƒç”¨, éƒ½ä¸è´Ÿè´£æ•°æ®åœ¨å†…æ ¸ç¼“å†²åŒºå’Œç‰©ç†è®¾å¤‡(å¦‚ç£ç›˜)ä¹‹é—´çš„äº¤æ¢, è¿™é¡¹åº•å±‚çš„è¯»å†™äº¤æ¢, æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸(Kernel)æ¥å®Œæˆçš„. </p><p>&emsp;åœ¨ç”¨æˆ·ç¨‹åºä¸­, æ— è®ºæ˜¯Socketçš„IO, è¿˜æ˜¯æ–‡ä»¶çš„IOæ“ä½œ, éƒ½å±äºä¸Šå±‚åº”ç”¨çš„å¼€å‘, å®ƒä»¬çš„è¾“å…¥(Input)å’Œè¾“å‡º(Output)çš„å¤„ç†, åœ¨ç¼–ç¨‹çš„æµç¨‹ä¸Š, å¤šæ˜¯ä¸€è‡´çš„.</p><h3 id="å†…æ ¸ç¼“å†²åŒºä¸è¿›ç¨‹ç¼“å†²åŒº"><a href="#å†…æ ¸ç¼“å†²åŒºä¸è¿›ç¨‹ç¼“å†²åŒº" class="headerlink" title="å†…æ ¸ç¼“å†²åŒºä¸è¿›ç¨‹ç¼“å†²åŒº"></a>å†…æ ¸ç¼“å†²åŒºä¸è¿›ç¨‹ç¼“å†²åŒº</h3><p>&emsp;ä¸ºä»€ä¹ˆè®¾ç½®é‚£ä¹ˆå¤šçš„ç¼“å†²åŒº, ä¸ºä»€ä¹ˆè¦é‚£ä¹ˆéº»çƒ¦å‘¢? ç¼“å†²åŒºçš„ç›®çš„æ˜¯ä¸ºäº†å‡å°‘é¢‘ç¹åœ°ä¸è®¾å¤‡ä¹‹é—´çš„ç‰©ç†äº¤æ¢. å¤§å®¶éƒ½çŸ¥é“, å¤–éƒ¨è®¾å¤‡çš„ç›´æ¥è¯»å†™, æ¶‰åŠæ“ä½œç³»ç»Ÿçš„ä¸­æ–­. <strong>å‘ç”Ÿç³»ç»Ÿä¸­æ–­æ—¶, éœ€è¦ä¿å­˜ä¹‹å‰çš„è¿›ç¨‹æ•°æ®å’ŒçŠ¶æ€ç­‰ä¿¡æ¯, è€Œç»“æŸä¸­æ–­ä¹‹å, è¿˜éœ€è¦æ¢å¤ä¹‹å‰çš„è¿›ç¨‹æ•°æ®å’ŒçŠ¶æ€ç­‰ä¿¡æ¯, ä¸ºäº†å‡å°‘è¿™ç§åº•å±‚ç³»ç»Ÿçš„æ—¶é—´æŸè€—, æ€§èƒ½æŸè€—, äºæ˜¯å‡ºç°äº†ç¼“å†²åŒº.</strong> </p><p>&emsp;æœ‰äº†å†…å­˜ç¼“å†²åŒº, ä¸Šå±‚åº”ç”¨ä½¿ç”¨readç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™, ä»…ä»…æ˜¯æŠŠæ•°æ®ä»å†…æ ¸ç¼“å†²åŒºå¤åˆ¶åˆ°ä¸Šå±‚åº”ç”¨çš„ç¼“å†²åŒº(è¿›ç¨‹ç¼“å†²åŒº) ;ä¸Šå±‚åº”ç”¨ä½¿ç”¨writeç³»ç»Ÿè°ƒç”¨æ—¶, ä»…ä»…æŠŠæ•°æ®ä»è¿›ç¨‹ç¼“å†²åŒºå¤åˆ¶åˆ°å†…æ ¸ç¼“å†²åŒºä¸­. åº•å±‚æ“ä½œä¼šå¯¹å†…æ ¸ç¼“å†²åŒºè¿›è¡Œç›‘æ§, ç­‰å¾…ç¼“å†²åŒºè¾¾åˆ°ä¸€å®šæ•°é‡çš„æ—¶å€™, å†è¿›è¡ŒIOè®¾å¤‡çš„ä¸­æ–­å¤„ç†, é›†ä¸­æ‰§è¡Œç‰©ç†è®¾å¤‡çš„å®é™…IOæ“ä½œ, è¿™ç§æœºåˆ¶æå‡äº†ç³»ç»Ÿçš„æ€§èƒ½. è‡³äºä»€ä¹ˆæ—¶å€™ä¸­æ–­(è¯»ä¸­æ–­, å†™ä¸­æ–­), ç”±æ“ä½œç³»ç»Ÿçš„å†…æ ¸æ¥å†³å®š, ç”¨æˆ·ç¨‹åºåˆ™ä¸éœ€è¦å…³å¿ƒ</p><p>&emsp;ä»æ•°é‡ä¸Šæ¥è¯´, **åœ¨Linuxç³»ç»Ÿä¸­, æ“ä½œç³»ç»Ÿå†…æ ¸åªæœ‰ä¸€ä¸ªå†…æ ¸ç¼“å†²åŒº. è€Œæ¯ä¸ªç”¨æˆ·ç¨‹åº(è¿›ç¨‹), æœ‰è‡ªå·±ç‹¬ç«‹çš„ç¼“å†²åŒº, å«åšè¿›ç¨‹ç¼“å†²åŒº. **æ‰€ä»¥, ç”¨æˆ·ç¨‹åºçš„IOè¯»å†™ç¨‹åº, åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹, å¹¶æ²¡æœ‰è¿›è¡Œå®é™…çš„IOæ“ä½œ, è€Œæ˜¯åœ¨è¿›ç¨‹ç¼“å†²åŒºå’Œå†…æ ¸ç¼“å†²å™¨ä¹‹é—´è¿›è¡Œæ•°æ®çš„äº¤æ¢.</p><h3 id="è¯¦è§£å…¸å‹çš„ç³»ç»Ÿè°ƒç”¨æµç¨‹"><a href="#è¯¦è§£å…¸å‹çš„ç³»ç»Ÿè°ƒç”¨æµç¨‹" class="headerlink" title="è¯¦è§£å…¸å‹çš„ç³»ç»Ÿè°ƒç”¨æµç¨‹"></a>è¯¦è§£å…¸å‹çš„ç³»ç»Ÿè°ƒç”¨æµç¨‹</h3><p>&emsp;å‰é¢è®²åˆ°, ç”¨æˆ·ç¨‹åºæ‰€ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨read&amp;write, å®ƒä»¬ä¸ç­‰ä»·äºæ•°æ®åœ¨å†…æ ¸ç¼“å†²åŒºå’Œç£ç›˜æ—¶é—´çš„äº¤æ¢. readæŠŠæ•°æ®ä»å†…æ ¸ç¼“å†²åŒºå¤åˆ¶åˆ°è¿›ç¨‹ç¼“å†²åŒº, writeæŠŠæ•°æ®ä»è¿›ç¨‹ç¼“å†²åŒºå¤åˆ¶åˆ°å†…æ ¸ç¼“å†²åŒº, å…·ä½“æ‰§è¡Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211203145059416.png"></p><p>(ç©º)</p><h2 id="å››ç§ä¸»è¦çš„IOæ¨¡å‹"><a href="#å››ç§ä¸»è¦çš„IOæ¨¡å‹" class="headerlink" title="å››ç§ä¸»è¦çš„IOæ¨¡å‹"></a>å››ç§ä¸»è¦çš„IOæ¨¡å‹</h2><p>&emsp;Â æœåŠ¡å™¨ç¼–ç¨‹, ç»å¸¸éœ€è¦æ„é€ é«˜æ€§èƒ½çš„ç½‘ç»œæœåŠ¡å™¨, éœ€è¦å¯»ç”¨é«˜æ€§èƒ½çš„IOæ¨¡å‹, è¿™ä¹Ÿæ˜¯é€šå…³å¤§å…¬å¸é¢è¯•å¿…å¤‡çš„çŸ¥è¯†</p><p>&emsp;æœ¬ç« ä»æœ€ä¸ºåŸºç¡€çš„æ¨¡å‹å¼€å§‹å—, ä¸ºå¤§å®¶æ­ç§˜IOæ¨¡å‹, å¸¸è§çš„IOæ¨¡å‹æœ‰å››ç§: </p><ul><li><p>åŒæ­¥é˜»å¡IO(Blocking IO)</p><p>&emsp;é¦–å…ˆ, è§£é‡Šä¸€ä¸‹è¿™é‡Œçš„é˜»å¡ä¸éé˜»å¡</p><p><strong>&emsp;é˜»å¡IO, æŒ‡çš„æ˜¯éœ€è¦å†…æ ¸IOæ“ä½œå½»åº•å®Œæˆä¹‹å, æ‰è¿”å›åˆ°ç”¨æˆ·ç©ºé—´æ‰§è¡Œç”¨æˆ·çš„æ“ä½œ</strong>. é˜»å¡æŒ‡çš„æ˜¯ç”¨æˆ·ç©ºé—´ç¨‹åºçš„æ‰§è¡ŒçŠ¶æ€. ä¼ ç»Ÿçš„IOæ¨¡å‹éƒ½æ˜¯åŒæ­¥é˜»å¡. åœ¨Javaä¸­, é»˜è®¤åˆ›å»ºçš„socketéƒ½æ˜¯é˜»å¡çš„.</p><p>&emsp;è§£é‡Šä¸€ä¸‹åŒæ­¥ä¸å¼‚æ­¥:</p><p><strong>&emsp;åŒæ­¥IO, æ˜¯ä¸€ç§ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´çš„IOå‘èµ·æ–¹å¼. åŒæ­¥IOæ˜¯æŒ‡æœ‰ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹æ—¶ä¸»åŠ¨å‘èµ·IOè¯·æ±‚çš„ä¸€æ–¹, å†…æ ¸ç©ºé—´æ˜¯è¢«åŠ¨æ¥æ”¶æ–¹. å¼‚æ­¥IOåˆ™åè¿‡æ¥, æ˜¯æŒ‡ç³»ç»Ÿå†…æ ¸æ—¶ä¸»åŠ¨å‘èµ·è¯·æ±‚çš„ä¸€æ–¹, ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹æ—¶è¢«åŠ¨æ¥æ”¶æ–¹.</strong></p></li><li><p>åŒæ­¥éé˜»å¡IO(Non-blocking IO)</p><p><strong>&emsp;éé˜»å¡IO, æŒ‡çš„æ˜¯ç”¨æˆ·ç©ºé—´çš„ç¨‹åºä¸éœ€è¦ç­‰å¾…å†…æ ¸IOæ“ä½œå½»åº•å®Œæˆ, å¯ä»¥ç«‹å³è¿”å›ç”¨æˆ·ç©ºé—´æ‰§è¡Œç”¨æˆ·çš„æ“ä½œ, ä¹Ÿå°±æ˜¯å¤„äºéé˜»å¡çŠ¶æ€, ä¸æ­¤åŒæ—¶å†…æ ¸ä¼šç«‹å³è¿”å›ç»™ç”¨æˆ·ä¸€ä¸ªçŠ¶æ€å€¼.</strong> </p><p><strong>&emsp;ç®€å•æ¥è¯´, é˜»å¡æ˜¯æŒ‡ç”¨æˆ·ç©ºé—´(è°ƒç”¨çº¿ç¨‹)ä¸€ç›´ç­‰å¾…, è€Œä¸èƒ½å¹²åˆ«çš„äº‹æƒ…; éé˜»å¡æ˜¯æŒ‡ç”¨æˆ·ç©ºé—´(è°ƒç”¨çº¿ç¨‹)æ‹¿åˆ°å†…æ ¸è¿”å›çš„çŠ¶æ€å€¼å°±è¿”å›è‡ªå·±çš„ç©ºé—´, IOæ“ä½œå¯ä»¥å¹²å°±å¹², ä¸å¯ä»¥å¹², å°±å»å¹²åˆ«çš„äº‹æƒ…</strong></p><p>&emsp;éé˜»å¡IOè¦æ±‚socketè¢«è§†ä¹‹ä¸ºNONBLOCK</p><p>&emsp;å¼ºè°ƒä¸€ä¸‹, è¿™é‡Œè¯´çš„NIOæŒ‡çš„æ˜¯åŒæ­¥éé˜»å¡IO, å¹¶ä¸æ˜¯Javaçš„NIO, Javaçš„NIOæŒ‡çš„æ—¶New IO</p></li><li><p>IOå¤šè·¯å¤ç”¨ (IO Multiplexing)</p><p>&emsp;å³ç»å…¸çš„Reactorååº”å™¨è®¾è®¡æ¨¡å¼, æœ‰çš„æ—¶å€™ä¹Ÿè¢«ç§°ä¸ºå¼‚æ­¥IO, Javaä¸­çš„Selectoré€‰æ‹©å™¨å’ŒLinuxä¸­çš„epolléƒ½æ˜¯è¿™ç§è®¾è®¡æ¨¡å¼</p></li><li><p>å¼‚æ­¥IO (Asynchronous IO)</p><p>&emsp;å¼‚æ­¥IO, æŒ‡çš„æ˜¯ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´çš„è°ƒç”¨æ–¹å¼åè¿‡æ¥. ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹å˜æˆäº†è¢«åŠ¨æ¥å—è€…, è€Œå†…æ ¸ç©ºé—´æˆä¸ºäº†ä¸»åŠ¨è°ƒç”¨è€…. è¿™æœ‰ç‚¹ç±»ä¼¼ä¸Javaä¸­æ¯”è¾ƒå…¸å‹çš„å›è°ƒæ¨¡å¼, ç”¨æˆ·ç©ºé—´çš„å‘å†…æ ¸ç©ºé—´æ³¨å†Œäº†å„ç§IOæ—¶é—´çš„å›è°ƒå‡½æ•°, ç”±å†…æ ¸å»ä¸»åŠ¨è°ƒç”¨</p><blockquote><p>å›è°ƒå‡½æ•°å°±æ˜¯ä¸€ä¸ªé€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨çš„å‡½æ•°ã€‚å¦‚æœä½ æŠŠå‡½æ•°çš„æŒ‡é’ˆï¼ˆåœ°å€ï¼‰ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œå½“è¿™ä¸ªæŒ‡é’ˆè¢«ç”¨æ¥è°ƒç”¨å…¶æ‰€æŒ‡å‘çš„å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å°±è¯´è¿™æ˜¯å›è°ƒå‡½æ•°ã€‚å›è°ƒå‡½æ•°ä¸æ˜¯ç”±è¯¥å‡½æ•°çš„å®ç°æ–¹ç›´æ¥è°ƒç”¨ï¼Œè€Œæ˜¯åœ¨ç‰¹å®šçš„äº‹ä»¶æˆ–æ¡ä»¶å‘ç”Ÿæ—¶ç”±å¦å¤–çš„ä¸€æ–¹è°ƒç”¨çš„ï¼Œç”¨äºå¯¹è¯¥äº‹ä»¶æˆ–æ¡ä»¶è¿›è¡Œå“åº”ã€‚</p></blockquote></li></ul><h3 id="åŒæ­¥é˜»å¡IO-Blocking-IO"><a href="#åŒæ­¥é˜»å¡IO-Blocking-IO" class="headerlink" title="åŒæ­¥é˜»å¡IO (Blocking IO)"></a>åŒæ­¥é˜»å¡IO (Blocking IO)</h3><p>â€‹    åœ¨Javaåº”ç”¨ç¨‹åºè¿›ç¨‹ä¸­, é»˜è®¤æƒ…å†µä¸‹, æ‰€æœ‰çš„socketè¿æ¥çš„çš„IOæ“ä½œéƒ½æ˜¯åŒæ­¥é˜»å¡IO(Blocking IO)</p><p>&emsp;åœ¨é˜»å¡å¼IOæ¨¡å‹ä¸­, Javaç¨‹åºä»IOç³»ç»Ÿè°ƒç”¨å¼€å§‹, ç›´åˆ°ç³»ç»Ÿè°ƒç”¨è¿”å›, åœ¨è¿™æ®µæ—¶é—´å†…, Javaè¿›ç¨‹æ˜¯é˜»å¡çš„, è¿”å›æˆåŠŸç»“æœä¹‹å, åº”ç”¨ç¨‹åºå¼€å§‹å¤„ç†ç”¨æˆ·ç©ºé—´çš„ç¼“å­˜åŒºæ•°æ®</p><p>&emsp;åŒæ­¥é˜»å¡IOçš„å…·ä½“æµç¨‹, å¦‚å›¾æ‰€ç¤º:</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/image-20211210135759780.png"></p><p>&emsp;ä¸¾ä¸ªä¾‹å­, åœ¨Javaä¸­å‘èµ·ä¸€ä¸ªsocketçš„readè¯»æ“ä½œçš„ç³»ç»Ÿè°ƒç”¨, æµç¨‹å¤§è‡´å¦‚ä¸‹:</p><ul><li>ä»Javaå¯åŠ¨IOè¯»çš„readç³»ç»Ÿè°ƒç”¨å¼€å§‹, ç”¨æˆ·çº¿ç¨‹å°±è¿›å…¥é˜»å¡çŠ¶æ€</li><li>å½“ç³»ç»Ÿå†…æ ¸æ”¶åˆ°readç³»ç»Ÿè°ƒç”¨, å°±å¼€å§‹å‡†å¤‡æ•°æ®, ä¸€å¼€å§‹, æ•°æ®å¯èƒ½è¿˜æ²¡æœ‰åˆ°è¾¾å†…æ ¸çš„ç¼“å†²åŒº(æ¯”å¦‚, è¿˜æ²¡æœ‰æ”¶åˆ°ä¸€ä¸ªå®Œæ•´çš„socketåŒ…), è¿™ä¸ªæ—¶å€™å†…æ ¸å°±éœ€è¦ç­‰å¾…</li><li>å†…æ ¸ä¸€ç›´åˆ°ç­‰å¾…çŸ¥é“å®Œæ•´çš„æ•°æ®åˆ°è¾¾, å°±ä¼šå°†</li></ul>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> Netty </tag>
            
            <tag> Zookeeper </tag>
            
            <tag> åŒæ­¥ </tag>
            
            <tag> å¼‚æ­¥ </tag>
            
            <tag> é˜»å¡ </tag>
            
            <tag> éé˜»å¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹¿å‘Šæ•°ä»“</title>
      <link href="/2010/12/12/%E5%B9%BF%E5%91%8A%E6%95%B0%E4%BB%93/"/>
      <url>/2010/12/12/%E5%B9%BF%E5%91%8A%E6%95%B0%E4%BB%93/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ClickHouse </tag>
            
            <tag> Hadoop </tag>
            
            <tag> Hive </tag>
            
            <tag> Spark </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ¯è¯­</title>
      <link href="/2010/12/12/%E4%B8%93%E4%B8%9A%E5%90%8D%E8%AF%8D/"/>
      <url>/2010/12/12/%E4%B8%93%E4%B8%9A%E5%90%8D%E8%AF%8D/</url>
      
        <content type="html"><![CDATA[<h2 id="VFS"><a href="#VFS" class="headerlink" title="VFS"></a>VFS</h2><p>VFSï¼ˆvirtual File Systemï¼‰çš„ä½œç”¨å°±æ˜¯é‡‡ç”¨æ ‡å‡†çš„Unixç³»ç»Ÿè°ƒç”¨è¯»å†™ä½äºä¸åŒç‰©ç†ä»‹è´¨ä¸Šçš„ä¸åŒæ–‡ä»¶ç³»ç»Ÿ,å³ä¸ºå„ç±»æ–‡ä»¶ç³»ç»Ÿæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ“ä½œç•Œé¢å’Œåº”ç”¨ç¼–ç¨‹æ¥å£ã€‚VFSæ˜¯ä¸€ä¸ªå¯ä»¥è®©open()ã€read()ã€write()ç­‰ç³»ç»Ÿè°ƒç”¨ä¸ç”¨å…³å¿ƒåº•å±‚çš„å­˜å‚¨ä»‹è´¨å’Œæ–‡ä»¶ç³»ç»Ÿç±»å‹å°±å¯ä»¥å·¥ä½œçš„ç²˜åˆå±‚ã€‚<a href="https://baike.baidu.com/item/VFS/7519887?fr=aladdin">ç™¾åº¦ç™¾ç§‘</a></p><h2 id="å¥æŸ„"><a href="#å¥æŸ„" class="headerlink" title="å¥æŸ„"></a>å¥æŸ„</h2><p>å¥æŸ„ï¼ˆHandleï¼‰æ˜¯ä¸€ä¸ªæ˜¯ç”¨æ¥æ ‡è¯†å¯¹è±¡æˆ–è€…é¡¹ç›®çš„æ ‡è¯†ç¬¦ï¼Œå¯ä»¥ç”¨æ¥æè¿°çª—ä½“ã€æ–‡ä»¶ç­‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å¥æŸ„ä¸èƒ½æ˜¯å¸¸é‡ ã€‚</p><p>Windowsä¹‹æ‰€ä»¥è¦è®¾ç«‹å¥æŸ„ï¼Œæ ¹æœ¬ä¸Šæºäºå†…å­˜ç®¡ç†æœºåˆ¶çš„é—®é¢˜ï¼Œå³è™šæ‹Ÿåœ°å€ã€‚ç®€è€Œè¨€ä¹‹æ•°æ®çš„åœ°å€éœ€è¦å˜åŠ¨ï¼Œå˜åŠ¨ä»¥åå°±éœ€è¦æœ‰äººæ¥è®°å½•ã€ç®¡ç†å˜åŠ¨ï¼Œå› æ­¤ç³»ç»Ÿç”¨å¥æŸ„æ¥è®°è½½æ•°æ®åœ°å€çš„å˜æ›´ã€‚åœ¨ç¨‹åºè®¾è®¡ä¸­ï¼Œå¥æŸ„æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ™ºèƒ½æŒ‡é’ˆï¼Œå½“ä¸€ä¸ªåº”ç”¨ç¨‹åºè¦å¼•ç”¨å…¶ä»–ç³»ç»Ÿï¼ˆå¦‚æ•°æ®åº“ã€æ“ä½œç³»ç»Ÿï¼‰æ‰€ç®¡ç†çš„å†…å­˜å—æˆ–å¯¹è±¡æ—¶ï¼Œå°±è¦ä½¿ç”¨å¥æŸ„ ã€‚</p><p><a href="https://baike.baidu.com/item/%E5%8F%A5%E6%9F%84">ç™¾åº¦ç™¾ç§‘</a></p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RedisçŸ¥è¯†ç‚¹</title>
      <link href="/2010/12/12/Redis%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2010/12/12/Redis%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<p>fasdf</p>]]></content>
      
      
      <categories>
          
          <category> é¢è¯•ç›¸å…³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lombok</title>
      <link href="/2010/12/12/StringUtils/"/>
      <url>/2010/12/12/StringUtils/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-ElasticSearch/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-ElasticSearch/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Azkaban</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Azkaban/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Azkaban/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Azkaban </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DataX</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-DataX/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-DataX/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DataX </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Doris</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Doris/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Doris/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Doris </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Git/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Git/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HBase</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-HBase/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-HBase/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HBase </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HDFS</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-HDFS/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-HDFS/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HDFS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDEAé…ç½®ä¿¡æ¯</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-IDEA-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-IDEA-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="è‡ªå®šä¹‰æ¨¡æ¿"><a href="#è‡ªå®šä¹‰æ¨¡æ¿" class="headerlink" title="è‡ªå®šä¹‰æ¨¡æ¿"></a>è‡ªå®šä¹‰æ¨¡æ¿</h2>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hudi</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Hudi/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Hudi/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hudi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kafka</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Kafka/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Kafka/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kafka </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hive</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Hive/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Hive/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hive </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kibana</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Kibana/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Kibana/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kibana </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kylin</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Kylin/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Kylin/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kylin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Linux/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Linux/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lombok</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Lombok/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Lombok/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨ç±»åº“ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Maven</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Maven/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Maven/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Presto/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Presto/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Scala/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Scala/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Redis/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Redis/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Shell/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Shell/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Sqoop/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Sqoop/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Spark/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Spark/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Logstash</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Logstash/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Logstash/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Logstash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Zookeeper/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Zookeeper/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hadoop-ç¯å¢ƒæ­å»º</title>
      <link href="/2010/12/12/%E6%A8%A1%E6%9D%BF/"/>
      <url>/2010/12/12/%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginx&amp;Tengine</title>
      <link href="/2010/12/12/%E8%BF%9B%E8%A1%8C%E4%B8%AD-Nginx&amp;Tengine/"/>
      <url>/2010/12/12/%E8%BF%9B%E8%A1%8C%E4%B8%AD-Nginx&amp;Tengine/</url>
      
        <content type="html"><![CDATA[<p><strong>å‚è€ƒå¼•ç”¨æ–‡ç« </strong></p><ul><li>æ·±å…¥ç†è§£Nginxæ¨¡å—å¼€å‘ä¸æ¶æ„è§£æç¬¬2ç‰ˆ</li></ul><h1 id="Nginxæ˜¯ä»€ä¹ˆ"><a href="#Nginxæ˜¯ä»€ä¹ˆ" class="headerlink" title="Nginxæ˜¯ä»€ä¹ˆ"></a>Nginxæ˜¯ä»€ä¹ˆ</h1><p>â€‹    Nginxæ˜¯ä¸€ä¸ªé˜”å¹³å°çš„webæœåŠ¡å™¨, å¯ä»¥è¿è¡Œåœ¨Linux, FreeBSD, Solaris, AIZ, MacOS, Windowsç­‰æ“ä½œç³»ç»Ÿä¸Š, å¹¶ä¸”å®ƒè¿˜å¯ä»¥ä½¿ç”¨å½“å‰æ“ä½œç³»ç»Ÿç‰¹æœ‰çš„ä¸€äº›é«˜æ•ˆapiæ¥æé«˜è‡ªå·±çš„æ€§èƒ½.</p><h1 id="Nginxé…ç½®"><a href="#Nginxé…ç½®" class="headerlink" title="Nginxé…ç½®"></a>Nginxé…ç½®</h1><h2 id="Nginxè¿›ç¨‹ä¹‹é—´çš„å…³ç³»"><a href="#Nginxè¿›ç¨‹ä¹‹é—´çš„å…³ç³»" class="headerlink" title="Nginxè¿›ç¨‹ä¹‹é—´çš„å…³ç³»"></a>Nginxè¿›ç¨‹ä¹‹é—´çš„å…³ç³»</h2><p>åœ¨æ­£å¼æä¾›æœåŠ¡çš„äº§å“ç¯å¢ƒä¸‹, éƒ¨ç½²Nginxæ—¶éƒ½æ˜¯ä½¿ç”¨ä¸€ä¸ªmasterè¿›ç¨‹æ¥ç®¡ç†å¤šä¸ªworkerè¿›è¡Œ, ä¸€èˆ¬æƒ…å†µä¸‹, workerè¿›è¡Œçš„æ•°é‡ä¸æœåŠ¡å™¨ä¸Šcpuæ ¸å¿ƒæ•°é‡æ˜¯ç›¸ç­‰çš„. æ¯ä¸€ä¸ªworkerè¿›ç¨‹éƒ½æ˜¯ç¹å¿™çš„, æ˜¯çœŸæ­£åœ°ä¸ºäº’è”ç½‘æœåŠ¡çš„, masteræ˜¯æ¯”è¾ƒâ€æ¸…é—²çš„â€, åªè´Ÿè´£ç›‘æ§ç®¡ç†workerè¿›è¡Œ, workerè¿›ç¨‹ä¹‹é—´é€šè¿‡å…±äº«å†…å­˜, åŸå­æ“ä½œç­‰ä¸€äº›è¿›ç¨‹é€šä¿¡æœºåˆ¶æ¥å®ç°è´Ÿè½½å‡è¡¡ç­‰åŠŸèƒ½</p><h2 id="NginxæœåŠ¡çš„åŸºæœ¬é…ç½®-å¾…è¡¥å……"><a href="#NginxæœåŠ¡çš„åŸºæœ¬é…ç½®-å¾…è¡¥å……" class="headerlink" title="NginxæœåŠ¡çš„åŸºæœ¬é…ç½®(å¾…è¡¥å……)"></a>NginxæœåŠ¡çš„åŸºæœ¬é…ç½®(å¾…è¡¥å……)</h2><p>Nginxçš„é…ç½®æ–‡ä»¶å…¶å®å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æ–‡æœ¬æ–‡ä»¶</p><h2 id="ç”¨HTTPæ ¸å¿ƒæ¨¡å—é…ç½®ä¸€ä¸ªé™æ€webæœåŠ¡å™¨-å¾…è¡¥å……"><a href="#ç”¨HTTPæ ¸å¿ƒæ¨¡å—é…ç½®ä¸€ä¸ªé™æ€webæœåŠ¡å™¨-å¾…è¡¥å……" class="headerlink" title="ç”¨HTTPæ ¸å¿ƒæ¨¡å—é…ç½®ä¸€ä¸ªé™æ€webæœåŠ¡å™¨(å¾…è¡¥å……)"></a>ç”¨HTTPæ ¸å¿ƒæ¨¡å—é…ç½®ä¸€ä¸ªé™æ€webæœåŠ¡å™¨(å¾…è¡¥å……)</h2><h2 id="ç”¨Http-proxy-moduleé…ç½®ä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨"><a href="#ç”¨Http-proxy-moduleé…ç½®ä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨" class="headerlink" title="ç”¨Http proxy moduleé…ç½®ä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨"></a>ç”¨Http proxy moduleé…ç½®ä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨</h2><p>â€‹    åå‘ä»£ç†ï¼Œ æ˜¯æŒ‡ç”¨ä»£ç†æœåŠ¡å™¨æ¥æ¥å—Internetä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œ ç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸­çš„ä¸Šæ¸¸æœåŠ¡å™¨ï¼Œ å¹¶å°†ä»ä¸Šæ¸¸æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™Internetä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œ æ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–çš„è¡¨ç°å°±æ˜¯ä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œ å……å½“åå‘ä»£ç†æœåŠ¡å™¨ä¹Ÿæ˜¯Nginxçš„ä¸€ç§å¸¸è§çš„æ–¹æ³•</p><p>â€‹    ç”±äºNginxå…·æœ‰â€œå¼ºæ‚çš„â€çš„é«˜å¹¶å‘å’Œé«˜è´Ÿè½½èƒ½åŠ›ï¼Œ å› æ­¤ä¸€èˆ¬ä¼šä½œä¸ºå‰ç«¯çš„æœåŠ¡å™¨ç›´æ¥å‘å®¢æˆ·ç«¯æä¾›é™æ€æ–‡ä»¶æœåŠ¡ã€‚</p><p>â€‹    ä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›å¤æ‚ï¼Œ å¤šå˜çš„ä¸šåŠ¡ä¸é€‚åˆæ”¾åˆ°NginxæœåŠ¡å™¨ä¸Š, è¿™æ—¶ä¼šä½¿ç”¨Apache, Tomcatç­‰æœåŠ¡å™¨æ¥è¿›è¡Œå¤„ç†. äºæ˜¯Nginxé€šå¸¸ä¼šè¢«é…ç½®ä¸ºæ—¢æ˜¯é™æ€webæœåŠ¡å™¨, ä¹Ÿæ˜¯åå‘ä»£ç†æœåŠ¡å™¨, ä¸é€‚åˆNginxå¤„ç†çš„è¯·æ±‚å°±ä¼šç›´æ¥è½¬å‘åˆ°ä¸Šæ¸¸æœåŠ¡å™¨ä¸­è¿›è¡Œå¤„ç†.</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/Snipaste_2021-11-23_16-48-15.jpg"></p><p>â€‹    ä¸Squidç­‰åå‘ä»£ç†æœåŠ¡å™¨ç›¸æ¯”, Nginxçš„åå‘ä»£ç†æœåŠ¡å™¨æœ‰ç€è‡ªå·±çš„ç‰¹ç‚¹</p><p><img src="https://cdn.jsdelivr.net/gh/quietCC/imageBed/img/Snipaste_2021-11-23_16-50-07.jpg"></p><p>â€‹    å½“å®¢æˆ·ç«¯å‘æ¥HTTPè¯·æ±‚çš„æ—¶å€™, Nginxå¹¶ä¸ä¼šç«‹åˆ»è½¬å‘åˆ°ä¸Šæ¸¸æœåŠ¡å™¨ä¸­, è€Œæ˜¯å…ˆå°†ç”¨æˆ·çš„è¯·æ±‚, åŒ…æ‹¬HTTPåŒ…ä½“å®Œæ•´åœ°æ¥æ”¶åˆ°Nginxæ‰€åœ¨æœåŠ¡å™¨çš„ç¡¬ç›˜æˆ–è€…å†…å­˜ä¸­, ç„¶åå†å‘ä¸Šæ¸¸æœåŠ¡å™¨å‘èµ·è¿æ¥, å°†ç¼“å­˜çš„å®¢æˆ·ç«¯è¯·æ±‚è½¬å‘åˆ°ä¸Šæ¸¸æœåŠ¡å™¨ä¸­, è€ŒSquidç­‰ä»£ç†æœåŠ¡å™¨åˆ™é‡‡ç”¨ä¸€è¾¹æ¥å—å®¢æˆ·ç«¯è¯·æ±‚, ä¸€è¾¹è½¬å‘åˆ°ä¸Šæ¸¸æœåŠ¡å™¨çš„æ–¹å¼.</p><p>â€‹    è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯å»¶é•¿äº†ä¸€ä¸ªè¯·æ±‚çš„å¤„ç†äº‹ä»¶, å¹¶ä¸”å¢åŠ äº†ç”¨æˆ·ç¼“å­˜è¯·æ±‚å†…å®¹çš„å†…å­˜å’Œç£ç›˜çš„ç©ºé—´, è€Œæœ‰ç‚¹äº‹é™ä½äº†ä¸Šæ¸¸æœåŠ¡å™¨çš„è´Ÿè½½, å°½é‡å°†å‹åŠ›æ”¾åœ¨NginxæœåŠ¡å™¨ä¸Š.</p><p>â€‹    Nginxçš„è¿™ç§å·¥ä½œæ–¹å¼ä¸ºä»€ä¹ˆä¼šé™ä½ä¸Šæ¸¸æœåŠ¡å™¨çš„è´Ÿè½½å‘¢? é€šå¸¸, å®¢æˆ·ç«¯ä¸ä»£ç†æœåŠ¡å™¨ä¹‹é—´çš„ç½‘ç»œç¯å¢ƒä¼šæ¯”è¾ƒå¤æ‚, å¤šåŠæ˜¯â€èµ°â€å…¬ç½‘, ç½‘é€Ÿå¹³å‡ä¸‹æ¥å¯èƒ½ä¼šæ¯”è¾ƒæ…¢, ä¸€æ¬¡ä¸€ä¸ªè¯·æ±‚å¯èƒ½è¦æŒç»­å¾ˆä¹…æ‰èƒ½å®Œæˆ. è€Œä»£ç†æœåŠ¡å™¨ä¸ä¸Šæ¸¸æœåŠ¡å™¨ä¹‹é—´ä¸€èˆ¬æ˜¯â€èµ°â€å†…ç½‘, æˆ–è€…ä¸“æœ‰è¿æ¥, ä¼ è¾“é€Ÿåº¦å¿«. Squidç­‰åå‘ä»£ç†æœåŠ¡å™¨</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> è´Ÿè½½å‡è¡¡ </tag>
            
            <tag> åå‘ä»£ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼</title>
      <link href="/2010/12/12/%E8%BF%9B%E8%A1%8C%E4%B8%AD-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2010/12/12/%E8%BF%9B%E8%A1%8C%E4%B8%AD-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p><strong>å‚è€ƒå¼•ç”¨é“¾æ¥</strong></p><ul><li>æ­£åˆ™è¡¨è¾¾å¼å¿…çŸ¥å¿…ä¼šï¼ˆäººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ï¼‰</li><li><a href="https://github.com/quietCC/learn-regex/blob/master/translations/README-cn.md#learn-regex">The Easy Way Learn Regex</a></li></ul><h1 id="æ­£åˆ™å…¥é—¨"><a href="#æ­£åˆ™å…¥é—¨" class="headerlink" title="æ­£åˆ™å…¥é—¨"></a>æ­£åˆ™å…¥é—¨</h1><h2 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h2><p>æ­£åˆ™è¡¨è¾¾å¼ï¼ˆregular expressionï¼Œ ç®€ç§°regexï¼‰æ˜¯ä¸€ç§å·¥å…·ï¼Œ ç”±æ–‡æœ¬å’Œç‰¹æ®ŠæŒ‡ä»¤æ„æˆçš„é«˜åº¦ç®€ç»ƒçš„å­—ç¬¦ä¸²å®ç°åŒ¹é…ã€‚</p><blockquote><p>æ­£åˆ™è¡¨è¾¾å¼èµ·æºäº1950å¹´ä»£åœ¨æ•°å­¦é¢†åŸŸçš„ä¸€äº›ç ”ç©¶ç”¨ä½œï¼Œ å‡ å¹´åï¼Œ è®¡ç®—æœºé¢†åŸŸå€Ÿé‰´é‚£äº›ç ”ç©¶å·¥ä½œçš„æˆæœå’Œæ€è·¯å¼€å‘å‡ºäº†Unixä¸–ç•Œé‡Œé¢çš„Perlè¯­è¨€å’Œgrepç­‰å·¥å…·ç¨‹åºã€‚ åœ¨è®¸å¤šå¹´é‡Œï¼Œ æ­£åˆ™è¡¨è¾¾å¼åªæµè¡ŒäºUnixå¹³å°ï¼Œ ä½†æ˜¯è¿™ç§æƒ…å†µæ—©å·²å‘ç”Ÿå˜åŒ–ï¼Œ ç°åœ¨å‡ ä¹æ‰€æœ‰çš„è®¡ç®—æœºå¹³å°éƒ½æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚ åªæ˜¯å…·ä½“çš„æ–¹å¼å’Œæ”¯æŒçš„æˆéƒ½ç”±ç•¥å¾®çš„å·®å¼‚ã€‚</p></blockquote><h1 id="åŸºæœ¬åŒ¹é…"><a href="#åŸºæœ¬åŒ¹é…" class="headerlink" title="åŸºæœ¬åŒ¹é…"></a>åŸºæœ¬åŒ¹é…</h1><p>æ­£åˆ™è¡¨è¾¾å¼å…¶å®å°±æ˜¯åœ¨æ‰§è¡Œæœç´¢æ—¶çš„æ ¼å¼ï¼Œ å®ƒæ˜¯ç”±ä¸€äº›å­—æ¯å’Œæ•°å­—ç»„åˆè€Œæˆçš„ã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼<code>the</code>, å®ƒè¡¨ç¤ºä¸€ä¸ªè§„åˆ™ï¼š ç”±å­—æ¯<code>t</code>å¼€å§‹ï¼Œä¹‹åæ˜¯<code>h</code>, æœ€åæ˜¯<code>e</code>ã€‚</p><table><thead><tr><th>â€œtheâ€ =&gt; The fat cat sat on <a href="">the</a> mat</th></tr></thead></table><p>æ­£åˆ™è¡¨è¾¾å¼123åŒ¹é…123ï¼Œ å®ƒé€ä¸ªå­—ç¬¦çš„ä¸è¾“å…¥çš„æ­£åˆ™è¡¨è¾¾å¼ä½œæ¯”è¾ƒï¼Œ æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œ æ‰€ä»¥<code>The</code>æ˜¯ä¸ä¼šåŒ¹é…<code>the</code>çš„ã€‚</p><table><thead><tr><th>â€œTheâ€ =&gt; <a href="">The </a>fat cat sat on the mat</th></tr></thead></table><h1 id="å…ƒå­—ç¬¦"><a href="#å…ƒå­—ç¬¦" class="headerlink" title="å…ƒå­—ç¬¦"></a>å…ƒå­—ç¬¦</h1><p>æ­£åˆ™è¡¨è¾¾å¼ä¸»è¦ä¾èµ–äºå…ƒå­—ç¬¦ã€‚ å…ƒå­—ç¬¦ä¸ä»£è¡¨ä»–ä»¬æœ¬èº«çš„å­—é¢æ„æ€ï¼Œ ä»–ä»¬éƒ½æœ‰ç‰¹æ®Šçš„å«ä¹‰ã€‚ ä¸€äº›å…ƒå­—ç¬¦åœ¨æ–¹æ‹¬å·ä¸­çš„æ—¶å€™æœ‰ä¸€äº›ç‰¹æ®Šçš„æ„æ€ã€‚</p><table><thead><tr><th>å…ƒå­—ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td>,</td><td>å¥å·åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦é™¤äº†æ¢è¡Œç¬¦</td></tr><tr><td>[]</td><td>å­—ç¬¦ç§ç±»ã€‚ åŒ¹é…æ–¹æ‹¬å·å†…çš„ä»»æ„å­—ç¬¦</td></tr><tr><td>[^ ]</td><td>å¦å®šçš„å­—ç¬¦ç§ç±»ã€‚ åŒ¹é…é™¤äº†æ–¹æ‹¬å·é‡Œçš„ä»»æ„å­—ç¬¦</td></tr><tr><td>*</td><td>åŒ¹é…&gt;=0ä¸ªé‡å¤çš„åœ¨*å·ä¹‹å‰çš„å­—ç¬¦</td></tr><tr><td>+</td><td>åŒ¹é…&gt;=1ä¸ªé‡å¤çš„åœ¨+ä¹‹å‰çš„å­—ç¬¦</td></tr><tr><td>ï¼Ÿ</td><td>æ ‡è®°ï¼Ÿä¹‹å‰çš„å­—ç¬¦ä¸ºå¯é€‰</td></tr><tr><td>{n,m}</td><td>åŒ¹é…numä¸ªå¤§æ‹¬å·ä¹‹å‰çš„å­—ç¬¦æˆ–è€…å­—ç¬¦é›†</td></tr><tr><td>(xyz)</td><td>å­—ç¬¦é›†ï¼Œ åŒ¹é…ä¸xyzå®Œå…¨ç›¸ç­‰çš„å­—ç¬¦ä¸²</td></tr><tr><td>|</td><td>æˆ–è¿ç®—ç¬¦ï¼Œ åŒ¹é…ç¬¦å·ä¹‹å‰æˆ–è€…ç¬¦å·ä¹‹åçš„å­—ç¬¦</td></tr><tr><td>\</td><td>è½¬ä¹‰å­—ç¬¦ï¼Œç”¨äºåŒ¹é…ä¸€äº›ä¿ç•™å­—ç¬¦ <code>[ ] ( ) &#123; &#125; . * + ? ^ $ \ </code></td></tr><tr><td>^</td><td>ä»å¼€å§‹è¡Œå¼€å§‹åŒ¹é…</td></tr><tr><td>ï¿¥</td><td>ä»æœ«ç«¯å¼€å§‹åŒ¹é…</td></tr></tbody></table><h2 id="ç‚¹è¿ç®—ç¬¦"><a href="#ç‚¹è¿ç®—ç¬¦" class="headerlink" title="ç‚¹è¿ç®—ç¬¦ ."></a>ç‚¹è¿ç®—ç¬¦ .</h2><p><code>.</code>æ˜¯å…ƒå­—ç¬¦ä¸­æœ€ç®€å•çš„ä¾‹å­, <code>.</code>åŒ¹é…ä»»æ„<strong>å•å­—ç¬¦</strong>ï¼Œ ä½†æ˜¯ä¸åŒ¹é…æ¢è¡Œç¬¦ï¼Œä¾‹å¦‚, è¡¨è¾¾å¼<code>.ar</code>åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦åé¢è·Ÿç€æ˜¯<code>a</code>å’Œ<code>r</code>çš„å­—ç¬¦ä¸²</p><table><thead><tr><th>â€œ.arâ€ =&gt; The <a href="">car</a> <a href="">par</a>ked in the <a href="">gar</a>age</th></tr></thead></table><h2 id="å­—ç¬¦é›†"><a href="#å­—ç¬¦é›†" class="headerlink" title="å­—ç¬¦é›†"></a>å­—ç¬¦é›†</h2><p>å­—ç¬¦é›†ä¹Ÿå«åšå­—ç¬¦ç±», æ–¹æ‹¬å·ç”¨æ¥æŒ‡å®šä¸€ä¸ªå­—ç¬¦é›†. åœ¨æ–¹æ‹¬å·ä¸­ä½¿ç”¨è¿å­—ç¬¦æ‰§è¡Œå­—ç¬¦é›†çš„èŒƒå›´. åœ¨æ–¹æ‹¬å·ä¸­çš„å­—ç¬¦é›†ä¸å…³å¿ƒé¡ºåº, ä¾‹å¦‚<code>[Tt]he</code>åŒ¹é…<code>the</code>å’Œ<code>The</code></p><table><thead><tr><th>â€œ[Tt]heâ€ =&gt; <a href="">The</a> car parked in <a href="">the</a> garage.</th></tr></thead></table><p>æ–¹æ‹¬å·çš„å¥å·å°±æ˜¯å¥å·, è¡¨è¾¾å¼<code>ar[.]</code>åŒ¹é…<code>ar.</code></p><table><thead><tr><th>â€œar[.]â€ =&gt; A garage is a good place to park a c<a href="">ar.</a></th></tr></thead></table><h2 id="å¦å®šå­—ç¬¦é›†"><a href="#å¦å®šå­—ç¬¦é›†" class="headerlink" title="å¦å®šå­—ç¬¦é›†"></a>å¦å®šå­—ç¬¦é›†</h2><p>ä¸€èˆ¬æ¥è¯´<code>^</code>è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´, ä½†æ˜¯åœ¨ä¸€ä¸ªæ–¹æ‹¬å·çš„å¼€å¤´ä¸­, è¡¨ç¤ºè¿™ä¸ªå­—ç¬¦é›†æ˜¯å¦å®šçš„. ä¾‹å¦‚è¡¨è¾¾å¼<code>[^c]ar</code>åŒ¹é…ä¸€ä¸ªåé¢è·Ÿç€<code>ar</code>çš„é™¤äº†<code>c</code>çš„ä»»æ„å­—ç¬¦</p><table><thead><tr><th>â€œ[^c]arâ€ =&gt; The car <a href="">par</a>ked in the <a href="">gar</a>age.</th></tr></thead></table><h2 id="é‡å¤æ¬¡æ•°"><a href="#é‡å¤æ¬¡æ•°" class="headerlink" title="é‡å¤æ¬¡æ•°"></a>é‡å¤æ¬¡æ•°</h2><p>åé¢è·Ÿç€å…ƒå­—ç¬¦<code>+</code>,<code>*</code>æˆ–è€…<code>?</code>çš„, ç”¨æ¥æŒ‡å®šåŒ¹é…å­æ¨¡å¼çš„æ¬¡æ•°, è¿™äº›å…ƒå­—ç¬¦åœ¨ä¸åŒçš„æƒ…å†µä¸‹æœ‰ç€ä¸åŒçš„æ„æ€</p><h3 id="å·"><a href="#å·" class="headerlink" title="*å·"></a><code>*</code>å·</h3><p><code>*</code>å·åŒ¹é…åœ¨<code>*</code>ä¹‹å‰çš„å­—ç¬¦å‡ºç°<strong>å¤§äºç­‰äº0æ¬¡</strong>, ä¾‹å¦‚, è¡¨è¾¾å¼<code>a*</code>åŒ¹é…0æˆ–è€…è·Ÿå¤šä¸ªä»¥aå¼€å¤´çš„å­—ç¬¦. è¡¨è¾¾å¼<code>[a-z*]</code>åŒ¹é…ä¸€ä¸ªè¡Œä¸­æ‰€æœ‰ä»¥å°å†™å­—æ¯å¼€å¤´çš„å­—ç¬¦ä¸²</p><table><thead><tr><th>â€œ[a-z]*â€ =&gt; T<a href="">he car parked in the garage</a> #21.</th></tr></thead></table><p><code>*</code>å’Œ<code>.</code>å­—ç¬¦æ­é…å¯ä»¥åŒ¹é…æ‰€æœ‰çš„å­—ç¬¦<code>.*</code>, <code>*</code>å’Œè¡¨ç¤ºåŒ¹é…ç©ºæ ¼çš„ç¬¦å·<code>\s</code>è¿èµ·æ¥ç”¨</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿</title>
      <link href="/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Yarn/"/>
      <url>/2010/12/12/%E5%BE%85%E8%A1%A5%E5%85%85-Yarn/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
